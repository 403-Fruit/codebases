'use strict';

var Util = require('./util'),

	DEFAULT_HOST = 'https://sesheta.pipedrive.com',
	MAX_BATCH_SIZE = 32768, // 32kb
	DEFAULT_BATCH_SIZE = 32768, // 32kb
	DEFAULT_BUFFER_TIME = 2000; // 2s

function Configuration(config) {
	config = Util.object(config);

	var id = config.id,
		key = config.key,
		host = typeof config.host === 'undefined' ? DEFAULT_HOST : config.host,

		batchSize = typeof config.batchSize === 'number' ? config.batchSize : DEFAULT_BATCH_SIZE,
		bufferTime = typeof config.bufferTime === 'number' ? config.bufferTime : DEFAULT_BUFFER_TIME;

	if (typeof id !== 'string' || id.length === 0) {
		throw new Error('Invalid id, expected a non-empty string');
	}

	if (typeof key !== 'string' || key.length === 0) {
		throw new Error('Invalid key, expected a non-empty string');
	}

	if (typeof host !== 'string' || host.length === 0) {
		throw new Error('Invalid host, expected a non-empty string');
	}

	this.id = id;
	this.key = key;
	this.host = host;

	this.batchSize = Math.min(batchSize, MAX_BATCH_SIZE);
	this.bufferTime = Math.max(bufferTime, 0);
}

module.exports = Configuration;
