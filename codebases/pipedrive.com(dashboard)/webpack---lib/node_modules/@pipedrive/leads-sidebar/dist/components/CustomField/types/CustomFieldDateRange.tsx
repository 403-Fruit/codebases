import React from 'react';
import { createFragmentContainer, graphql } from '@pipedrive/relay';

import { CustomField } from '../CustomField';
import { formatGraphQLDateInRange } from '../format/formatGraphQLDate';

import type { CustomFieldDateRange_data } from './__generated__/CustomFieldDateRange_data.graphql';

type Props = {
	readonly data: CustomFieldDateRange_data;
};

const CustomFieldDateRangeWithoutData: React.FC<Props> = ({ data }) => {
	const dateStart = formatGraphQLDateInRange(data.dateRangeStart);
	const dateEnd = formatGraphQLDateInRange(data.dateRangeEnd);
	return (
		<CustomField
			icon="daterange"
			type="daterange"
			value={`${dateStart} â€“ ${dateEnd}`}
			data={data}
			isDisabled={true}
			onUpdate={() => Promise.resolve(false)}
		/>
	);
};

export const CustomFieldDateRange = createFragmentContainer(CustomFieldDateRangeWithoutData, {
	data: graphql`
		fragment CustomFieldDateRange_data on CustomFieldDateRange {
			...CustomField_data
			dateRangeStart: start
			dateRangeEnd: end
		}
	`,
});
