!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("slate-dev-logger"),require("immutable"),require("slate-schema-violations")):"function"==typeof define&&define.amd?define(["exports","slate-dev-logger","immutable","slate-schema-violations"],t):t(e.Slate={},e.logger,e.Immutable,e.slateSchemaViolations)}(this,function(e,t,r,n){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;var o=function(e){return null!=e&&"object"==typeof e&&!1===Array.isArray(e)};function a(e){return!0===o(e)&&"[object Object]"===Object.prototype.toString.call(e)}var s=function(e){var t,r;return!1!==a(e)&&("function"==typeof(t=e.constructor)&&(!1!==a(r=t.prototype)&&!1!==r.hasOwnProperty("isPrototypeOf")))},i={BLOCK:"@@__SLATE_BLOCK__@@",CHANGE:"@@__SLATE_CHANGE__@@",DOCUMENT:"@@__SLATE_DOCUMENT__@@",HISTORY:"@@__SLATE_HISTORY__@@",INLINE:"@@__SLATE_INLINE__@@",LEAF:"@@__SLATE_LEAF__@@",MARK:"@@__SLATE_MARK__@@",OPERATION:"@@__SLATE_OPERATION__@@",POINT:"@@__SLATE_POINT__@@",RANGE:"@@__SLATE_RANGE__@@",SCHEMA:"@@__SLATE_SCHEMA__@@",STACK:"@@__SLATE_STACK__@@",TEXT:"@@__SLATE_TEXT__@@",VALUE:"@@__SLATE_VALUE__@@"};function u(e,t){return!(!t||!t[i[e]])}var c=void 0,l=void 0;function f(){c=0,l=function(){return""+c++}}f();var d={create:function(e){if(null==e)return l();if("string"==typeof e)return e;throw new Error("Keys must be strings, but you passed: "+e)},setGenerator:function(e){l=e},resetGenerator:f},v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},y=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),p=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},k=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},g=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},T=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&i.return&&i.return()}finally{if(o)throw a}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),O=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)},A={data:new r.Map,isVoid:!1,key:void 0,nodes:new r.List,type:void 0},b=function(e){function n(){return h(this,n),g(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return k(n,e),y(n,[{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={object:this.object,type:this.type,isVoid:this.isVoid,data:this.data.toJSON(),nodes:this.nodes.toArray().map(function(t){return t.toJSON(e)})};return e.preserveKeys&&(t.key=this.key),t}},{key:"toJS",value:function(e){return this.toJSON(e)}},{key:"object",get:function(){return"block"}},{key:"kind",get:function(){return t.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),this.object}},{key:"isEmpty",get:function(){return!this.isVoid&&!this.nodes.some(function(e){return!e.isEmpty})}},{key:"text",get:function(){return this.getText()}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n.isBlock(e))return e;if("string"==typeof e&&(e={type:e}),s(e))return n.fromJSON(e);throw new Error("`Block.create` only accepts objects, strings or blocks, but you passed it: "+e)}},{key:"createList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(r.List.isList(e)||Array.isArray(e))return new r.List(e.map(n.create));throw new Error("`Block.createList` only accepts arrays or lists, but you passed it: "+e)}},{key:"fromJSON",value:function(e){if(n.isBlock(e))return e;var t=e.data,o=void 0===t?{}:t,a=e.isVoid,s=void 0!==a&&a,i=e.key,u=void 0===i?d.create():i,c=e.nodes,l=void 0===c?[]:c,f=e.type;if("string"!=typeof f)throw new Error("`Block.fromJSON` requires a `type` string.");return new n({key:u,type:f,isVoid:!!s,data:r.Map(o),nodes:n.createChildren(l)})}},{key:"isBlockList",value:function(e){return r.List.isList(e)&&e.every(function(e){return n.isBlock(e)})}}]),n}(r.Record(A));b.fromJS=b.fromJSON,b.isBlock=u.bind(null,"BLOCK"),b.prototype[i.BLOCK]=!0;var N="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function x(){throw new Error("setTimeout has not been defined")}function S(){throw new Error("clearTimeout has not been defined")}var E=x,w=S;function F(e){if(E===setTimeout)return setTimeout(e,0);if((E===x||!E)&&setTimeout)return E=setTimeout,setTimeout(e,0);try{return E(e,0)}catch(t){try{return E.call(null,e,0)}catch(t){return E.call(this,e,0)}}}"function"==typeof N.setTimeout&&(E=setTimeout),"function"==typeof N.clearTimeout&&(w=clearTimeout);var B,_=[],P=!1,j=-1;function C(){P&&B&&(P=!1,B.length?_=B.concat(_):j=-1,_.length&&R())}function R(){if(!P){var e=F(C);P=!0;for(var t=_.length;t;){for(B=_,_=[];++j<t;)B&&B[j].run();j=-1,t=_.length}B=null,P=!1,function(e){if(w===clearTimeout)return clearTimeout(e);if((w===S||!w)&&clearTimeout)return w=clearTimeout,clearTimeout(e);try{w(e)}catch(t){try{return w.call(null,e)}catch(t){return w.call(this,e)}}}(e)}}function z(e,t){this.fun=e,this.array=t}z.prototype.run=function(){this.fun.apply(null,this.array)};function I(){}var L=I,D=I,M=I,K=I,J=I,V=I,U=I;var H=N.performance||{},W=H.now||H.mozNow||H.msNow||H.oNow||H.webkitNow||function(){return(new Date).getTime()};var G=new Date;var $={nextTick:function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];_.push(new z(e,t)),1!==_.length||P||F(R)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:L,addListener:D,once:M,off:K,removeListener:J,removeAllListeners:V,emit:U,binding:function(e){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(e){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(e){var t=.001*W.call(H),r=Math.floor(t),n=Math.floor(t%1*1e9);return e&&(r-=e[0],(n-=e[1])<0&&(r--,n+=1e9)),[r,n]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-G)/1e3}},q="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Y(e,t){return e(t={exports:{}},t.exports),t.exports}var X=1e3,Z=60*X,Q=60*Z,ee=24*Q,te=365.25*ee,re=function(e,t){t=t||{};var r,n=typeof e;if("string"===n&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return r*te;case"days":case"day":case"d":return r*ee;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Q;case"minutes":case"minute":case"mins":case"min":case"m":return r*Z;case"seconds":case"second":case"secs":case"sec":case"s":return r*X;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}(e);if("number"===n&&!1===isNaN(e))return t.long?ne(r=e,ee,"day")||ne(r,Q,"hour")||ne(r,Z,"minute")||ne(r,X,"second")||r+" ms":function(e){if(e>=ee)return Math.round(e/ee)+"d";if(e>=Q)return Math.round(e/Q)+"h";if(e>=Z)return Math.round(e/Z)+"m";if(e>=X)return Math.round(e/X)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function ne(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}var oe=Y(function(e,t){function r(e){var r;function o(){if(o.enabled){var e=o,n=+new Date,a=n-(r||n);e.diff=a,e.prev=r,e.curr=n,r=n;for(var s=new Array(arguments.length),i=0;i<s.length;i++)s[i]=arguments[i];s[0]=t.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var u=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(r,n){if("%%"===r)return r;u++;var o=t.formatters[n];if("function"==typeof o){var a=s[u];r=o.call(e,a),s.splice(u,1),u--}return r}),t.formatArgs.call(e,s),(o.log||t.log||console.log.bind(console)).apply(e,s)}}return o.namespace=e,o.enabled=t.enabled(e),o.useColors=t.useColors(),o.color=function(e){var r,n=0;for(r in e)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]}(e),o.destroy=n,"function"==typeof t.init&&t.init(o),t.instances.push(o),o}function n(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var r;t.save(e),t.names=[],t.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(r=0;r<o;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(r=0;r<t.instances.length;r++){var a=t.instances[r];a.enabled=t.enabled(a.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=re,t.instances=[],t.names=[],t.skips=[],t.formatters={}}),ae=(oe.coerce,oe.disable,oe.enable,oe.enabled,oe.humanize,oe.instances,oe.names,oe.skips,oe.formatters,Y(function(e,t){function r(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==$&&"env"in $&&(e=$.env.DEBUG),e}(t=e.exports=oe).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),!r)return;var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var o=0,a=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&"%c"===e&&(a=++o)}),e.splice(a,0,n)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=r,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(r())})),se=(ae.log,ae.formatArgs,ae.save,ae.load,ae.useColors,ae.storage,ae.colors,Array.isArray),ie="object"==typeof q&&q&&q.Object===Object&&q,ue="object"==typeof self&&self&&self.Object===Object&&self,ce=ie||ue||Function("return this")(),le=ce.Symbol,fe=Object.prototype,de=fe.hasOwnProperty,ve=fe.toString,he=le?le.toStringTag:void 0;var ye=function(e){var t=de.call(e,he),r=e[he];try{e[he]=void 0;var n=!0}catch(e){}var o=ve.call(e);return n&&(t?e[he]=r:delete e[he]),o},pe=Object.prototype.toString;var me=function(e){return pe.call(e)},ke="[object Null]",ge="[object Undefined]",Te=le?le.toStringTag:void 0;var Oe=function(e){return null==e?void 0===e?ge:ke:Te&&Te in Object(e)?ye(e):me(e)};var Ae=function(e){return null!=e&&"object"==typeof e},be="[object Symbol]";var Ne=function(e){return"symbol"==typeof e||Ae(e)&&Oe(e)==be},xe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Se=/^\w*$/;var Ee=function(e,t){if(se(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!Ne(e))||Se.test(e)||!xe.test(e)||null!=t&&e in Object(t)};var we=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},Fe="[object AsyncFunction]",Be="[object Function]",_e="[object GeneratorFunction]",Pe="[object Proxy]";var je,Ce=function(e){if(!we(e))return!1;var t=Oe(e);return t==Be||t==_e||t==Fe||t==Pe},Re=ce["__core-js_shared__"],ze=(je=/[^.]+$/.exec(Re&&Re.keys&&Re.keys.IE_PROTO||""))?"Symbol(src)_1."+je:"";var Ie=function(e){return!!ze&&ze in e},Le=Function.prototype.toString;var De=function(e){if(null!=e){try{return Le.call(e)}catch(e){}try{return e+""}catch(e){}}return""},Me=/^\[object .+?Constructor\]$/,Ke=Function.prototype,Je=Object.prototype,Ve=Ke.toString,Ue=Je.hasOwnProperty,He=RegExp("^"+Ve.call(Ue).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var We=function(e){return!(!we(e)||Ie(e))&&(Ce(e)?He:Me).test(De(e))};var Ge=function(e,t){return null==e?void 0:e[t]};var $e=function(e,t){var r=Ge(e,t);return We(r)?r:void 0},qe=$e(Object,"create");var Ye=function(){this.__data__=qe?qe(null):{},this.size=0};var Xe=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Ze="__lodash_hash_undefined__",Qe=Object.prototype.hasOwnProperty;var et=function(e){var t=this.__data__;if(qe){var r=t[e];return r===Ze?void 0:r}return Qe.call(t,e)?t[e]:void 0},tt=Object.prototype.hasOwnProperty;var rt=function(e){var t=this.__data__;return qe?void 0!==t[e]:tt.call(t,e)},nt="__lodash_hash_undefined__";var ot=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=qe&&void 0===t?nt:t,this};function at(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}at.prototype.clear=Ye,at.prototype.delete=Xe,at.prototype.get=et,at.prototype.has=rt,at.prototype.set=ot;var st=at;var it=function(){this.__data__=[],this.size=0};var ut=function(e,t){return e===t||e!=e&&t!=t};var ct=function(e,t){for(var r=e.length;r--;)if(ut(e[r][0],t))return r;return-1},lt=Array.prototype.splice;var ft=function(e){var t=this.__data__,r=ct(t,e);return!(r<0||(r==t.length-1?t.pop():lt.call(t,r,1),--this.size,0))};var dt=function(e){var t=this.__data__,r=ct(t,e);return r<0?void 0:t[r][1]};var vt=function(e){return ct(this.__data__,e)>-1};var ht=function(e,t){var r=this.__data__,n=ct(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};function yt(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}yt.prototype.clear=it,yt.prototype.delete=ft,yt.prototype.get=dt,yt.prototype.has=vt,yt.prototype.set=ht;var pt=yt,mt=$e(ce,"Map");var kt=function(){this.size=0,this.__data__={hash:new st,map:new(mt||pt),string:new st}};var gt=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var Tt=function(e,t){var r=e.__data__;return gt(t)?r["string"==typeof t?"string":"hash"]:r.map};var Ot=function(e){var t=Tt(this,e).delete(e);return this.size-=t?1:0,t};var At=function(e){return Tt(this,e).get(e)};var bt=function(e){return Tt(this,e).has(e)};var Nt=function(e,t){var r=Tt(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function xt(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}xt.prototype.clear=kt,xt.prototype.delete=Ot,xt.prototype.get=At,xt.prototype.has=bt,xt.prototype.set=Nt;var St=xt,Et="Expected a function";function wt(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(Et);var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],a=r.cache;if(a.has(o))return a.get(o);var s=e.apply(this,n);return r.cache=a.set(o,s)||a,s};return r.cache=new(wt.Cache||St),r}wt.Cache=St;var Ft=wt,Bt=500;var _t=/^\./,Pt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,jt=/\\(\\)?/g,Ct=function(e){var t=Ft(e,function(e){return r.size===Bt&&r.clear(),e}),r=t.cache;return t}(function(e){var t=[];return _t.test(e)&&t.push(""),e.replace(Pt,function(e,r,n,o){t.push(n?o.replace(jt,"$1"):r||e)}),t});var Rt=function(e,t){for(var r=-1,n=null==e?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o},zt=1/0,It=le?le.prototype:void 0,Lt=It?It.toString:void 0;var Dt=function e(t){if("string"==typeof t)return t;if(se(t))return Rt(t,e)+"";if(Ne(t))return Lt?Lt.call(t):"";var r=t+"";return"0"==r&&1/t==-zt?"-0":r};var Mt=function(e){return null==e?"":Dt(e)};var Kt=function(e,t){return se(e)?e:Ee(e,t)?[e]:Ct(Mt(e))},Jt=1/0;var Vt=function(e){if("string"==typeof e||Ne(e))return e;var t=e+"";return"0"==t&&1/e==-Jt?"-0":t};var Ut=function(e,t){for(var r=0,n=(t=Kt(t,e)).length;null!=e&&r<n;)e=e[Vt(t[r++])];return r&&r==n?e:void 0},Ht=function(){try{var e=$e(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();var Wt=function(e,t,r){"__proto__"==t&&Ht?Ht(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r},Gt=Object.prototype.hasOwnProperty;var $t=function(e,t,r){var n=e[t];Gt.call(e,t)&&ut(n,r)&&(void 0!==r||t in e)||Wt(e,t,r)},qt=9007199254740991,Yt=/^(?:0|[1-9]\d*)$/;var Xt=function(e,t){return!!(t=null==t?qt:t)&&("number"==typeof e||Yt.test(e))&&e>-1&&e%1==0&&e<t};var Zt=function(e,t,r,n){if(!we(e))return e;for(var o=-1,a=(t=Kt(t,e)).length,s=a-1,i=e;null!=i&&++o<a;){var u=Vt(t[o]),c=r;if(o!=s){var l=i[u];void 0===(c=n?n(l,u,i):void 0)&&(c=we(l)?l:Xt(t[o+1])?[]:{})}$t(i,u,c),i=i[u]}return e};var Qt=function(e,t,r){for(var n=-1,o=t.length,a={};++n<o;){var s=t[n],i=Ut(e,s);r(i,s)&&Zt(a,Kt(s,e),i)}return a};var er=function(e,t){return null!=e&&t in Object(e)},tr="[object Arguments]";var rr=function(e){return Ae(e)&&Oe(e)==tr},nr=Object.prototype,or=nr.hasOwnProperty,ar=nr.propertyIsEnumerable,sr=rr(function(){return arguments}())?rr:function(e){return Ae(e)&&or.call(e,"callee")&&!ar.call(e,"callee")},ir=9007199254740991;var ur=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=ir};var cr=function(e,t,r){for(var n=-1,o=(t=Kt(t,e)).length,a=!1;++n<o;){var s=Vt(t[n]);if(!(a=null!=e&&r(e,s)))break;e=e[s]}return a||++n!=o?a:!!(o=null==e?0:e.length)&&ur(o)&&Xt(s,o)&&(se(e)||sr(e))};var lr=function(e,t){return null!=e&&cr(e,t,er)};var fr=function(e,t){return Qt(e,t,function(t,r){return lr(e,r)})};var dr=function(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e},vr=le?le.isConcatSpreadable:void 0;var hr=function(e){return se(e)||sr(e)||!!(vr&&e&&e[vr])};var yr=function e(t,r,n,o,a){var s=-1,i=t.length;for(n||(n=hr),a||(a=[]);++s<i;){var u=t[s];r>0&&n(u)?r>1?e(u,r-1,n,o,a):dr(a,u):o||(a[a.length]=u)}return a};var pr=function(e){return null!=e&&e.length?yr(e,1):[]};var mr=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)},kr=Math.max;var gr=function(e,t,r){return t=kr(void 0===t?e.length-1:t,0),function(){for(var n=arguments,o=-1,a=kr(n.length-t,0),s=Array(a);++o<a;)s[o]=n[t+o];o=-1;for(var i=Array(t+1);++o<t;)i[o]=n[o];return i[t]=r(s),mr(e,this,i)}};var Tr=function(e){return function(){return e}};var Or=Ht?function(e,t){return Ht(e,"toString",{configurable:!0,enumerable:!1,value:Tr(t),writable:!0})}:function(e){return e},Ar=800,br=16,Nr=Date.now;var xr=function(e){var t=0,r=0;return function(){var n=Nr(),o=br-(n-r);if(r=n,o>0){if(++t>=Ar)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(Or);var Sr=function(e){return xr(gr(e,void 0,pr),e+"")},Er=Sr(function(e,t){return null==e?{}:fr(e,t)}),wr={data:new r.Map,isVoid:!1,key:void 0,nodes:new r.List,type:void 0},Fr=function(e){function n(){return h(this,n),g(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return k(n,e),y(n,[{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={object:this.object,type:this.type,isVoid:this.isVoid,data:this.data.toJSON(),nodes:this.nodes.toArray().map(function(t){return t.toJSON(e)})};return e.preserveKeys&&(t.key=this.key),t}},{key:"toJS",value:function(e){return this.toJSON(e)}},{key:"object",get:function(){return"inline"}},{key:"kind",get:function(){return t.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),this.object}},{key:"isEmpty",get:function(){return!this.isVoid&&!this.nodes.some(function(e){return!e.isEmpty})}},{key:"text",get:function(){return this.getText()}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n.isInline(e))return e;if("string"==typeof e&&(e={type:e}),s(e))return n.fromJSON(e);throw new Error("`Inline.create` only accepts objects, strings or inlines, but you passed it: "+e)}},{key:"createList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(r.List.isList(e)||Array.isArray(e))return new r.List(e.map(n.create));throw new Error("`Inline.createList` only accepts arrays or lists, but you passed it: "+e)}},{key:"fromJSON",value:function(e){if(n.isInline(e))return e;var t=e.data,o=void 0===t?{}:t,a=e.isVoid,s=void 0!==a&&a,i=e.key,u=void 0===i?d.create():i,c=e.nodes,l=void 0===c?[]:c,f=e.type;if("string"!=typeof f)throw new Error("`Inline.fromJS` requires a `type` string.");return new n({key:u,type:f,isVoid:!!s,data:new r.Map(o),nodes:n.createChildren(l)})}},{key:"isInlineList",value:function(e){return r.List.isList(e)&&e.every(function(e){return n.isInline(e)})}}]),n}(r.Record(wr));Fr.fromJS=Fr.fromJSON,Fr.isInline=u.bind(null,"INLINE"),Fr.prototype[i.INLINE]=!0;var Br=function(){function e(){h(this,e)}return y(e,null,[{key:"create",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.Map.isMap(t))return t;if(s(t))return e.fromJSON(t);throw new Error("`Data.create` only accepts objects or maps, but you passed it: "+t)}},{key:"fromJSON",value:function(e){return new r.Map(e)}}]),e}();Br.fromJS=Br.fromJSON;var _r=!0,Pr=0,jr={},Cr={},Rr=void 0;function zr(e,t){var r=function(t){var r=e[t];if(!r)throw new Error('Object does not have a property named "'+t+'".');e[t]=function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];if(!_r)return r.apply(this,n);Pr!==this.__cache_key&&(this.__cache_key=Pr,this.__cache=new Map,this.__cache_no_args={}),this.__cache||(this.__cache=new Map),this.__cache_no_args||(this.__cache_no_args={});var a=0!==n.length,s=void 0,i=void 0;if(a?(i=[t].concat(n),s=function(e,t){var r=!0,n=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var i=a.value;if((e=e.get(i))===Rr)return Rr}}catch(e){n=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(n)throw o}}return e.get(jr)}(this.__cache,i)):s=this.__cache_no_args[t],s!==Rr)return s===Cr?void 0:s;var u=r.apply(this,n),c=void 0===u?Cr:u;return a?this.__cache=function(e,t,r){var n=e,o=void 0,a=!0,s=!1,i=void 0;try{for(var u,c=t[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;(o=n.get(l))===Rr&&(o=new Map,n.set(l,o)),n=o}}catch(e){s=!0,i=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw i}}return o.set(jr,r),e}(this.__cache,i,c):this.__cache_no_args[t]=c,u}},n=!0,o=!1,a=void 0;try{for(var s,i=t[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){r(s.value)}}catch(e){o=!0,a=e}finally{try{!n&&i.return&&i.return()}finally{if(o)throw a}}}function Ir(){++Pr>=Number.MAX_SAFE_INTEGER&&(Pr=0)}function Lr(e){_r=e}var Dr={data:new r.Map,type:void 0},Mr=function(e){function n(){return h(this,n),g(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return k(n,e),y(n,[{key:"getComponent",value:function(e){return e.__getComponent(this)}},{key:"toJSON",value:function(){return{object:this.object,type:this.type,data:this.data.toJSON()}}},{key:"toJS",value:function(){return this.toJSON()}},{key:"object",get:function(){return"mark"}},{key:"kind",get:function(){return t.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),this.object}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n.isMark(e))return e;if("string"==typeof e&&(e={type:e}),s(e))return n.fromJSON(e);throw new Error("`Mark.create` only accepts objects, strings or marks, but you passed it: "+e)}},{key:"createSet",value:function(e){if(r.Set.isSet(e)||Array.isArray(e))return new r.Set(e.map(n.create));if(null==e)return r.Set();throw new Error("`Mark.createSet` only accepts sets, arrays or null, but you passed it: "+e)}},{key:"createProperties",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n.isMark(e))return{data:e.data,type:e.type};if("string"==typeof e)return{type:e};if(s(e)){var t={};return"type"in e&&(t.type=e.type),"data"in e&&(t.data=Br.create(e.data)),t}throw new Error("`Mark.createProperties` only accepts objects, strings or marks, but you passed it: "+e)}},{key:"fromJSON",value:function(e){var t=e.data,o=void 0===t?{}:t,a=e.type;if("string"!=typeof a)throw new Error("`Mark.fromJS` requires a `type` string.");return new n({type:a,data:new r.Map(o)})}},{key:"isMarkSet",value:function(e){return r.Set.isSet(e)&&e.every(function(e){return n.isMark(e)})}}]),n}(r.Record(Dr));Mr.fromJS=Mr.fromJSON,Mr.isMark=u.bind(null,"MARK"),Mr.prototype[i.MARK]=!0,zr(Mr.prototype,["getComponent"]);var Kr,Jr,Vr={};["deleteBackward","deleteCharBackward","deleteLineBackward","deleteWordBackward","deleteForward","deleteCharForward","deleteWordForward","deleteLineForward","setBlocks","setInlines","splitInline","unwrapBlock","unwrapInline","wrapBlock","wrapInline"].forEach(function(e){Vr[e]=function(t){for(var r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];var a=t.value.selection;t[e+"AtRange"].apply(t,[a].concat(n)),e.match(/Backward$/)?t.moveToStart():e.match(/Forward$/)&&t.moveToEnd()}}),Vr.setBlock=function(){t.deprecate("slate@0.33.0","The `setBlock` method of Slate changes has been renamed to `setBlocks`."),Vr.setBlocks.apply(Vr,arguments)},Vr.setInline=function(){t.deprecate("slate@0.33.0","The `setInline` method of Slate changes has been renamed to `setInlines`."),Vr.setInlines.apply(Vr,arguments)},Vr.addMark=function(e,t){t=Mr.create(t);var r=e.value,n=r.document,o=r.selection;if(o.isExpanded)e.addMarkAtRange(o,t);else if(o.marks){var a=o.marks.add(t),s=o.set("marks",a);e.select(s)}else{var i=n.getActiveMarksAtRange(o).add(t),u=o.set("marks",i);e.select(u)}},Vr.addMarks=function(e,t){t.forEach(function(t){return e.addMark(t)})},Vr.delete=function(e){var t=e.value.selection;e.deleteAtRange(t),e.moveToStart()},Vr.insertBlock=function(e,t){t=b.create(t);var r=e.value.selection;e.insertBlockAtRange(r,t);var n=e.value.document.getNode(t.key);n&&e.moveToEndOfNode(n)},Vr.insertFragment=function(e,t){if(t.nodes.size){var r=e.value,n=r,o=n.document,a=n.selection,s=a.start,i=a.end,u=r,c=u.startText,l=u.endText,f=u.startInline,d=t.getLastText(),v=t.getClosestInline(d.key),h=t.nodes.first(),y=t.nodes.last(),p=o.getTexts().map(function(e){return e.key}),m=!f||s.isAtStartOfNode(c)||i.isAtStartOfNode(c)||s.isAtEndOfNode(l)||i.isAtEndOfNode(l),k=h.hasBlockChildren()||y.hasBlockChildren();e.insertFragmentAtRange(a,t);var g=(o=(r=e.value).document).getTexts().filter(function(e){return!p.includes(e.key)}),T=m?g.last():g.takeLast(2).first();T&&(v||k)?e.select(a.moveToEndOfNode(T)):T?e.select(a.moveToStartOfNode(T).moveForward(d.text.length)):e.select(a.moveToStart().moveForward(d.text.length))}},Vr.insertInline=function(e,t){t=Fr.create(t);var r=e.value.selection;e.insertInlineAtRange(r,t);var n=e.value.document.getNode(t.key);n&&e.moveToEndOfNode(n)},Vr.insertText=function(e,t,r){var n=e.value,o=n.document,a=n.selection;r=r||a.marks||o.getInsertMarksAtRange(a),e.insertTextAtRange(a,t,r),a.marks&&o!=e.value.document&&e.select({marks:null})},Vr.removeMark=function(e,t){t=Mr.create(t);var r=e.value,n=r.document,o=r.selection;if(o.isExpanded)e.removeMarkAtRange(o,t);else if(o.marks){var a=o.marks.remove(t),s=o.set("marks",a);e.select(s)}else{var i=n.getActiveMarksAtRange(o).remove(t),u=o.set("marks",i);e.select(u)}},Vr.replaceMark=function(e,t,r){e.removeMark(t),e.addMark(r)},Vr.splitBlock=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=e.value,n=r.selection,o=r.document,a=n.marks||o.getInsertMarksAtRange(n);e.splitBlockAtRange(n,t).moveToEnd(),a&&0!==a.size&&e.select({marks:a})},Vr.toggleMark=function(e,t){t=Mr.create(t),e.value.activeMarks.has(t)?e.removeMark(t):e.addMark(t)},Vr.wrapText=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,n=e.value.selection;e.wrapTextAtRange(n,t,r),n.isCollapsed&&e.moveStartBackward(t.length),e.moveEndBackward(r.length),n.isForward!=e.value.selection.isForward&&e.flip()},Kr=new RegExp("^[^֑-߿יִ-﷽ﹰ-ﻼ]*[A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿]"),Jr=new RegExp("^[^A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿]*[֑-߿יִ-﷽ﹰ-ﻼ]");var Ur=function(e){return e=e.toString(),Jr.test(e)?"rtl":Kr.test(e)?"ltr":"neutral"},Hr={data:new r.Map,key:void 0,nodes:new r.List},Wr=function(e){function n(){return h(this,n),g(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return k(n,e),y(n,[{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={object:this.object,data:this.data.toJSON(),nodes:this.nodes.toArray().map(function(t){return t.toJSON(e)})};return e.preserveKeys&&(t.key=this.key),t}},{key:"toJS",value:function(e){return this.toJSON(e)}},{key:"object",get:function(){return"document"}},{key:"kind",get:function(){return t.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),this.object}},{key:"isEmpty",get:function(){return!this.nodes.some(function(e){return!e.isEmpty})}},{key:"text",get:function(){return this.getText()}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n.isDocument(e))return e;if((r.List.isList(e)||Array.isArray(e))&&(e={nodes:e}),s(e))return n.fromJSON(e);throw new Error("`Document.create` only accepts objects, arrays, lists or documents, but you passed it: "+e)}},{key:"fromJSON",value:function(e){if(n.isDocument(e))return e;var t=e.data,o=void 0===t?{}:t,a=e.key,s=void 0===a?d.create():a,i=e.nodes,u=void 0===i?[]:i;return new n({key:s,data:new r.Map(o),nodes:n.createChildren(u)})}}]),n}(r.Record(Hr));function Gr(e,t){if(e.size!==t.size)return null;for(var r=0;r<e.size;r++){var n=e.get(r),o=t.get(r);if(n<o)return-1;if(n>o)return 1}return 0}function $r(e){if(null==e)return null;if(r.List.isList(e))return e;if(Array.isArray(e))return r.List(e);throw new Error("Paths can only be created from arrays or lists, but you passed: "+e)}function qr(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Xr(e,t);return[e.slice(0,r),t.slice(0,r)]}function Yr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.size-1,n=e.get(r)+t;return e.set(r,n)}function Xr(e,t){return Math.min(e.size,t.size)}Wr.fromJS=Wr.fromJSON,Wr.isDocument=u.bind(null,"DOCUMENT"),Wr.prototype[i.DOCUMENT]=!0;var Zr={compare:Gr,create:$r,crop:qr,decrement:function(e){return Yr(e,0-(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1),arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.size-1)},increment:Yr,isAbove:function(e,t){var r=qr(e,t),n=T(r,2),o=n[0],a=n[1];return e.size<t.size&&0===Gr(o,a)},isAfter:function(e,t){var r=qr(e,t),n=T(r,2);return 1===Gr(n[0],n[1])},isBefore:function(e,t){var r=qr(e,t),n=T(r,2);return-1===Gr(n[0],n[1])},lift:function(e){return e.slice(0,-1)},max:function(e,t){return Math.max(e.size,t.size)},min:Xr,relate:function(e,t){for(var r=[],n=0;n<e.size&&n<t.size;n++){var o=e.get(n);if(o!==t.get(n))break;r.push(o)}return $r(r)}},Qr=function(e){function r(){return h(this,r),g(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return k(r,e),y(r,[{key:"isAtEndOfNode",value:function(e){if(this.isUnset)return!1;var t=e.getLastText();return this.key===t.key&&this.offset===t.text.length}},{key:"isAtStartOfNode",value:function(e){if(this.isUnset)return!1;if(0!=this.offset)return!1;var t=e.getFirstText();return this.key===t.key}},{key:"isInNode",value:function(e){return!this.isUnset&&("text"===e.object&&e.key===this.key||!!e.hasNode(this.key))}},{key:"moveBackward",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return 0===e?this:e<0?this.moveForward(-e):this.setOffset(this.offset-e)}},{key:"moveForward",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return 0===e?this:e<0?this.moveBackward(-e):this.setOffset(this.offset+e)}},{key:"moveTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.key;return"number"==typeof e?(t=e,e=this.path):"string"==typeof e?e=(r=e)===this.key?this.path:null:r=e.equals(this.path)?this.key:null,this.merge({key:r,path:e,offset:t})}},{key:"moveToStartOfNode",value:function(e){var t=e.getFirstText();return this.moveTo(t.key,0)}},{key:"moveToEndOfNode",value:function(e){var t=e.getLastText();return this.moveTo(t.key,t.text.length)}},{key:"normalize",value:function(e){if(null==this.key&&null==this.path)return this.setOffset(null);var n=this.key,o=this.offset,a=this.path,s=e.getNode(n||a);if(!s){t.warn("A point's `path` or `key` invalid and was reset:",this);var i=e.getFirstText();return i?this.merge({key:i.key,offset:0,path:e.getPath(i.key)}):r.create()}if("text"!==s.object){t.warn("A point should not reference a non-text node:",s);var u=s.getTextAtOffset(o),c=s.getOffset(u.key);return this.merge({offset:o-c,key:u.key,path:e.getPath(u.key)})}return s&&a&&n&&n!==s.key&&t.warn("A point's `key` did not match its `path`:",this,s),this.merge({key:s.key,path:null==a?e.getPath(s.key):a,offset:null==o?0:Math.min(o,s.text.length)})}},{key:"setKey",value:function(e){return null!==e&&(e=d.create(e)),this.set("key",e)}},{key:"setOffset",value:function(e){return this.set("offset",e)}},{key:"setPath",value:function(e){return null!==e&&(e=Zr.create(e)),this.set("path",e)}},{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={object:this.object,key:this.key,offset:this.offset,path:this.path&&this.path.toArray()};return e.preserveKeys||delete t.key,t}},{key:"toJS",value:function(){return this.toJSON()}},{key:"object",get:function(){return"point"}},{key:"isSet",get:function(){return null!=this.key&&null!=this.offset&&null!=this.path}},{key:"isUnset",get:function(){return!this.isSet}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isPoint(e))return e;if(s(e))return r.fromJSON(e);throw new Error("`Point.create` only accepts objects or points, but you passed it: "+e)}},{key:"createProperties",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isPoint(e))return{key:e.key,offset:e.offset,path:e.path};if(s(e)){var t={};return"key"in e&&(t.key=e.key),"offset"in e&&(t.offset=e.offset),"path"in e&&(t.path=Zr.create(e.path)),"path"in e&&!("key"in e)&&(t.key=null),"key"in e&&!("path"in e)&&(t.path=null),t}throw new Error("`Point.createProperties` only accepts objects or points, but you passed it: "+e)}},{key:"fromJSON",value:function(e){var t=e.key,n=void 0===t?null:t,o=e.offset,a=void 0===o?null:o,s=e.path,i=void 0===s?null:s;return new r({key:n,offset:a,path:Zr.create(i)})}},{key:"isPoint",value:function(e){return!(!e||!e[i.POINT])}}]),r}(r.Record({key:null,offset:null,path:null}));Qr.fromJS=Qr.fromJSON,Qr.prototype[i.POINT]=!0;var en={anchor:Qr.create(),focus:Qr.create(),isAtomic:!1,isFocused:!1,marks:null},tn=function(e){function n(){return h(this,n),g(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return k(n,e),y(n,[{key:"flip",value:function(){return this.setPoints([this.focus,this.anchor])}},{key:"moveForward",value:function(e){return this.updatePoints(function(t){return t.moveForward(e)})}},{key:"moveBackward",value:function(e){return this.updatePoints(function(t){return t.moveBackward(e)})}},{key:"moveAnchorBackward",value:function(e){return this.setAnchor(this.anchor.moveBackward(e))}},{key:"moveAnchorForward",value:function(e){return this.setAnchor(this.anchor.moveForward(e))}},{key:"moveAnchorTo",value:function(e,t){return this.setAnchor(this.anchor.moveTo(e,t))}},{key:"moveAnchorToStartOfNode",value:function(e){return this.setAnchor(this.anchor.moveToStartOfNode(e))}},{key:"moveAnchorToEndOfNode",value:function(e){return this.setAnchor(this.anchor.moveToEndOfNode(e))}},{key:"moveEndBackward",value:function(e){return this.setEnd(this.end.moveBackward(e))}},{key:"moveEndForward",value:function(e){return this.setEnd(this.end.moveForward(e))}},{key:"moveEndTo",value:function(e,t){return this.setEnd(this.end.moveTo(e,t))}},{key:"moveEndToStartOfNode",value:function(e){return this.setEnd(this.end.moveToStartOfNode(e))}},{key:"moveEndToEndOfNode",value:function(e){return this.setEnd(this.end.moveToEndOfNode(e))}},{key:"moveFocusBackward",value:function(e){return this.setFocus(this.focus.moveBackward(e))}},{key:"moveFocusForward",value:function(e){return this.setFocus(this.focus.moveForward(e))}},{key:"moveFocusTo",value:function(e,t){return this.setFocus(this.focus.moveTo(e,t))}},{key:"moveFocusToStartOfNode",value:function(e){return this.setFocus(this.focus.moveToStartOfNode(e))}},{key:"moveFocusToEndOfNode",value:function(e){return this.setFocus(this.focus.moveToEndOfNode(e))}},{key:"moveStartBackward",value:function(e){return this.setStart(this.start.moveBackward(e))}},{key:"moveStartForward",value:function(e){return this.setStart(this.start.moveForward(e))}},{key:"moveStartTo",value:function(e,t){return this.setStart(this.start.moveTo(e,t))}},{key:"moveStartToStartOfNode",value:function(e){return this.setStart(this.start.moveToStartOfNode(e))}},{key:"moveStartToEndOfNode",value:function(e){return this.setStart(this.start.moveToEndOfNode(e))}},{key:"moveTo",value:function(e,t){return this.updatePoints(function(r){return r.moveTo(e,t)})}},{key:"moveToAnchor",value:function(){return this.setFocus(this.anchor)}},{key:"moveToEnd",value:function(){return this.setStart(this.end)}},{key:"moveToEndOfNode",value:function(e){return this.updatePoints(function(t){return t.moveToEndOfNode(e)})}},{key:"moveToFocus",value:function(){return this.setAnchor(this.focus)}},{key:"moveToRangeOfNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return this.setPoints([this.anchor.moveToStartOfNode(e),this.focus.moveToEndOfNode(t)])}},{key:"moveToStart",value:function(){return this.setEnd(this.start)}},{key:"moveToStartOfNode",value:function(e){return this.updatePoints(function(t){return t.moveToStartOfNode(e)})}},{key:"normalize",value:function(e){return this.updatePoints(function(t){return t.normalize(e)})}},{key:"setAnchor",value:function(e){return this.set("anchor",e)}},{key:"setEnd",value:function(e){return this.isBackward?this.setAnchor(e):this.setFocus(e)}},{key:"setFocus",value:function(e){return this.set("focus",e)}},{key:"setIsAtomic",value:function(e){return this.set("isAtomic",e)}},{key:"setIsFocused",value:function(e){return this.set("isFocused",e)}},{key:"setMarks",value:function(e){return this.set("marks",e)}},{key:"setPoints",value:function(e){var t=T(e,2),r=t[0],n=t[1];return this.set("anchor",r).set("focus",n)}},{key:"updatePoints",value:function(e){var t=this.anchor,r=this.focus;return t=e(t),r=e(r),this.merge({anchor:t,focus:r})}},{key:"setStart",value:function(e){return this.isBackward?this.setFocus(e):this.setAnchor(e)}},{key:"setProperties",value:function(e){var t=e=n.createProperties(e),r=t.anchor,o=t.focus,a=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(t,["anchor","focus"]);return r&&(a.anchor=Qr.create(r)),o&&(a.focus=Qr.create(o)),this.merge(a)}},{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{object:this.object,anchor:this.anchor.toJSON(e),focus:this.focus.toJSON(e),isAtomic:this.isAtomic,isFocused:this.isFocused,marks:null==this.marks?null:this.marks.toArray().map(function(e){return e.toJSON()})}}},{key:"toJS",value:function(){return this.toJSON()}},{key:"hasAnchorAtStartOf",value:function(e){return t.deprecate("0.37.0","The `Range.hasAnchorAtStartOf` method is deprecated, please use `Range.anchor.isAtStartOfNode` instead."),this.anchor.isAtStartOfNode(e)}},{key:"hasAnchorAtEndOf",value:function(e){return t.deprecate("0.37.0","The `Range.hasAnchorAtEndOf` method is deprecated, please use `Range.anchor.isAtEndOfNode` instead."),this.anchor.isAtEndOfNode(e)}},{key:"hasAnchorBetween",value:function(e,r,n){return t.deprecate("0.37.0","The `Range.hasAnchorBetween` method is deprecated, please use the `Range.anchor` methods and properties directly instead."),this.anchor.offset<=n&&r<=this.anchor.offset&&this.anchor.isInNode(e)}},{key:"hasAnchorIn",value:function(e){return t.deprecate("0.37.0","The `Range.hasAnchorAtEndOf` method is deprecated, please use `Range.anchor.isInNode` instead."),this.anchor.isInNode(e)}},{key:"hasEdgeAtStartOf",value:function(e){return t.deprecate("0.37.0","The `Range.hasEdgeAtStartOf` method is deprecated."),this.anchor.isAtStartOfNode(e)||this.focus.isAtStartOfNode(e)}},{key:"hasEdgeAtEndOf",value:function(e){return t.deprecate("0.37.0","The `Range.hasEdgeAtEndOf` method is deprecated."),this.anchor.isAtEndOfNode(e)||this.focus.isAtEndOfNode(e)}},{key:"hasEdgeBetween",value:function(e,r,n){return t.deprecate("0.37.0","The `Range.hasEdgeBetween` method is deprecated."),this.anchor.offset<=n&&r<=this.anchor.offset&&this.anchor.isInNode(e)||this.focus.offset<=n&&r<=this.focus.offset&&this.focus.isInNode(e)}},{key:"hasEdgeIn",value:function(e){return t.deprecate("0.37.0","The `Range.hasEdgeAtEndOf` method is deprecated."),this.anchor.isInNode(e)||this.focus.isInNode(e)}},{key:"hasEndAtStartOf",value:function(e){return t.deprecate("0.37.0","The `Range.hasEndAtStartOf` method is deprecated, please use `Range.end.isAtStartOfNode` instead."),this.end.isAtStartOfNode(e)}},{key:"hasEndAtEndOf",value:function(e){return t.deprecate("0.37.0","The `Range.hasEndAtEndOf` method is deprecated, please use `Range.end.isAtEndOfNode` instead."),this.end.isAtEndOfNode(e)}},{key:"hasEndBetween",value:function(e,r,n){return t.deprecate("0.37.0","The `Range.hasEndBetween` method is deprecated, please use the `Range.end` methods and properties directly instead."),this.end.offset<=n&&r<=this.end.offset&&this.end.isInNode(e)}},{key:"hasEndIn",value:function(e){return t.deprecate("0.37.0","The `Range.hasEndAtEndOf` method is deprecated, please use `Range.end.isInNode` instead."),this.end.isInNode(e)}},{key:"hasFocusAtEndOf",value:function(e){return t.deprecate("0.37.0","The `Range.hasFocusAtEndOf` method is deprecated, please use `Range.focus.isAtEndOfNode` instead."),this.focus.isAtEndOfNode(e)}},{key:"hasFocusAtStartOf",value:function(e){return t.deprecate("0.37.0","The `Range.hasFocusAtStartOf` method is deprecated, please use `Range.focus.isAtStartOfNode` instead."),this.focus.isAtStartOfNode(e)}},{key:"hasFocusBetween",value:function(e,r,n){return t.deprecate("0.37.0","The `Range.hasFocusBetween` method is deprecated, please use the `Range.focus` methods and properties directly instead."),r<=this.focus.offset&&this.focus.offset<=n&&this.focus.isInNode(e)}},{key:"hasFocusIn",value:function(e){return t.deprecate("0.37.0","The `Range.hasFocusAtEndOf` method is deprecated, please use `Range.focus.isInNode` instead."),this.focus.isInNode(e)}},{key:"hasStartAtStartOf",value:function(e){return t.deprecate("0.37.0","The `Range.hasStartAtStartOf` method is deprecated, please use `Range.start.isAtStartOfNode` instead."),this.start.isAtStartOfNode(e)}},{key:"hasStartAtEndOf",value:function(e){return t.deprecate("0.37.0","The `Range.hasStartAtEndOf` method is deprecated, please use `Range.start.isAtEndOfNode` instead."),this.start.isAtEndOfNode(e)}},{key:"hasStartBetween",value:function(e,r,n){return t.deprecate("0.37.0","The `Range.hasStartBetween` method is deprecated, please use the `Range.start` methods and properties directly instead."),this.start.offset<=n&&r<=this.start.offset&&this.start.isInNode(e)}},{key:"hasStartIn",value:function(e){return t.deprecate("0.37.0","The `Range.hasStartAtEndOf` method is deprecated, please use `Range.start.isInNode` instead."),this.start.isInNode(e)}},{key:"isAtStartOf",value:function(e){return t.deprecate("0.37.0","The `Range.isAtStartOf` method is deprecated, please use `Range.isCollapsed` and `Point.isAtStartOfNode` instead."),this.isCollapsed&&this.anchor.isAtStartOfNode(e)}},{key:"isAtEndOf",value:function(e){return t.deprecate("0.37.0","The `Range.isAtEndOf` method is deprecated, please use `Range.isCollapsed` and `Point.isAtEndOfNode` instead."),this.isCollapsed&&this.anchor.isAtEndOfNode(e)}},{key:"blur",value:function(){return t.deprecate("0.37.0","The `Range.blur` method is deprecated, please use `Range.merge` directly instead."),this.merge({isFocused:!1})}},{key:"deselect",value:function(){return t.deprecate("0.37.0","The `Range.deselect` method is deprecated, please use `Range.create` to create a new unset range instead."),n.create()}},{key:"moveAnchorOffsetTo",value:function(e){return t.deprecate("0.37.0","The `Range.moveAnchorOffsetTo` method is deprecated, please use `Range.moveAnchorTo(offset)` instead."),this.moveAnchorTo(e)}},{key:"moveFocusOffsetTo",value:function(e){return t.deprecate("0.37.0","The `Range.moveFocusOffsetTo` method is deprecated, please use `Range.moveFocusTo(offset)` instead."),this.moveFocusTo(e)}},{key:"moveStartOffsetTo",value:function(e){return t.deprecate("0.37.0","The `Range.moveStartOffsetTo` method is deprecated, please use `Range.moveStartTo(offset)` instead."),this.moveStartTo(e)}},{key:"moveEndOffsetTo",value:function(e){return t.deprecate("0.37.0","The `Range.moveEndOffsetTo` method is deprecated, please use `Range.moveEndTo(offset)` instead."),this.moveEndTo(e)}},{key:"moveOffsetsTo",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return t.deprecate("0.37.0","The `Range.moveOffsetsTo` method is deprecated, please use `Range.moveAnchorTo` and `Range.moveFocusTo` in sequence instead."),this.moveAnchorTo(e).moveFocusTo(r)}},{key:"moveAnchorToStartOf",value:function(e){return t.deprecate("0.37.0","The `Range.moveAnchorToStartOf` method is deprecated, please use `Range.moveAnchorToStartOfNode` instead."),this.moveAnchorToStartOfNode(e)}},{key:"moveAnchorToEndOf",value:function(e){return t.deprecate("0.37.0","The `Range.moveAnchorToEndOf` method is deprecated, please use `Range.moveAnchorToEndOfNode` instead."),this.moveAnchorToEndOfNode(e)}},{key:"moveFocusToStartOf",value:function(e){return t.deprecate("0.37.0","The `Range.moveFocusToStartOf` method is deprecated, please use `Range.moveFocusToStartOfNode` instead."),this.moveFocusToStartOfNode(e)}},{key:"moveFocusToEndOf",value:function(e){return t.deprecate("0.37.0","The `Range.moveFocusToEndOf` method is deprecated, please use `Range.moveFocusToEndOfNode` instead."),this.moveFocusToEndOfNode(e)}},{key:"moveToStartOf",value:function(e){return t.deprecate("0.37.0","The `Range.moveToStartOf` method is deprecated, please use `Range.moveToStartOfNode` instead."),this.moveToStartOfNode(e)}},{key:"moveToEndOf",value:function(e){return t.deprecate("0.37.0","The `Range.moveToEndOf` method is deprecated, please use `Range.moveToEndOfNode` instead."),this.moveToEndOfNode(e)}},{key:"moveToRangeOf",value:function(){return t.deprecate("0.37.0","The `Range.moveToRangeOf` method is deprecated, please use `Range.moveToRangeOfNode` instead."),this.moveToRangeOfNode.apply(this,arguments)}},{key:"collapseToAnchor",value:function(){return t.deprecate("0.37.0","The `Range.collapseToAnchor` method is deprecated, please use `Range.moveToAnchor` instead."),this.moveToAnchor()}},{key:"collapseToEnd",value:function(){return t.deprecate("0.37.0","The `Range.collapseToEnd` method is deprecated, please use `Range.moveToEnd` instead."),this.moveToEnd()}},{key:"collapseToFocus",value:function(){return t.deprecate("0.37.0","The `Range.collapseToFocus` method is deprecated, please use `Range.moveToFocus` instead."),this.moveToFocus()}},{key:"collapseToStart",value:function(){return t.deprecate("0.37.0","The `Range.collapseToStart` method is deprecated, please use `Range.moveToStart` instead."),this.moveToStart()}},{key:"move",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return t.deprecate("0.37.0","The `Range.move` method is deprecated, please use `Range.moveForward` or `Range.moveBackward` instead."),e>0?this.moveForward(e):this.moveBackward(-e)}},{key:"moveAnchor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return t.deprecate("0.37.0","The `Range.moveAnchor` method is deprecated, please use `Range.moveAnchorForward` or `Range.moveAnchorBackward` instead."),e>0?this.moveAnchorForward(e):this.moveAnchorBackward(-e)}},{key:"moveEnd",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return t.deprecate("0.37.0","The `Range.moveEnd` method is deprecated, please use `Range.moveEndForward` or `Range.moveEndBackward` instead."),e>0?this.moveEndForward(e):this.moveEndBackward(-e)}},{key:"moveFocus",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return t.deprecate("0.37.0","The `Range.moveFocus` method is deprecated, please use `Range.moveFocusForward` or `Range.moveFocusBackward` instead."),e>0?this.moveFocusForward(e):this.moveFocusBackward(-e)}},{key:"moveStart",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return t.deprecate("0.37.0","The `Range.moveStart` method is deprecated, please use `Range.moveStartForward` or `Range.moveStartBackward` instead."),e>0?this.moveStartForward(e):this.moveStartBackward(-e)}},{key:"object",get:function(){return"range"}},{key:"kind",get:function(){return t.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),this.object}},{key:"isBlurred",get:function(){return!this.isFocused}},{key:"isCollapsed",get:function(){return this.anchor===this.focus||this.anchor.key===this.focus.key&&this.anchor.offset===this.focus.offset}},{key:"isExpanded",get:function(){return!this.isCollapsed}},{key:"isBackward",get:function(){var e=this.isUnset,t=this.anchor,r=this.focus;return e?null:t.key===r.key?t.offset>r.offset:Zr.isBefore(r.path,t.path)}},{key:"isForward",get:function(){var e=this.isBackward;return null==e?null:!e}},{key:"isUnset",get:function(){var e=this.anchor,t=this.focus;return e.isUnset||t.isUnset}},{key:"isSet",get:function(){return!this.isUnset}},{key:"start",get:function(){return this.isBackward?this.focus:this.anchor}},{key:"end",get:function(){return this.isBackward?this.anchor:this.focus}},{key:"anchorKey",get:function(){return t.deprecate("0.37.0","The `range.anchorKey` property has been deprecated, use `range.anchor.key` instead."),this.anchor.key}},{key:"anchorOffset",get:function(){return t.deprecate("0.37.0","The `range.anchorOffset` property has been deprecated, use `range.anchor.offset` instead."),this.anchor.offset}},{key:"anchorPath",get:function(){return t.deprecate("0.37.0","The `range.anchorPath` property has been deprecated, use `range.anchor.path` instead."),this.anchor.path}},{key:"focusKey",get:function(){return t.deprecate("0.37.0","The `range.focusKey` property has been deprecated, use `range.focus.key` instead."),this.focus.key}},{key:"focusOffset",get:function(){return t.deprecate("0.37.0","The `range.focusOffset` property has been deprecated, use `range.focus.offset` instead."),this.focus.offset}},{key:"focusPath",get:function(){return t.deprecate("0.37.0","The `range.focusPath` property has been deprecated, use `range.focus.path` instead."),this.focus.path}},{key:"startKey",get:function(){return t.deprecate("0.37.0","The `range.startKey` property has been deprecated, use `range.start.key` instead."),this.start.key}},{key:"startOffset",get:function(){return t.deprecate("0.37.0","The `range.startOffset` property has been deprecated, use `range.start.offset` instead."),this.start.offset}},{key:"startPath",get:function(){return t.deprecate("0.37.0","The `range.startPath` property has been deprecated, use `range.start.path` instead."),this.start.path}},{key:"endKey",get:function(){return t.deprecate("0.37.0","The `range.endKey` property has been deprecated, use `range.end.key` instead."),this.end.key}},{key:"endOffset",get:function(){return t.deprecate("0.37.0","The `range.endOffset` property has been deprecated, use `range.end.offset` instead."),this.end.offset}},{key:"endPath",get:function(){return t.deprecate("0.37.0","The `range.endPath` property has been deprecated, use `range.end.path` instead."),this.end.path}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n.isRange(e))return e;if(s(e))return n.fromJSON(e);throw new Error("`Range.create` only accepts objects or ranges, but you passed it: "+e)}},{key:"createList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(r.List.isList(e)||Array.isArray(e))return new r.List(e.map(n.create));throw new Error("`Range.createList` only accepts arrays or lists, but you passed it: "+e)}},{key:"createProperties",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n.isRange(e))return{anchor:Qr.createProperties(e.anchor),focus:Qr.createProperties(e.focus),isAtomic:e.isAtomic,isFocused:e.isFocused,marks:e.marks};if(s(e)){var t={};return"anchor"in e&&(t.anchor=Qr.create(e.anchor)),"focus"in e&&(t.focus=Qr.create(e.focus)),"isAtomic"in e&&(t.isAtomic=e.isAtomic),"isFocused"in e&&(t.isFocused=e.isFocused),"marks"in e&&(t.marks=null==e.marks?null:Mr.createSet(e.marks)),t}throw new Error("`Range.createProperties` only accepts objects or ranges, but you passed it: "+e)}},{key:"fromJSON",value:function(e){var o=e.anchor,a=e.focus,s=e.isAtomic,i=void 0!==s&&s,u=e.isFocused,c=void 0!==u&&u,l=e.marks,f=void 0===l?null:l;return!o&&(e.anchorKey||e.anchorOffset||e.anchorPath)&&(t.deprecate("0.37.0","`Range` objects now take a `Point` object as an `anchor` instead of taking `anchorKey/Offset/Path` properties. But you passed:",e),o={key:e.anchorKey,offset:e.anchorOffset,path:e.anchorPath}),!a&&(e.focusKey||e.focusOffset||e.focusPath)&&(t.deprecate("0.37.0","`Range` objects now take a `Point` object as a `focus` instead of taking `focusKey/Offset/Path` properties. But you passed:",e),a={key:e.focusKey,offset:e.focusOffset,path:e.focusPath}),new n({anchor:Qr.fromJSON(o||{}),focus:Qr.fromJSON(a||{}),isAtomic:i,isFocused:c,marks:null==f?null:new r.Set(f.map(Mr.fromJSON))})}},{key:"isRange",value:function(e){return!(!e||!e[i.RANGE])}}]),n}(r.Record(en));tn.fromJS=tn.fromJSON,tn.prototype[i.RANGE]=!0;[["collapseTo","moveTo"],["collapseToStartOf","moveToStartOfNode"],["collapseToEndOf","moveToEndOfNode"],["extend","moveFocus"],["extendTo","moveFocusTo"],["extendToStartOf","moveFocusToStartOfNode"],["extendToEndOf","moveFocusToEndOfNode"]].forEach(function(e){var r=T(e,2),n=r[0],o=r[1];tn.prototype[n]=function(){return t.deprecate("0.37.0","The `Range."+n+"` method is deprecated, please use `Range."+o+"` instead."),this[o].apply(this,arguments)}});var rn={marks:r.Set(),text:""},nn=function(e){function n(){return h(this,n),g(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return k(n,e),y(n,[{key:"updateMark",value:function(e,t){var r=this.marks;if(t.equals(e))return this;if(!r.has(e))return this;var n=r.withMutations(function(r){r.remove(e).add(t)});return this.set("marks",n)}},{key:"addMarks",value:function(e){var t=this.marks;return this.set("marks",t.union(e))}},{key:"removeMark",value:function(e){var t=this.marks;return this.set("marks",t.remove(e))}},{key:"toJSON",value:function(){return{object:this.object,text:this.text,marks:this.marks.toArray().map(function(e){return e.toJSON()})}}},{key:"toJS",value:function(){return this.toJSON()}},{key:"object",get:function(){return"leaf"}},{key:"kind",get:function(){return t.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),this.object}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n.isLeaf(e))return e;if("string"==typeof e&&(e={text:e}),s(e))return n.fromJSON(e);throw new Error("`Leaf.create` only accepts objects, strings or leaves, but you passed it: "+e)}},{key:"createLeaves",value:function(e){if(e.size<=1)return e;var t=!1,n=r.List().withMutations(function(r){e.findLast(function(e,n){var o=r.first();if(o){if(o.marks.equals(e.marks))return t=!0,void r.set(0,o.set("text",""+e.text+o.text));if(""===o.text)return t=!0,void r.set(0,e);if(""===e.text)return void(t=!0)}r.unshift(e)})});return t?n:e}},{key:"splitLeaves",value:function(e,t){if(t<0)return[r.List(),e];if(0===e.size)return[r.List(),r.List()];var n=0,o=-1,a=void 0,s=void 0;return e.find(function(e){o++;var r=n,i=e.text;if((n+=i.length)<t)return!1;if(r>t)return!1;var u=t-r;return a=e.set("text",i.slice(0,u)),s=e.set("text",i.slice(u)),!0}),a?""===a.text?0===o?[r.List.of(a),e]:[e.take(o),e.skip(o)]:""===s.text?o===e.size-1?[e,r.List.of(s)]:[e.take(o+1),e.skip(o+1)]:[e.take(o).push(a),e.skip(o+1).unshift(s)]:[e,r.List()]}},{key:"createList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(r.List.isList(e)||Array.isArray(e))return new r.List(e.map(n.create));throw new Error("`Leaf.createList` only accepts arrays or lists, but you passed it: "+e)}},{key:"fromJSON",value:function(e){var t=e.text,o=void 0===t?"":t,a=e.marks,s=void 0===a?[]:a;return new n({text:o,marks:r.Set(s.map(Mr.fromJSON))})}},{key:"isLeafList",value:function(e){return r.List.isList(e)&&e.every(function(e){return n.isLeaf(e)})}}]),n}(r.Record(rn));nn.fromJS=nn.fromJSON,nn.isLeaf=u.bind(null,"LEAF"),nn.prototype[i.LEAF]=!0;var on={leaves:r.List(),key:void 0},an=function(e){function n(){return h(this,n),g(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return k(n,e),y(n,[{key:"getKeysToPathsTable",value:function(){return p({},this.key,[])}},{key:"getString",value:function(){return this.leaves.reduce(function(e,t){return e+t.text},"")}},{key:"searchLeafAtOffset",value:function(e){var t=0,r=0,n=-1;return{leaf:this.leaves.find(function(o){return n++,(t=(r=t)+o.text.length)>=e}),endOffset:t,index:n,startOffset:r}}},{key:"addMark",value:function(e,t,n){var o=r.Set.of(n);return this.addMarks(e,t,o)}},{key:"addMarks",value:function(e,t,n){if(""===this.text&&0===t&&0===e){var o=this.leaves.first();if(!o)return this.set("leaves",r.List.of(nn.fromJSON({text:"",marks:n})));var a=o.addMarks(n);return a===o?this:this.set("leaves",r.List.of(a))}if(""===this.text)return this;if(0===t)return this;if(e>=this.text.length)return this;var s=nn.splitLeaves(this.leaves,e),i=T(s,2),u=i[0],c=i[1],l=nn.splitLeaves(c,t),f=T(l,2),d=f[0],v=f[1],h=u.concat(d.map(function(e){return e.addMarks(n)}),v);return this.setLeaves(h)}},{key:"getDecorations",value:function(e){return e.__getDecorations(this)}},{key:"getLeaves",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=this.leaves;if(0===n.size)return r.List.of(nn.create({}));if(!t||0===t.length)return n;if(0===this.text.length)return n;var o=this.key;return t.forEach(function(t){var r=t.start,a=t.end,s=t.marks,i=r.key==o,u=a.key==o;if(i&&u){var c=i?r.offset:0,l=u?a.offset-c:e.text.length-c;if(l<1)return;if(c>=e.text.length)return;if(0!==c||l<e.text.length){var f=nn.splitLeaves(n,c),d=T(f,2),v=d[0],h=d[1],y=nn.splitLeaves(h,l),p=T(y,2),m=p[0],k=p[1];return void(n=v.concat(m.map(function(e){return e.addMarks(s)}),k))}}n=n.map(function(e){return e.addMarks(s)})}),n===this.leaves?n:nn.createLeaves(n)}},{key:"getActiveMarksBetweenOffsets",value:function(e,t){if(e<=0&&t>=this.text.length)return this.getActiveMarks();if(e>=t)return r.Set();if(""===this.text)return this.getActiveMarks();var n=null,o=0;return this.leaves.forEach(function(r){var a=o;if(!((o=a+r.text.length)<=e)){if(a>=t)return!1;if(n)return(n=n.intersect(r.marks))&&n.size,!1;n=r.marks}}),n||r.Set()}},{key:"getActiveMarks",value:function(){var e=this;if(0===this.leaves.size)return r.Set();var t=this.leaves.first().marks;return 0===t.size?t:t.withMutations(function(t){e.leaves.forEach(function(e){if(t.intersect(e.marks),0===t.size)return!1})})}},{key:"getFirstText",value:function(){return this}},{key:"getLastText",value:function(){return this}},{key:"getMarksBetweenOffsets",value:function(e,t){if(e<=0&&t>=this.text.length)return this.getMarks();if(e>=t)return r.Set();if(""===this.text)return this.getActiveMarks();var n=null,o=0;return this.leaves.forEach(function(r){var a=o;if(!((o=a+r.text.length)<=e))return!(a>=t)&&void(n=n?n.union(r.marks):r.marks)}),n||r.Set()}},{key:"getMarks",value:function(){var e=this.getMarksAsArray();return new r.OrderedSet(e)}},{key:"getMarksAsArray",value:function(){if(0===this.leaves.size)return[];var e=this.leaves.first().marks;if(1===this.leaves.size)return e.toArray();var t=[];return this.leaves.forEach(function(e){t.push(e.marks.toArray())}),Array.prototype.concat.apply(e.toArray(),t)}},{key:"getMarksAtIndex",value:function(e){var t=this.searchLeafAtOffset(e).leaf;return t?t.marks:r.Set()}},{key:"getNode",value:function(e){return this.key==e?this:null}},{key:"hasNode",value:function(e){return!!this.getNode(e)}},{key:"insertText",value:function(e,t,n){if(""===this.text)return this.set("leaves",r.List.of(nn.create({text:t,marks:n})));if(0===t.length)return this;n||(n=r.Set());var o=this.searchLeafAtOffset(e),a=o.startOffset,s=o.leaf,i=o.index,u=e-a,c=s.text.slice(0,u),l=s.text.slice(u),f=this.leaves;if(s.marks.equals(n))return this.set("leaves",f.set(i,s.set("text",c+t+l)));var d=f.splice(i,1,s.set("text",c),nn.create({text:t,marks:n}),s.set("text",l));return this.setLeaves(d)}},{key:"regenerateKey",value:function(){var e=d.create();return this.set("key",e)}},{key:"removeMark",value:function(e,t,n){if(""===this.text&&0===e&&0===t){var o=this.leaves.first();if(!o)return this;var a=o.removeMark(n);return a===o?this:this.set("leaves",r.List.of(a))}if(t<=0)return this;if(e>=this.text.length)return this;var s=nn.splitLeaves(this.leaves,e),i=T(s,2),u=i[0],c=i[1],l=nn.splitLeaves(c,t),f=T(l,2),d=f[0],v=f[1],h=u.concat(d.map(function(e){return e.removeMark(n)}),v);return this.setLeaves(h)}},{key:"removeText",value:function(e,t){if(t<=0)return this;if(e>=this.text.length)return this;if(1===t){var n=this.searchLeafAtOffset(e+1),o=n.leaf,a=n.index,s=e-n.startOffset;if(o){if(1===o.text.length){var i=this.leaves.remove(a);return this.setLeaves(i)}var u=o.text.slice(0,s)+o.text.slice(s+t);if(u.length>0)return this.set("leaves",this.leaves.set(a,o.set("text",u)))}}var c=nn.splitLeaves(this.leaves,e),l=T(c,2),f=l[0],d=l[1],v=nn.splitLeaves(d,t)[1],h=nn.createLeaves(f.concat(v));if(1===h.size){var y=h.first();if(""===y.text)return this.set("leaves",r.List.of(y.set("marks",this.getActiveMarks())))}return this.set("leaves",h)}},{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={object:this.object,leaves:this.getLeaves().toArray().map(function(e){return e.toJSON()})};return e.preserveKeys&&(t.key=this.key),t}},{key:"toJS",value:function(e){return this.toJSON(e)}},{key:"updateMark",value:function(e,t,n,o){var a=n.merge(o);if(""===this.text&&0===t&&0===e){var s=this.leaves.first();if(!s)return this;var i=s.updateMark(n,a);return i===s?this:this.set("leaves",r.List.of(i))}if(t<=0)return this;if(e>=this.text.length)return this;var u=nn.splitLeaves(this.leaves,e),c=T(u,2),l=c[0],f=c[1],d=nn.splitLeaves(f,t),v=T(d,2),h=v[0],y=v[1],p=l.concat(h.map(function(e){return e.updateMark(n,a)}),y);return this.setLeaves(p)}},{key:"splitText",value:function(e){var t=nn.splitLeaves(this.leaves,e);return[this.set("leaves",t[0]),this.set("leaves",t[1]).regenerateKey()]}},{key:"mergeText",value:function(e){var t=this.leaves.concat(e.leaves);return this.setLeaves(t)}},{key:"normalize",value:function(e){return e.normalizeNode(this)}},{key:"validate",value:function(e){return e.validateNode(this)}},{key:"getFirstInvalidDescendant",value:function(e){return this.validate(e)?this:null}},{key:"setLeaves",value:function(e){var t=nn.createLeaves(e);if(1===t.size){var n=t.first();if((!n.marks||0===n.marks.size)&&""===n.text)return this.set("leaves",r.List())}return this.set("leaves",nn.createLeaves(e))}},{key:"object",get:function(){return"text"}},{key:"kind",get:function(){return t.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),this.object}},{key:"isEmpty",get:function(){return""==this.text}},{key:"text",get:function(){return this.getString()}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(n.isText(e))return e;if("string"==typeof e&&(e={leaves:[{text:e}]}),s(e)){if(e.text){var t=e,r=t.text,o=t.marks;e={key:t.key,leaves:[{text:r,marks:o}]}}return n.fromJSON(e)}throw new Error("`Text.create` only accepts objects, arrays, strings or texts, but you passed it: "+e)}},{key:"createList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(r.List.isList(e)||Array.isArray(e))return new r.List(e.map(n.create));throw new Error("`Text.createList` only accepts arrays or lists, but you passed it: "+e)}},{key:"fromJSON",value:function(e){if(n.isText(e))return e;var o=e.key,a=void 0===o?d.create():o,s=e.leaves;if(s||(e.ranges?(t.deprecate("slate@0.27.0","The `ranges` property of Slate objects has been renamed to `leaves`."),s=e.ranges):s=r.List()),Array.isArray(s))s=r.List(s.map(function(e){return nn.create(e)}));else{if(!r.List.isList(s))throw new Error("leaves must be either Array or Immutable.List");s=s.map(function(e){return nn.create(e)})}return new n({leaves:nn.createLeaves(s),key:a})}},{key:"isTextList",value:function(e){return r.List.isList(e)&&e.every(function(e){return n.isText(e)})}}]),n}(r.Record(on));an.fromJS=an.fromJSON,an.isText=u.bind(null,"TEXT"),an.prototype[i.TEXT]=!0,zr(an.prototype,["getDecorations","getActiveMarks","getMarks","getMarksAsArray","normalize","validate","getString","getKeysToPathsTable"]);var sn=function(){function e(){h(this,e)}return y(e,[{key:"addMark",value:function(e,t,r,n){var o=this.assertDescendant(e);return e=this.resolvePath(e),o=o.addMark(t,r,n),this.replaceNode(e,o)}},{key:"createPoint",value:function(e){return e=Qr.createProperties(e),this.resolvePoint(e)}},{key:"createRange",value:function(e){return e=tn.createProperties(e),this.resolveRange(e)}},{key:"filterDescendants",value:function(e){var t=[];return this.forEachDescendant(function(r,n,o){e(r,n,o)&&t.push(r)}),r.List(t)}},{key:"findDescendant",value:function(e){var t=null;return this.forEachDescendant(function(r,n,o){if(e(r,n,o))return t=r,!1}),t}},{key:"forEachDescendant",value:function(e){var t=void 0;return this.nodes.forEach(function(r,n,o){return!1===e(r,n,o)?(t=!1,!1):"text"!=r.object?t=r.forEachDescendant(e):void 0}),t}},{key:"getActiveMarksAtRange",value:function(e){if((e=this.resolveRange(e)).isUnset)return r.Set();if(e.isCollapsed){var t=e.start;return this.getMarksAtPosition(t.key,t.offset).toSet()}var n=e,o=n.start,a=n.end,s=o.key,i=o.offset,u=a.key,c=a.offset,l=this.getDescendant(s);if(s!==u){for(;s!==u&&0===c;){var f=this.getPreviousText(u);u=f.key,c=f.text.length}for(;s!==u&&i===l.text.length;)s=(l=this.getNextText(s)).key,i=0}if(s===u)return l.getActiveMarksBetweenOffsets(i,c);var d=l.getActiveMarksBetweenOffsets(i,l.text.length);if(0===d.size)return r.Set();var v=this.getDescendant(u).getActiveMarksBetweenOffsets(0,c),h=d.intersect(v);if(0===h.size)return h;for(var y=this.getNextText(s);y.key!==u;){if(0!==y.text.length&&0===(h=h.intersect(y.getActiveMarks())).size)return r.Set();y=this.getNextText(y.key)}return h}},{key:"getAncestors",value:function(e){var t=this;if(!(e=this.resolvePath(e)))return null;var n=[];return e.forEach(function(r,o){var a=e.slice(0,o),s=t.getNode(a);n.push(s)}),r.List(n)}},{key:"getBlocks",value:function(){var e=this.getBlocksAsArray();return r.List(e)}},{key:"getBlocksAsArray",value:function(){return this.nodes.reduce(function(e,t){return"block"!=t.object?e:t.isLeafBlock()?(e.push(t),e):e.concat(t.getBlocksAsArray())},[])}},{key:"getBlocksAtRange",value:function(e){var t=this.getBlocksAtRangeAsArray(e);return r.List(r.OrderedSet(t))}},{key:"getBlocksAtRangeAsArray",value:function(e){if((e=this.resolveRange(e)).isUnset)return[];var t=e,r=t.start,n=t.end,o=this.getClosestBlock(r.key);if(r.key===n.key)return[o];var a=this.getClosestBlock(n.key),s=this.getBlocksAsArray(),i=s.indexOf(o),u=s.indexOf(a);return s.slice(i,u+1)}},{key:"getBlocksByType",value:function(e){var t=this.getBlocksByTypeAsArray(e);return r.List(t)}},{key:"getBlocksByTypeAsArray",value:function(e){return this.nodes.reduce(function(t,r){return"block"!=r.object?t:r.isLeafBlock()&&r.type==e?(t.push(r),t):t.concat(r.getBlocksByTypeAsArray(e))},[])}},{key:"getChild",value:function(e){return(e=this.resolvePath(e))&&1===e.size?this.nodes.get(e.first()):null}},{key:"getClosest",value:function(e,t){var r=this,n=this.getAncestors(e);return n&&n.findLast(function(e){for(var n=arguments.length,o=Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];return e!==r&&t.apply(void 0,[e].concat(o))})||null}},{key:"getClosestBlock",value:function(e){return this.getClosest(e,function(e){return"block"===e.object})}},{key:"getClosestInline",value:function(e){return this.getClosest(e,function(e){return"inline"===e.object})}},{key:"getClosestVoid",value:function(e){return this.getClosest(e,function(e){return e.isVoid})}},{key:"getCommonAncestor",value:function(e,t){if(e=this.resolvePath(e),t=this.resolvePath(t),!e||!t)return null;var r=Zr.relate(e,t);return this.getNode(r)}},{key:"getDecorations",value:function(e){var t=e.find("decorateNode",this);return tn.createList(t||[])}},{key:"getDepth",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(e=this.resolvePath(e))&&this.getNode(e)?e.size-1+t:null}},{key:"getDescendant",value:function(e){if(!(e=this.resolvePath(e)))return null;var t=e.flatMap(function(e){return["nodes",e]});return this.getIn(t)}},{key:"getFirstInvalidDescendant",value:function(e){var t=null;return this.nodes.find(function(r){return t=r.validate(e)?r:r.getFirstInvalidDescendant(e)}),t}},{key:"getFirstText",value:function(){var e=null,t=this.nodes.find(function(t){return"text"===t.object||!!(e=t.getFirstText())});return e||t}},{key:"getFragmentAtRange",value:function(e){if((e=this.resolveRange(e)).isUnset)return Wr.create();for(var t=e,r=t.start,n=t.end,o=this,a=n.path,s=n.offset,i="end";a.size;){var u=a.last();o=o.splitNode(a,s),s=u+1,(a=Zr.lift(a)).size||"end"!==i||(a=r.path,s=r.offset,i="start")}var c=r.path.first()+1,l=n.path.first()+2,f=o.nodes.slice(c,l);return Wr.create({nodes:f})}},{key:"getFurthest",value:function(e,t){var r=this,n=this.getAncestors(e);return n&&n.find(function(e){for(var n=arguments.length,o=Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];return e!==r&&t.apply(void 0,[e].concat(o))})||null}},{key:"getFurthestAncestor",value:function(e){return(e=this.resolvePath(e))&&e.size?this.nodes.get(e.first()):null}},{key:"getFurthestBlock",value:function(e){return this.getFurthest(e,function(e){return"block"===e.object})}},{key:"getFurthestInline",value:function(e){return this.getFurthest(e,function(e){return"inline"===e.object})}},{key:"getFurthestOnlyChildAncestor",value:function(e){var t=this.getAncestors(e);return t&&t.rest().reverse().takeUntil(function(e){return e.nodes.size>1}).last()||null}},{key:"getInlines",value:function(){var e=this.getInlinesAsArray();return r.List(e)}},{key:"getInlinesAsArray",value:function(){var e=[];return this.nodes.forEach(function(t){"text"!=t.object&&(t.isLeafInline()?e.push(t):e=e.concat(t.getInlinesAsArray()))}),e}},{key:"getInlinesAtRange",value:function(e){var t=this.getInlinesAtRangeAsArray(e);return r.List(r.OrderedSet(t))}},{key:"getInlinesAtRangeAsArray",value:function(e){var t=this;return(e=this.resolveRange(e)).isUnset?[]:this.getTextsAtRangeAsArray(e).map(function(e){return t.getClosestInline(e.key)}).filter(function(e){return e})}},{key:"getInlinesByType",value:function(e){var t=this.getInlinesByTypeAsArray(e);return r.List(t)}},{key:"getInlinesByTypeAsArray",value:function(e){return this.nodes.reduce(function(t,r){return"text"==r.object?t:r.isLeafInline()&&r.type==e?(t.push(r),t):t.concat(r.getInlinesByTypeAsArray(e))},[])}},{key:"getInsertMarksAtRange",value:function(e){var t=(e=this.resolveRange(e)).start;return e.isUnset?r.Set():e.isCollapsed?this.getMarksAtPosition(t.key,t.offset):this.getDescendant(t.key).getMarksAtIndex(t.offset+1)}},{key:"getKeysToPathsTable",value:function(){var e=this,r=p({},this.key,[]);return this.nodes.forEach(function(n,o){var a=n.getKeysToPathsTable();for(var s in a){var i=a[s];r[s]&&t.warn('A node with a duplicate key of "'+s+'" was found! Duplicate keys are not allowed, you should use `node.regenerateKey` before inserting if you are reusing an existing node.',e),r[s]=[o].concat(O(i))}}),r}},{key:"getLastText",value:function(){var e=null,t=this.nodes.findLast(function(t){return"text"==t.object||(e=t.getLastText())});return e||t}},{key:"getMarks",value:function(){var e=this.getMarksAsArray();return r.Set(e)}},{key:"getMarksAsArray",value:function(){var e,t=[];return this.nodes.forEach(function(e){t.push(e.getMarksAsArray())}),(e=[]).concat.apply(e,t)}},{key:"getMarksAtPosition",value:function(e,t){var n=this.getDescendant(e).getMarksAtIndex(t);if(0!==t)return n;var o=this.getClosestBlock(e);if(""===o.text)return n;var a=this.getPreviousText(e);return a?o.hasDescendant(a.key)?a.getMarksAtIndex(a.text.length):n:r.Set()}},{key:"getMarksAtRange",value:function(e){return r.Set(this.getOrderedMarksAtRange(e))}},{key:"getMarksByType",value:function(e){var t=this.getMarksByTypeAsArray(e);return r.Set(t)}},{key:"getMarksByTypeAsArray",value:function(e){return this.nodes.reduce(function(t,r){return"text"==r.object?t.concat(r.getMarksAsArray().filter(function(t){return t.type==e})):t.concat(r.getMarksByTypeAsArray(e))},[])}},{key:"getNextBlock",value:function(e){var t=this.assertDescendant(e),r=void 0;"block"==t.object?r=t.getLastText():r=this.getClosestBlock(e).getLastText();var n=this.getNextText(r.key);return n?this.getClosestBlock(n.key):null}},{key:"getNextNode",value:function(e){if(!(e=this.resolvePath(e)))return null;if(!e.size)return null;for(var t=e.size;t>0;t--){var r=e.slice(0,t),n=Zr.increment(r),o=this.getNode(n);if(o)return o}return null}},{key:"getNextSibling",value:function(e){if(!(e=this.resolvePath(e)))return null;if(!e.size)return null;var t=Zr.increment(e);return this.getNode(t)}},{key:"getNextText",value:function(e){if(!(e=this.resolvePath(e)))return null;if(!e.size)return null;var t=this.getNextNode(e);return t?t.getFirstText():null}},{key:"getNode",value:function(e){return(e=this.resolvePath(e))?e.size?this.getDescendant(e):this:null}},{key:"getOffset",value:function(e){this.assertDescendant(e);var t=this.getFurthestAncestor(e),r=this.nodes.takeUntil(function(e){return e==t}).reduce(function(e,t){return e+t.text.length},0);return this.hasChild(e)?r:r+t.getOffset(e)}},{key:"getOffsetAtRange",value:function(e){if((e=this.resolveRange(e)).isUnset)throw new Error("The range cannot be unset to calculcate its offset.");if(e.isExpanded)throw new Error("The range must be collapsed to calculcate its offset.");var t=e.start;return this.getOffset(t.key)+t.offset}},{key:"getOrderedMarks",value:function(){var e=this.getMarksAsArray();return r.OrderedSet(e)}},{key:"getOrderedMarksAtRange",value:function(e){var t=e=this.resolveRange(e),n=t.start,o=t.end;return e.isUnset?r.OrderedSet():e.isCollapsed?this.getMarksAtPosition(n.key,n.offset):this.getOrderedMarksBetweenPositions(n.key,n.offset,o.key,o.offset)}},{key:"getOrderedMarksBetweenPositions",value:function(e,t,n,o){if(e===n)return this.getDescendant(e).getMarksBetweenOffsets(t,o);var a=this.getTextsBetweenPositionsAsArray(e,n);return r.OrderedSet().withMutations(function(r){a.forEach(function(a){a.key===e?r.union(a.getMarksBetweenOffsets(t,a.text.length)):a.key===n?r.union(a.getMarksBetweenOffsets(0,o)):r.union(a.getMarks())})})}},{key:"getOrderedMarksByType",value:function(e){var t=this.getMarksByTypeAsArray(e);return r.OrderedSet(t)}},{key:"getParent",value:function(e){if(!(e=this.resolvePath(e)))return null;if(!e.size)return null;var t=Zr.lift(e);return this.getNode(t)}},{key:"getPath",value:function(e){if(r.List.isList(e))return e;var t=this.getKeysToPathsTable()[e];return t?r.List(t):null}},{key:"getPreviousBlock",value:function(e){var t=this.assertDescendant(e),r=void 0;"block"==t.object?r=t.getFirstText():r=this.getClosestBlock(e).getFirstText();var n=this.getPreviousText(r.key);return n?this.getClosestBlock(n.key):null}},{key:"getPreviousNode",value:function(e){if(!(e=this.resolvePath(e)))return null;if(!e.size)return null;for(var t=e.size;t>0;t--){var r=e.slice(0,t);if(0!==r.last()){var n=Zr.decrement(r),o=this.getNode(n);if(o)return o}}return null}},{key:"getPreviousSibling",value:function(e){if(!(e=this.resolvePath(e)))return null;if(!e.size)return null;if(0===e.last())return null;var t=Zr.decrement(e);return this.getNode(t)}},{key:"getPreviousText",value:function(e){if(!(e=this.resolvePath(e)))return null;if(!e.size)return null;var t=this.getPreviousNode(e);return t?t.getLastText():null}},{key:"getSelectionIndexes",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.start,n=e.end;if(!t)return null;if(e.isUnset)return null;if(r.key==n.key){var o=this.getFurthestAncestor(r.key),a=o?this.nodes.indexOf(o):null;return{start:a,end:a+1}}var s=null,i=null;return this.nodes.forEach(function(e,t){return"text"==e.object?(null==s&&e.key==r.key&&(s=t),null==i&&e.key==n.key&&(i=t+1)):(null==s&&e.hasDescendant(r.key)&&(s=t),null==i&&e.hasDescendant(n.key)&&(i=t+1)),null==s||null==i}),t&&null==s&&(s=0),t&&null==i&&(i=this.nodes.size),null==s?null:{start:s,end:i}}},{key:"getText",value:function(){return this.nodes.reduce(function(e,t){return e+t.text},"")}},{key:"getTextAtOffset",value:function(e){if(0===e)return this.getFirstText();if(e===this.text.length)return this.getLastText();if(e<0||e>this.text.length)return null;var t=0;return this.getTexts().find(function(r,n,o){return(t+=r.text.length)>e})}},{key:"getTextDirection",value:function(){var e=Ur(this.text);return"neutral"===e?null:e}},{key:"getTexts",value:function(){var e=this.getTextsAsArray();return r.List(e)}},{key:"getTextsAsArray",value:function(){var e=[];return this.nodes.forEach(function(t){"text"==t.object?e.push(t):e=e.concat(t.getTextsAsArray())}),e}},{key:"getTextsAtRange",value:function(e){if((e=this.resolveRange(e)).isUnset)return r.List();var t=e,n=t.start,o=t.end;return r.List(this.getTextsBetweenPositionsAsArray(n.key,o.key))}},{key:"getTextsAtRangeAsArray",value:function(e){if((e=this.resolveRange(e)).isUnset)return[];var t=e,r=t.start,n=t.end;return this.getTextsBetweenPositionsAsArray(r.key,n.key)}},{key:"getTextsBetweenPositionsAsArray",value:function(e,t){var r=this.getDescendant(e);if(e==t)return[r];var n=this.getDescendant(t),o=this.getTextsAsArray(),a=o.indexOf(r),s=o.indexOf(n,a);return o.slice(a,s+1)}},{key:"hasBlockChildren",value:function(){return!(!this.nodes||!this.nodes.find(function(e){return"block"===e.object}))}},{key:"hasChild",value:function(e){return!!this.getChild(e)}},{key:"hasInlineChildren",value:function(){return!(!this.nodes||!this.nodes.find(function(e){return"inline"===e.object||"text"===e.object}))}},{key:"hasDescendant",value:function(e){return!!this.getDescendant(e)}},{key:"hasNode",value:function(e){return!!this.getNode(e)}},{key:"hasVoidParent",value:function(e){return!!this.getClosestVoid(e)}},{key:"insertNode",value:function(e,t){var r=(e=this.resolvePath(e)).last(),n=Zr.lift(e),o=this.assertNode(n),a=o.nodes.splice(r,0,t);return o=o.set("nodes",a),this.replaceNode(n,o)}},{key:"insertText",value:function(e,t,r,n){var o=this.assertDescendant(e);return e=this.resolvePath(e),o=o.insertText(t,r,n),this.replaceNode(e,o)}},{key:"isLeafBlock",value:function(){return"block"===this.object&&this.nodes.every(function(e){return"block"!==e.object})}},{key:"isLeafInline",value:function(){return"inline"===this.object&&this.nodes.every(function(e){return"inline"!==e.object})}},{key:"mapChildren",value:function(e){var t=this,r=this.nodes;return r.forEach(function(n,o){var a=e(n,o,t.nodes);a!==n&&(r=r.set(a.key,a))}),this.set("nodes",r)}},{key:"mapDescendants",value:function(e){var t=this,r=this.nodes;return r.forEach(function(n,o){var a=n;"text"!==a.object&&(a=a.mapDescendants(e)),(a=e(a,o,t.nodes))!==n&&(r=r.set(o,a))}),this.set("nodes",r)}},{key:"mergeNode",value:function(e){var t=this.assertNode(e);if(0===(e=this.resolvePath(e)).last())throw new Error("Unable to merge node because it has no previous sibling: "+t);var r=Zr.decrement(e),n=this.assertNode(r);if(n.object!==t.object)throw new Error("Unable to merge two different kinds of nodes: "+n+" and "+t);var o="text"===n.object?n.mergeText(t):n.set("nodes",n.nodes.concat(t.nodes)),a=this;return a=(a=(a=a.removeNode(e)).removeNode(r)).insertNode(r,o)}},{key:"moveNode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=this.assertNode(e);e=this.resolvePath(e),t=this.resolvePath(t,r);var o=Zr.lift(t);this.assertNode(o);var a=Zr.crop(e,t),s=T(a,2),i=s[0],u=s[1],c=Zr.compare(i,u);e.size<t.size&&-1===c&&(t=Zr.decrement(t,1,i.size-1));var l=this;return l=(l=l.removeNode(e)).insertNode(t,n)}},{key:"normalize",value:function(e){return e.normalizeNode(this)}},{key:"refindNode",value:function(e,t){var r=this.getDescendant(e);return r&&r.key===t?r:this.getDescendant(t)}},{key:"refindPath",value:function(e,t){var r=this.getDescendant(e);return r&&r.key===t?e:this.getPath(t)}},{key:"regenerateKey",value:function(){var e=d.create();return this.set("key",e)}},{key:"removeMark",value:function(e,t,r,n){var o=this.assertDescendant(e);return e=this.resolvePath(e),o=o.removeMark(t,r,n),this.replaceNode(e,o)}},{key:"removeNode",value:function(e){this.assertDescendant(e);var t=(e=this.resolvePath(e)).flatMap(function(e){return["nodes",e]});return this.deleteIn(t)}},{key:"removeText",value:function(e,t,r){var n=this.assertDescendant(e);return n=n.removeText(t,r.length),this.replaceNode(e,n)}},{key:"replaceNode",value:function(e,t){if(!(e=this.resolvePath(e)))throw new Error("Unable to replace a node because it could not be found in the first place: "+e);if(!e.size)return t;this.assertNode(e);var r=e.flatMap(function(e){return["nodes",e]});return this.setIn(r,t)}},{key:"resolvePath",value:function(e,t){return"string"==typeof e?(e=this.getPath(e),null!=t&&(e=e.concat(t))):e=Zr.create(e),e}},{key:"resolvePoint",value:function(e){return e=(e=Qr.create(e)).normalize(this)}},{key:"resolveRange",value:function(e){return e=(e=tn.create(e)).normalize(this)}},{key:"setNode",value:function(e,t){var r=this.assertNode(e);return r=r.merge(t),this.replaceNode(e,r)}},{key:"setMark",value:function(e,t,r,n,o){var a=this.assertNode(e);return a=a.updateMark(t,r,n,o),this.replaceNode(e,a)}},{key:"splitNode",value:function(e,t,r){var n=this.assertNode(e);e=this.resolvePath(e);var o=void 0,a=void 0;if("text"===n.object){var s=n.splitText(t),i=T(s,2);o=i[0],a=i[1]}else{var u=n.nodes.take(t),c=n.nodes.skip(t);o=n.set("nodes",u),a=n.set("nodes",c).regenerateKey()}r&&"text"!==n.object&&(a=a.merge(r));var l=this;return l=(l=(l=l.removeNode(e)).insertNode(e,a)).insertNode(e,o)}},{key:"validate",value:function(e){return e.validateNode(this)}},{key:"getNodeAtPath",value:function(e){return t.deprecate("0.35.0","The `Node.getNodeAtPath` method has been combined into `Node.getNode`."),this.getNode(e)}},{key:"getDescendantAtPath",value:function(e){return t.deprecate("0.35.0","The `Node.getDescendantAtPath` has been combined into `Node.getDescendant`."),this.getDescendant(e)}},{key:"getKeys",value:function(){t.deprecate("0.35.0","The `Node.getKeys` method is deprecated.");var e=this.getKeysAsArray();return r.Set(e)}},{key:"getKeysAsArray",value:function(){t.deprecate("0.35.0","The `Node.getKeysAsArray` method is deprecated.");var e=this.getKeysToPathsTable(),r=[];for(var n in e)this.key!==n&&r.push(n);return r}},{key:"areDescendantsSorted",value:function(e,r){var n=this;t.deprecate("0.35.0","The `Node.areDescendantsSorted` method is deprecated. Use the new `PathUtils.compare` helper instead."),e=d.create(e),r=d.create(r);var o=this.getKeysAsArray().filter(function(e){return e!==n.key}),a=o.indexOf(e),s=o.indexOf(r);return-1==a||-1==s?null:a<s}},{key:"isInRange",value:function(e){t.deprecate("0.35.0","The `Node.isInRange` method is deprecated. Use the new `PathUtils.compare` helper instead.");var r=this,n=e=this.resolveRange(e),o=n.startKey,a=n.endKey,s=n.isCollapsed;if(r.key==o||r.key==a||r.hasDescendant(o)||r.hasDescendant(a))return!0;if(s)return!1;var i=!1;return r.getTextsAtRange(e).forEach(function(e){return r.hasDescendant(e.key)&&(i=!0),i}),i}}],[{key:"create",value:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.isNode(r))return r;if(s(r)){var n=r.object;switch(!n&&r.kind&&(t.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),n=r.kind),n){case"block":return b.create(r);case"document":return Wr.create(r);case"inline":return Fr.create(r);case"text":return an.create(r);default:throw new Error("`Node.create` requires a `object` string.")}}throw new Error("`Node.create` only accepts objects or nodes but you passed it: "+r)}},{key:"createList",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(r.List.isList(t)||Array.isArray(t))return r.List(t.map(e.create));throw new Error("`Node.createList` only accepts lists or arrays, but you passed it: "+t)}},{key:"createProperties",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(b.isBlock(e)||Fr.isInline(e))return{data:e.data,isVoid:e.isVoid,type:e.type};if("string"==typeof e)return{type:e};if(s(e)){var t={};return"type"in e&&(t.type=e.type),"data"in e&&(t.data=Br.create(e.data)),"isVoid"in e&&(t.isVoid=e.isVoid),t}throw new Error("`Node.createProperties` only accepts objects, strings, blocks or inlines, but you passed it: "+e)}},{key:"fromJSON",value:function(e){var r=e.object;switch(!r&&e.kind&&(t.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),r=e.kind),r){case"block":return b.fromJSON(e);case"document":return Wr.fromJSON(e);case"inline":return Fr.fromJSON(e);case"text":return an.fromJSON(e);default:throw new Error("`Node.fromJSON` requires an `object` of either 'block', 'document', 'inline' or 'text', but you passed: "+e)}}},{key:"isNode",value:function(e){return!!["BLOCK","DOCUMENT","INLINE","TEXT"].find(function(t){return u(t,e)})}},{key:"isNodeList",value:function(t){return r.List.isList(t)&&t.every(function(t){return e.isNode(t)})}}]),e}();sn.fromJS=sn.fromJSON;var un=function(e){sn.prototype["assert"+e]=function(t){for(var r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];var a=this["get"+e].apply(this,[t].concat(n));if(null==a)throw new Error("`Node.assert"+e+"` could not find node with path or key: "+t);return a}},cn=!0,ln=!1,fn=void 0;try{for(var dn,vn=["Child","Depth","Descendant","Node","Parent","Path"][Symbol.iterator]();!(cn=(dn=vn.next()).done);cn=!0){un(dn.value)}}catch(e){ln=!0,fn=e}finally{try{!cn&&vn.return&&vn.return()}finally{if(ln)throw fn}}zr(sn.prototype,["getBlocksAsArray","getBlocksAtRangeAsArray","getBlocksByTypeAsArray","getDecorations","getFirstInvalidDescendant","getFirstText","getFragmentAtRange","getInlinesAsArray","getInlinesAtRangeAsArray","getInlinesByTypeAsArray","getMarksAsArray","getMarksAtPosition","getOrderedMarksBetweenPositions","getInsertMarksAtRange","getKeysToPathsTable","getLastText","getMarksByTypeAsArray","getNextBlock","getOffset","getOffsetAtRange","getPreviousBlock","getText","getTextAtOffset","getTextDirection","getTextsAsArray","getTextsBetweenPositionsAsArray","isLeafBlock","isLeafInline","normalize","validate"]),Object.getOwnPropertyNames(sn.prototype).forEach(function(e){"constructor"!==e&&(b.prototype[e]=sn.prototype[e],Fr.prototype[e]=sn.prototype[e],Wr.prototype[e]=sn.prototype[e])}),b.createChildren=sn.createList,Fr.createChildren=sn.createList,Wr.createChildren=sn.createList;var hn=Y(function(e,t){!function(r){var n=t,o=e&&e.exports==n&&e,a="object"==typeof q&&q;a.global!==a&&a.window!==a||(r=a);var s=/([\0-\u02FF\u0370-\u1AAF\u1B00-\u1DBF\u1E00-\u20CF\u2100-\uD7FF\uE000-\uFE1F\uFE30-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])([\u0300-\u036F\u1AB0-\u1AFF\u1DC0-\u1DFF\u20D0-\u20FF\uFE20-\uFE2F]+)/g,i=/([\uD800-\uDBFF])([\uDC00-\uDFFF])/g,u=function(e){for(var t="",r=(e=e.replace(s,function(e,t,r){return u(r)+t}).replace(i,"$2$1")).length;r--;)t+=e.charAt(r);return t},c={version:"0.2.0",reverse:u};if(n&&!n.nodeType)if(o)o.exports=c;else for(var l in c)c.hasOwnProperty(l)&&(n[l]=c[l]);else r.esrever=c}(q)}).reverse,yn=55296,pn=57343,mn=/\s/,kn=/['\u2018\u2019]/,gn=/[\u0021-\u0023\u0025-\u002A\u002C-\u002F\u003A\u003B\u003F\u0040\u005B-\u005D\u005F\u007B\u007D\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0AF0\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E3B\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]/;function Tn(e){return yn<=e&&e<=pn}function On(e,t){if(mn.test(e))return!1;if(kn.test(e)){var r=t.charAt(0),n=An(r);if(On(r=t.slice(0,n),t.slice(n)))return!0}return!gn.test(e)}function An(e){return Tn(e.charCodeAt(0))?2:1}function bn(e){return An(e.charAt(0))}function Nn(e){for(var t=0,r=0,n=!1,o=void 0;o=e.charAt(r);){var a=An(o);if(On(o=e.slice(r,r+a),e.slice(r+a)))n=!0,t+=a;else{if(n)break;t+=a}r+=a}return t}var xn={getCharLength:An,getCharOffset:bn,getCharOffsetBackward:function(e,t){return e=e.slice(0,t),bn(e=hn(e))},getCharOffsetForward:function(e,t){return bn(e=e.slice(t))},getWordOffset:Nn,getWordOffsetBackward:function(e,t){return e=e.slice(0,t),Nn(e=hn(e))},getWordOffsetForward:function(e,t){return Nn(e=e.slice(t))},isSurrogate:Tn,isWord:On},Sn={addMarkAtRange:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!t.isCollapsed){var o=e.getFlag("normalize",n),a=e.value.document,s=t.start,i=t.end;a.getTextsAtRange(t).forEach(function(t){var n=t.key,a=0,u=t.text.length;n==s.key&&(a=s.offset),n==i.key&&(u=i.offset),n==s.key&&n==i.key&&(u=i.offset-s.offset),e.addMarkByKey(n,a,u,r,{normalize:o})})}},addMarksAtRange:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};r.forEach(function(r){return e.addMarkAtRange(t,r,n)})},deleteAtRange:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t.isCollapsed){e.snapshotSelection();var n=e.getFlag("normalize",r),o=e.value,a=t.start,s=t.end,i=a.key,u=a.offset,c=s.key,l=s.offset,f=o.document,d=f.hasVoidParent(i),v=f.hasVoidParent(c),h=f.getClosestBlock(i),y=f.getClosestBlock(c),p=0==u&&0==l&&0==d&&i==h.getFirstText().key&&c==y.getFirstText().key;if(p&&v){var m=f.getPreviousText(c);c=m.key,l=m.text.length,v=f.hasVoidParent(c)}for(;d;){var k=f.getClosestVoid(i),g=f.getNextText(i);if(e.removeNodeByKey(k.key,{normalize:!1}),i==c)return;if(!g)return;f=e.value.document,i=g.key,u=0,d=f.hasVoidParent(i)}for(;v;){var T=f.getClosestVoid(c),O=f.getPreviousText(c);e.removeNodeByKey(T.key,{normalize:!1}),f=e.value.document,c=O.key,l=O.text.length,v=f.hasVoidParent(c)}if(i==c&&p)e.removeNodeByKey(h.key,{normalize:n});else if(i!=c){h=f.getClosestBlock(i),y=f.getClosestBlock(c);var A=f.getNode(i),b=f.getNode(c),N=A.text.length-u,x=l,S=f.getCommonAncestor(i,c),E=S.getFurthestAncestor(i),w=S.getFurthestAncestor(c),F=f.getParent(h.key),B=F.nodes.indexOf(h),_=F.nodes.indexOf(y),P=void 0;for(P=A;P.key!=E.key;){var j=f.getParent(P.key),C=j.nodes.indexOf(P);j.nodes.slice(C+1).reverse().forEach(function(t){e.removeNodeByKey(t.key,{normalize:!1})}),P=j}var R=S.nodes.indexOf(E),z=S.nodes.indexOf(w);for(S.nodes.slice(R+1,z).reverse().forEach(function(t){e.removeNodeByKey(t.key,{normalize:!1})}),P=b;P.key!=w.key;){var I=f.getParent(P.key),L=I.nodes.indexOf(P);I.nodes.slice(0,L).reverse().forEach(function(t){e.removeNodeByKey(t.key,{normalize:!1})}),P=I}if(0!=N&&e.removeTextByKey(i,u,N,{normalize:!1}),0!=x&&e.removeTextByKey(c,0,l,{normalize:!1}),h.key!=y.key){var D=(f=e.value.document).getFurthestOnlyChildAncestor(y.key);_!=B+1&&e.moveNodeByKey(y.key,F.key,B+1,{normalize:!1}),p?e.removeNodeByKey(h.key,{normalize:!1}):e.mergeNodeByKey(y.key,{normalize:!1}),D&&e.removeNodeByKey(D.key,{normalize:!1})}n&&e.normalizeNodeByKey(S.key)}else{var M=u,K=l-u;e.removeTextByKey(i,M,K,{normalize:n})}}},deleteCharBackwardAtRange:function(e,t,r){var n=e.value.document,o=t.start,a=n.getClosestBlock(o.key),s=a.getOffset(o.key)+o.offset,i=a.text,u=xn.getCharOffsetBackward(i,s);e.deleteBackwardAtRange(t,u,r)},deleteLineBackwardAtRange:function(e,t,r){var n=e.value.document,o=t.start,a=n.getClosestBlock(o.key).getOffset(o.key)+o.offset;e.deleteBackwardAtRange(t,a,r)},deleteWordBackwardAtRange:function(e,t,r){var n=e.value.document,o=t.start,a=n.getClosestBlock(o.key),s=a.getOffset(o.key)+o.offset,i=a.text,u=0===s?1:xn.getWordOffsetBackward(i,s);e.deleteBackwardAtRange(t,u,r)},deleteBackwardAtRange:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(0!==r){var o=e.getFlag("normalize",n),a=e.value.document,s=t,i=s.start,u=s.focus;if(t.isExpanded)e.deleteAtRange(t,{normalize:o});else{var c=a.getClosestVoid(i.key);if(c)e.removeNodeByKey(c.key,{normalize:o});else{var l=a.getClosestBlock(i.key);if(l&&l.isEmpty&&1!==a.nodes.size)e.removeNodeByKey(l.key,{normalize:o});else if(!i.isAtStartOfNode(a)){var f=a.getDescendant(i.key);if(i.isAtStartOfNode(f)){var d=a.getPreviousText(f.key),v=a.getClosestBlock(d.key),h=a.getClosestVoid(d.key);if(h)return void e.removeNodeByKey(h.key,{normalize:o});if(1==r&&v!=l)return t=t.moveAnchorTo(d.key,d.text.length),void e.deleteAtRange(t,{normalize:o})}if(r<u.offset)return t=t.moveFocusBackward(r),void e.deleteAtRange(t,{normalize:o});for(var y=f,p=0,m=u.offset;r>m;){var k=m+(y=a.getPreviousText(y.key)).text.length;if(r<=k){p=k-r;break}m=k}t=t.moveAnchorTo(y.key,p),e.deleteAtRange(t,{normalize:o})}}}}},deleteCharForwardAtRange:function(e,t,r){var n=e.value.document,o=t.start,a=n.getClosestBlock(o.key),s=a.getOffset(o.key)+o.offset,i=a.text,u=xn.getCharOffsetForward(i,s);e.deleteForwardAtRange(t,u,r)},deleteLineForwardAtRange:function(e,t,r){var n=e.value.document,o=t.start,a=n.getClosestBlock(o.key),s=a.getOffset(o.key)+o.offset;e.deleteForwardAtRange(t,a.text.length-s,r)},deleteWordForwardAtRange:function(e,t,r){var n=e.value.document,o=t.start,a=n.getClosestBlock(o.key),s=a.getOffset(o.key)+o.offset,i=a.text,u=xn.getWordOffsetForward(i,s);e.deleteForwardAtRange(t,u,r)},deleteForwardAtRange:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(0!==r){var o=e.getFlag("normalize",n),a=e.value.document,s=t,i=s.start,u=s.focus;if(t.isExpanded)e.deleteAtRange(t,{normalize:o});else{var c=a.getClosestVoid(i.key);if(c)e.removeNodeByKey(c.key,{normalize:o});else{var l=a.getClosestBlock(i.key);if(l&&l.isEmpty&&1!==a.nodes.size){var f=a.getNextBlock(l.key);return e.removeNodeByKey(l.key,{normalize:o}),void(f&&f.key&&e.moveToStartOfNode(f))}if(!i.isAtEndOfNode(a)){var d=a.getDescendant(i.key);if(i.isAtEndOfNode(d)){var v=a.getNextText(d.key),h=a.getClosestBlock(v.key),y=a.getClosestVoid(v.key);if(y)return void e.removeNodeByKey(y.key,{normalize:o});if(1==r&&h!=l)return t=t.moveFocusTo(v.key,0),void e.deleteAtRange(t,{normalize:o})}if(r<=d.text.length-u.offset)return t=t.moveFocusForward(r),void e.deleteAtRange(t,{normalize:o});for(var p=d,m=u.offset,k=d.text.length-u.offset;r>k;){var g=k+(p=a.getNextText(p.key)).text.length;if(r<=g){m=r-k;break}k=g}t=t.moveFocusTo(p.key,m),e.deleteAtRange(t,{normalize:o})}}}}},insertBlockAtRange:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};r=b.create(r);var o=e.getFlag("normalize",n);t.isExpanded&&(e.deleteAtRange(t),t=t.moveToStart());var a=e.value.document,s=t.start,i=s.key,u=s.offset,c=a.getClosestBlock(i),l=a.getClosestInline(i),f=a.getParent(c.key),d=f.nodes.indexOf(c);if(c.isVoid){var v=s.isAtEndOfNode(c)?1:0;e.insertNodeByKey(f.key,d+v,r,{normalize:o})}else if(c.isEmpty)e.insertNodeByKey(f.key,d+1,r,{normalize:o});else if(s.isAtStartOfNode(c))e.insertNodeByKey(f.key,d,r,{normalize:o});else if(s.isAtEndOfNode(c))e.insertNodeByKey(f.key,d+1,r,{normalize:o});else{if(l&&l.isVoid){var h=s.isAtEndOfNode(l),y=h?a.getNextText(i):a.getPreviousText(i),p=h?t.moveToStartOfNode(y):t.moveToEndOfNode(y);i=p.start.key,u=p.start.offset}e.splitDescendantsByKey(c.key,i,u,{normalize:!1}),e.insertNodeByKey(f.key,d+1,r,{normalize:o})}o&&e.normalizeNodeByKey(f.key)},insertFragmentAtRange:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=e.getFlag("normalize",o);if(t.isExpanded&&(e.deleteAtRange(t,{normalize:!1}),t=e.value.document.getDescendant(t.start.key)?t.moveToStart():t.moveTo(t.end.key,0).normalize(e.value.document)),n.nodes.size){n=n.mapDescendants(function(e){return e.regenerateKey()});var s=t.start,i=e.value.document,u=i.getDescendant(s.key),c=i.getClosestBlock(u.key),l=c.getFurthestAncestor(u.key),f=s.isAtStartOfNode(c),d=i.getParent(c.key),v=d.nodes.indexOf(c),h=n.getBlocks(),y=n.nodes.first(),p=n.nodes.last(),m=h.first(),k=h.last();if(m==k&&m.isVoid)e.insertBlockAtRange(t,m,o);else if(y.hasBlockChildren()||p.hasBlockChildren())n.nodes.reverse().forEach(function(r){e.insertBlockAtRange(t,r,o)});else{if(m!=k){var g=n.getFurthest(m.key,function(e){return 1==e.nodes.size})||m,T=d.nodes.indexOf(c);(n=n.removeNode(g.key)).nodes.forEach(function(t,r){var n=T+r+1;e.insertNodeByKey(d.key,n,t,{normalize:!1})})}if(0!=s.offset&&e.splitDescendantsByKey(l.key,s.key,s.offset,{normalize:!1}),u=(i=e.value.document).getDescendant(s.key),l=(c=i.getClosestBlock(s.key)).getFurthestAncestor(u.key),m!=k){var O=f?l:c.getNextSibling(l.key),A=O?c.nodes.skipUntil(function(e){return e.key==O.key}):r.List(),b=k.nodes.size;A.forEach(function(t,r){var n=b+r;e.moveNodeByKey(t.key,k.key,n,{normalize:!1})})}if(c.isEmpty)e.removeNodeByKey(c.key,{normalize:!1}),e.insertNodeByKey(d.key,v,m,{normalize:!1});else{var N=c.getFurthestAncestor(u.key),x=c.nodes.indexOf(N);m.nodes.forEach(function(t,r){var n=0==s.offset?0:1,o=x+r+n;e.insertNodeByKey(c.key,o,t,{normalize:!1})})}a&&e.normalizeNodeByKey(d.key)}}},insertInlineAtRange:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=e.getFlag("normalize",n);r=Fr.create(r),t.isExpanded&&(e.deleteAtRange(t,{normalize:!1}),t=t.moveToStart());var a=e.value.document,s=t.start,i=a.getParent(s.key),u=a.assertDescendant(s.key),c=i.nodes.indexOf(u);i.isVoid||(e.splitNodeByKey(s.key,s.offset,{normalize:!1}),e.insertNodeByKey(i.key,c+1,r,{normalize:!1}),o&&e.normalizeNodeByKey(i.key))},insertTextAtRange:function(e,t,r,n){var o=(arguments.length>4&&void 0!==arguments[4]?arguments[4]:{}).normalize,a=e.value.document,s=t.start,i=s.key,u=s.offset;if(!a.getParent(s.key).isVoid&&(t.isExpanded&&(e.deleteAtRange(t,{normalize:!1}),e.value.selection.start.key!==i&&(i=e.value.selection.start.key,u=e.value.selection.start.offset)),void 0===o&&(o=t.isExpanded&&n&&0!==n.size),e.insertTextByKey(i,u,r,n,{normalize:!1}),o)){var c=a.getCommonAncestor(s.key,t.end.key),l=a.getAncestors(c.key).push(c).findLast(function(t){return e.value.document.getDescendant(t.key)}),f=l?l.key:s.key;e.normalizeNodeByKey(f)}},removeMarkAtRange:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!t.isCollapsed){var o=e.getFlag("normalize",n),a=e.value.document.getTextsAtRange(t),s=t.start,i=t.end;a.forEach(function(t){var n=t.key,a=0,u=t.text.length;n==s.key&&(a=s.offset),n==i.key&&(u=i.offset),n==s.key&&n==i.key&&(u=i.offset-s.offset),e.removeMarkByKey(n,a,u,r,{normalize:o})})}},setBlocksAtRange:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=e.getFlag("normalize",n),a=e.value.document,s=a.getBlocksAtRange(t),i=t.start,u=t.end,c=t.isCollapsed,l=a.hasVoidParent(i.key),f=a.getClosestBlock(i.key),d=a.getClosestBlock(u.key);(0==c&&0==i.offset&&0==u.offset&&0==l&&i.key==f.getFirstText().key&&u.key==d.getFirstText().key?s.slice(0,-1):s).forEach(function(t){e.setNodeByKey(t.key,r,{normalize:o})})},setBlockAtRange:function(){t.deprecate("slate@0.33.0","The `setBlockAtRange` method of Slate changes has been renamed to `setBlocksAtRange`."),Sn.setBlocksAtRange.apply(Sn,arguments)},setInlinesAtRange:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=e.getFlag("normalize",n);e.value.document.getInlinesAtRange(t).forEach(function(t){e.setNodeByKey(t.key,r,{normalize:o})})},setInlineAtRange:function(){t.deprecate("slate@0.33.0","The `setInlineAtRange` method of Slate changes has been renamed to `setInlinesAtRange`."),Sn.setInlinesAtRange.apply(Sn,arguments)},splitBlockAtRange:function(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=e.getFlag("normalize",n),a=t,s=a.start,i=a.end,u=e.value.document,c=u.assertDescendant(s.key),l=u.getClosestBlock(c.key),f=0;l&&"block"==l.object&&f<r;)c=l,l=u.getClosestBlock(l.key),f++;if(e.splitDescendantsByKey(c.key,s.key,s.offset,{normalize:o&&t.isCollapsed}),t.isExpanded){t.isBackward&&(t=t.flip());var d=e.value.document.getNextBlock(c.key);t=t.moveAnchorToStartOfNode(d),s.key===i.key&&(t=t.moveFocusTo(t.anchor.key,i.offset-s.offset)),e.deleteAtRange(t,{normalize:o})}},splitInlineAtRange:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=e.getFlag("normalize",n);t.isExpanded&&(e.deleteAtRange(t,{normalize:o}),t=t.moveToStart());for(var a=t.start,s=e.value.document,i=s.assertDescendant(a.key),u=s.getClosestInline(i.key),c=0;u&&"inline"==u.object&&c<r;)i=u,u=s.getClosestInline(u.key),c++;e.splitDescendantsByKey(i.key,a.key,a.offset,{normalize:o})},toggleMarkAtRange:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!t.isCollapsed){r=Mr.create(r);var o=e.getFlag("normalize",n);e.value.document.getActiveMarksAtRange(t).some(function(e){return e.equals(r)})?e.removeMarkAtRange(t,r,{normalize:o}):e.addMarkAtRange(t,r,{normalize:o})}},unwrapBlockAtRange:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};r=sn.createProperties(r);var o=e.getFlag("normalize",n),a=e.value.document,s=a.getBlocksAtRange(t);s.map(function(e){return a.getClosest(e.key,function(e){return"block"==e.object&&((null==r.type||e.type==r.type)&&((null==r.isVoid||e.isVoid==r.isVoid)&&!(null!=r.data&&!e.data.isSuperset(r.data))))})}).filter(function(e){return e}).toOrderedSet().toList().forEach(function(t){var r=t.nodes.first(),n=t.nodes.last(),o=a.getParent(t.key),i=o.nodes.indexOf(t),u=t.nodes.filter(function(e){return s.some(function(t){return e==t||e.hasDescendant(t.key)})}),c=u.first(),l=u.last();if(r==c&&n==l)t.nodes.forEach(function(t,r){e.moveNodeByKey(t.key,o.key,i+r,{normalize:!1})}),e.removeNodeByKey(t.key,{normalize:!1});else if(n==l)t.nodes.skipUntil(function(e){return e==c}).forEach(function(t,r){e.moveNodeByKey(t.key,o.key,i+1+r,{normalize:!1})});else if(r==c)t.nodes.takeUntil(function(e){return e==l}).push(l).forEach(function(t,r){e.moveNodeByKey(t.key,o.key,i+r,{normalize:!1})});else{var f=c.getFirstText();e.splitDescendantsByKey(t.key,f.key,0,{normalize:!1}),a=e.value.document,u.forEach(function(t,r){if(0==r){var n=t;t=a.getNextBlock(t.key),e.removeNodeByKey(n.key,{normalize:!1})}e.moveNodeByKey(t.key,o.key,i+1+r,{normalize:!1})})}}),o&&e.normalizeDocument()},unwrapInlineAtRange:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};r=sn.createProperties(r);var o=e.getFlag("normalize",n),a=e.value.document;a.getTextsAtRange(t).map(function(e){return a.getClosest(e.key,function(e){return"inline"==e.object&&((null==r.type||e.type==r.type)&&((null==r.isVoid||e.isVoid==r.isVoid)&&!(null!=r.data&&!e.data.isSuperset(r.data))))})}).filter(function(e){return e}).toOrderedSet().toList().forEach(function(t){var r=e.value.document.getParent(t.key),n=r.nodes.indexOf(t);t.nodes.forEach(function(t,o){e.moveNodeByKey(t.key,r.key,n+o,{normalize:!1})})}),o&&e.normalizeDocument()},wrapBlockAtRange:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};r=(r=b.create(r)).set("nodes",r.nodes.clear());var o=e.getFlag("normalize",n),a=e.value.document,s=a.getBlocksAtRange(t),i=s.first(),u=s.last(),c=void 0,l=void 0,f=void 0;if(1===s.length?(c=a.getParent(i.key),l=s):c=a.getClosest(i.key,function(e){return!!a.getClosest(u.key,function(t){return e==t})}),null==c&&(c=a),null==l){var d=c.nodes.reduce(function(e,t,r){return(t==i||t.hasDescendant(i.key))&&(e[0]=r),(t==u||t.hasDescendant(u.key))&&(e[1]=r),e},[]);f=d[0],l=c.nodes.slice(d[0],d[1]+1)}null==f&&(f=c.nodes.indexOf(l.first())),e.insertNodeByKey(c.key,f,r,{normalize:!1}),l.forEach(function(t,n){e.moveNodeByKey(t.key,r.key,n,{normalize:!1})}),o&&e.normalizeNodeByKey(c.key)},wrapInlineAtRange:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=e.value.document,s=e.getFlag("normalize",o),i=t.start,u=t.end;if(t.isCollapsed){var c=a.getClosestInline(i.key);if(!c.isVoid)return;return e.wrapInlineByKey(c.key,n,o)}n=(n=Fr.create(n)).set("nodes",n.nodes.clear());var l=a.getBlocksAtRange(t),f=a.getClosestBlock(i.key),d=a.getClosestBlock(u.key),v=a.getClosestInline(i.key),h=a.getClosestInline(u.key),y=f.getFurthestAncestor(i.key),p=d.getFurthestAncestor(u.key);v&&v==h||(e.splitDescendantsByKey(p.key,u.key,u.offset,{normalize:!1}),e.splitDescendantsByKey(y.key,i.key,i.offset,{normalize:!1})),f=(a=e.value.document).getDescendant(f.key),d=a.getDescendant(d.key),y=f.getFurthestAncestor(i.key),p=d.getFurthestAncestor(u.key);var m=f.nodes.indexOf(y),k=d.nodes.indexOf(p);if(v&&v==h){var g=f.getTextsAtRange(t).get(0).splitText(i.offset)[1].splitText(u.offset-i.offset)[0];n=n.set("nodes",r.List([g])),Sn.insertInlineAtRange(e,t,n,{normalize:!1});var T=n.getFirstText().key,O={anchor:{key:T,offset:0},focus:{key:T,offset:u.offset-i.offset},isFocused:!0};e.select(O)}else if(f==d){y=(f=(a=e.value.document).getClosestBlock(i.key)).getFurthestAncestor(i.key);var A=a.getNextSibling(y.key),b=f.nodes.indexOf(A),N=i.key==u.key?A:f.getFurthestAncestor(u.key),x=f.nodes.skipUntil(function(e){return e==A}).takeUntil(function(e){return e==N}).push(N),S=n.regenerateKey();e.insertNodeByKey(f.key,b,S,{normalize:!1}),x.forEach(function(t,r){e.moveNodeByKey(t.key,S.key,r,{normalize:!1})}),s&&e.normalizeNodeByKey(f.key)}else{var E=f.nodes.slice(m+1),w=d.nodes.slice(0,k+1),F=n.regenerateKey(),B=n.regenerateKey();e.insertNodeByKey(f.key,m+1,F,{normalize:!1}),e.insertNodeByKey(d.key,k,B,{normalize:!1}),E.forEach(function(t,r){e.moveNodeByKey(t.key,F.key,r,{normalize:!1})}),w.forEach(function(t,r){e.moveNodeByKey(t.key,B.key,r,{normalize:!1})}),s&&e.normalizeNodeByKey(f.key).normalizeNodeByKey(d.key),l.slice(1,-1).forEach(function(t){var r=n.regenerateKey();e.insertNodeByKey(t.key,0,r,{normalize:!1}),t.nodes.forEach(function(t,n){e.moveNodeByKey(t.key,r.key,n,{normalize:!1})}),s&&e.normalizeNodeByKey(t.key)})}},wrapTextAtRange:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=e.getFlag("normalize",o),s=t.start,i=t.end,u=t.moveToStart(),c=t.moveToEnd();s.key==i.key&&(c=c.moveForward(r.length)),e.insertTextAtRange(u,r,[],{normalize:a}),e.insertTextAtRange(c,n,[],{normalize:a})}},En={addMarkByPath:function(e,t,r,n,o,a){o=Mr.create(o);var s=e.value,i=[],u=r,c=r+n,l=0;s.document.assertNode(t).getLeaves().forEach(function(e){var r=l,n=r+e.text.length;if(l+=e.text.length,!(n<u||c<r||e.marks.has(o))){var a=Math.max(r,u),f=Math.min(n,c);i.push({type:"add_mark",value:s,path:t,offset:a,length:f-a,mark:o})}}),e.applyOperations(i),e.normalizeParentByPath(t,a)},insertFragmentByPath:function(e,t,r,n,o){n.nodes.forEach(function(n,o){e.insertNodeByPath(t,r+o,n)}),e.normalizeNodeByPath(t,o)},insertNodeByPath:function(e,t,r,n,o){var a=e.value;e.applyOperation({type:"insert_node",value:a,path:t.concat(r),node:n}),e.normalizeNodeByPath(t,o)},insertTextByPath:function(e,t,r,n,o,a){var s=e.value,i=s.document.assertNode(t);o=o||i.getMarksAtIndex(r),e.applyOperation({type:"insert_text",value:s,path:t,offset:r,text:n,marks:o}),e.normalizeParentByPath(t,a)},mergeNodeByPath:function(e,t,r){var n=e.value,o=n.document,a=o.getDescendant(t),s=o.getPreviousSibling(t);if(!s)throw new Error('Unable to merge node with path "'+t+'", because it has no previous sibling.');var i="text"==s.object?s.text.length:s.nodes.size;e.applyOperation({type:"merge_node",value:n,path:t,position:i,properties:{type:a.type,data:a.data},target:null}),e.normalizeParentByPath(t,r)},moveNodeByPath:function(e,t,r,n,o){var a=e.value;e.applyOperation({type:"move_node",value:a,path:t,newPath:r.concat(n)});var s=Zr.relate(t,r);e.normalizeNodeByPath(s,o)},removeMarkByPath:function(e,t,r,n,o,a){o=Mr.create(o);var s=e.value,i=[],u=r,c=r+n,l=0;s.document.assertNode(t).getLeaves().forEach(function(e){var r=l,n=r+e.text.length;if(l+=e.text.length,!(n<u||c<r)&&e.marks.has(o)){var a=Math.max(r,u),f=Math.min(n,c);i.push({type:"remove_mark",value:s,path:t,offset:a,length:f-a,mark:o})}}),e.applyOperations(i),e.normalizeParentByPath(t,a)},removeAllMarksByPath:function(e,t,r){var n=e.state.document.assertNode(t);("text"===n.object?[n]:n.getTextsAsArray()).forEach(function(t){t.getMarksAsArray().forEach(function(n){e.removeMarkByKey(t.key,0,t.text.length,n,r)})})},removeNodeByPath:function(e,t,r){var n=e.value,o=n.document.assertNode(t);e.applyOperation({type:"remove_node",value:n,path:t,node:o}),e.normalizeParentByPath(t,r)},removeTextByPath:function(e,t,r,n,o){var a=e.value,s=a.document,i=s.assertNode(t),u=i.getLeaves(),c=i.text,l=[],f=r,d=r+n,v=0;u.forEach(function(e){var r=v,n=r+e.text.length;if(v+=e.text.length,!(n<f||d<r)){var o=Math.max(r,f),s=Math.min(n,d),i=c.slice(o,s);l.push({type:"remove_text",value:a,path:t,offset:o,text:i,marks:e.marks})}}),e.applyOperations(l.reverse());var h=s.getClosestBlock(i.key);e.normalizeNodeByKey(h.key,o)},replaceNodeByPath:function(e,t,r,n){r=sn.create(r);var o=t.last(),a=Zr.lift(t);e.removeNodeByPath(t,{normalize:!1}),e.insertNodeByPath(a,o,r,{normalize:!1}),e.normalizeParentByPath(t,n)},replaceTextByPath:function(e,t,r,n,o,a,s){var i=e.value.document,u=i.assertNode(t);n+r>u.text.length&&(n=u.text.length-r);var c=i.createRange({anchor:{path:t,offset:r},focus:{path:t,offset:r+n}}),l=i.getActiveMarksAtRange(c);e.removeTextByPath(t,r,n,{normalize:!1}),a?l&&(l=l.filter(function(e){return!a.find(function(t){return e.type===t.type})}),a=l.merge(a)):a=l||[],e.insertTextByPath(t,r,o,a,s)},setMarkByPath:function(e,t,r,n,o,a,s){o=Mr.create(o),a=Mr.createProperties(a);var i=e.value;e.applyOperation({type:"set_mark",value:i,path:t,offset:r,length:n,mark:o,properties:a}),e.normalizeParentByPath(t,s)},setNodeByPath:function(e,t,r,n){r=sn.createProperties(r);var o=e.value,a=o.document.assertNode(t);e.applyOperation({type:"set_node",value:o,path:t,node:a,properties:r}),e.normalizeNodeByPath(t,n)},setTextByPath:function(e,t,r,n,o){var a=e.value.document.assertNode(t).text.length;e.replaceTextByPath(t,0,a,r,n,o)},splitNodeByPath:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=n.target,a=void 0===o?null:o,s=e.value,i=s.document.getDescendant(t);e.applyOperation({type:"split_node",value:s,path:t,position:r,properties:{type:i.type,data:i.data},target:a}),e.normalizeParentByPath(t,n)},splitDescendantsByPath:function(e,t,r,n,o){if(t.equals(r))e.splitNodeByPath(r,n,o);else{var a=e.value.document,s=a.assertNode(t),i=a.assertNode(r),u=void 0,c=void 0;a.getAncestors(r).skipUntil(function(e){return e.key==s.key}).reverse().unshift(i).forEach(function(t){var r=null==c?null:c;c=u?t.nodes.indexOf(u)+1:n,u=t,e.splitNodeByKey(t.key,c,{normalize:!1,target:r})}),e.normalizeParentByPath(t,o)}},unwrapInlineByPath:function(e,t,r,n){var o=e.value,a=o.document,s=o.selection,i=a.assertNode(t),u=i.getFirstText(),c=i.getLastText(),l=s.moveToRangeOfNode(u,c);e.unwrapInlineAtRange(l,r,n)},unwrapBlockByPath:function(e,t,r,n){var o=e.value,a=o.document,s=o.selection,i=a.assertNode(t),u=i.getFirstText(),c=i.getLastText(),l=s.moveToRangeOfNode(u,c);e.unwrapBlockAtRange(l,r,n)},unwrapNodeByPath:function(e,t,r){var n=e.value.document;n.assertNode(t);var o=Zr.lift(t),a=n.assertNode(o),s=t.last(),i=o.last(),u=Zr.lift(o),c=0===s,l=s===a.nodes.size-1;if(1===a.nodes.size)e.moveNodeByPath(t,u,i+1,{normalize:!1}),e.removeNodeByPath(o,r);else if(c)e.moveNodeByPath(t,u,i,r);else if(l)e.moveNodeByPath(t,u,i+1,r);else{e.splitNodeByPath(o,s,{normalize:!1});var f=Zr.increment(t,1,o.size-1);f=f.set(f.size-1,0),e.moveNodeByPath(f,u,i+1,{normalize:!1}),e.normalizeNodeByPath(u,r)}},wrapBlockByPath:function(e,t,r,n){r=(r=b.create(r)).set("nodes",r.nodes.clear());var o=Zr.lift(t),a=t.last(),s=Zr.increment(t);e.insertNodeByPath(o,a,r,{normalize:!1}),e.moveNodeByPath(s,t,0,n)},wrapInlineByPath:function(e,t,r,n){r=(r=Fr.create(r)).set("nodes",r.nodes.clear());var o=Zr.lift(t),a=t.last(),s=Zr.increment(t);e.insertNodeByPath(o,a,r,{normalize:!1}),e.moveNodeByPath(s,t,0,n)},wrapNodeByPath:function(e,t,r){"block"!=(r=sn.create(r)).object?"inline"!=r.object||e.wrapInlineByPath(t,r):e.wrapBlockByPath(t,r)}},wn=function(e){En[e+"ByKey"]=function(t,r){for(var n=arguments.length,o=Array(n>2?n-2:0),a=2;a<n;a++)o[a-2]=arguments[a];var s=t.value.document.assertPath(r);t[e+"ByPath"].apply(t,[s].concat(o))}},Fn=!0,Bn=!1,_n=void 0;try{for(var Pn,jn=["addMark","insertFragment","insertNode","insertText","mergeNode","removeMark","removeAllMarks","removeNode","setText","replaceText","removeText","replaceNode","setMark","setNode","splitNode","unwrapInline","unwrapBlock","unwrapNode","wrapBlock","wrapInline","wrapNode"][Symbol.iterator]();!(Fn=(Pn=jn.next()).done);Fn=!0){wn(Pn.value)}}catch(e){Bn=!0,_n=e}finally{try{!Fn&&jn.return&&jn.return()}finally{if(Bn)throw _n}}En.moveNodeByKey=function(e,t,r){for(var n=arguments.length,o=Array(n>3?n-3:0),a=3;a<n;a++)o[a-3]=arguments[a];var s=e.value.document,i=s.assertPath(t),u=s.assertPath(r);e.moveNodeByPath.apply(e,[i,u].concat(o))},En.splitDescendantsByKey=function(e,t,r){for(var n=arguments.length,o=Array(n>3?n-3:0),a=3;a<n;a++)o[a-3]=arguments[a];var s=e.value.document,i=s.assertPath(t),u=s.assertPath(r);e.splitDescendantsByPath.apply(e,[i,u].concat(o))};var Cn=function(){this.__data__=new pt,this.size=0};var Rn=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r};var zn=function(e){return this.__data__.get(e)};var In=function(e){return this.__data__.has(e)},Ln=200;var Dn=function(e,t){var r=this.__data__;if(r instanceof pt){var n=r.__data__;if(!mt||n.length<Ln-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new St(n)}return r.set(e,t),this.size=r.size,this};function Mn(e){var t=this.__data__=new pt(e);this.size=t.size}Mn.prototype.clear=Cn,Mn.prototype.delete=Rn,Mn.prototype.get=zn,Mn.prototype.has=In,Mn.prototype.set=Dn;var Kn=Mn,Jn="__lodash_hash_undefined__";var Vn=function(e){return this.__data__.set(e,Jn),this};var Un=function(e){return this.__data__.has(e)};function Hn(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new St;++t<r;)this.add(e[t])}Hn.prototype.add=Hn.prototype.push=Vn,Hn.prototype.has=Un;var Wn=Hn;var Gn=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1};var $n=function(e,t){return e.has(t)},qn=1,Yn=2;var Xn=function(e,t,r,n,o,a){var s=r&qn,i=e.length,u=t.length;if(i!=u&&!(s&&u>i))return!1;var c=a.get(e);if(c&&a.get(t))return c==t;var l=-1,f=!0,d=r&Yn?new Wn:void 0;for(a.set(e,t),a.set(t,e);++l<i;){var v=e[l],h=t[l];if(n)var y=s?n(h,v,l,t,e,a):n(v,h,l,e,t,a);if(void 0!==y){if(y)continue;f=!1;break}if(d){if(!Gn(t,function(e,t){if(!$n(d,t)&&(v===e||o(v,e,r,n,a)))return d.push(t)})){f=!1;break}}else if(v!==h&&!o(v,h,r,n,a)){f=!1;break}}return a.delete(e),a.delete(t),f},Zn=ce.Uint8Array;var Qn=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r};var eo=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r},to=1,ro=2,no="[object Boolean]",oo="[object Date]",ao="[object Error]",so="[object Map]",io="[object Number]",uo="[object RegExp]",co="[object Set]",lo="[object String]",fo="[object Symbol]",vo="[object ArrayBuffer]",ho="[object DataView]",yo=le?le.prototype:void 0,po=yo?yo.valueOf:void 0;var mo=function(e,t,r,n,o,a,s){switch(r){case ho:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case vo:return!(e.byteLength!=t.byteLength||!a(new Zn(e),new Zn(t)));case no:case oo:case io:return ut(+e,+t);case ao:return e.name==t.name&&e.message==t.message;case uo:case lo:return e==t+"";case so:var i=Qn;case co:var u=n&to;if(i||(i=eo),e.size!=t.size&&!u)return!1;var c=s.get(e);if(c)return c==t;n|=ro,s.set(e,t);var l=Xn(i(e),i(t),n,o,a,s);return s.delete(e),l;case fo:if(po)return po.call(e)==po.call(t)}return!1};var ko=function(e,t,r){var n=t(e);return se(e)?n:dr(n,r(e))};var go=function(e,t){for(var r=-1,n=null==e?0:e.length,o=0,a=[];++r<n;){var s=e[r];t(s,r,e)&&(a[o++]=s)}return a};var To=function(){return[]},Oo=Object.prototype.propertyIsEnumerable,Ao=Object.getOwnPropertySymbols,bo=Ao?function(e){return null==e?[]:(e=Object(e),go(Ao(e),function(t){return Oo.call(e,t)}))}:To;var No=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n};var xo=function(){return!1},So=Y(function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,o=n&&n.exports===r?ce.Buffer:void 0,a=(o?o.isBuffer:void 0)||xo;e.exports=a}),Eo={};Eo["[object Float32Array]"]=Eo["[object Float64Array]"]=Eo["[object Int8Array]"]=Eo["[object Int16Array]"]=Eo["[object Int32Array]"]=Eo["[object Uint8Array]"]=Eo["[object Uint8ClampedArray]"]=Eo["[object Uint16Array]"]=Eo["[object Uint32Array]"]=!0,Eo["[object Arguments]"]=Eo["[object Array]"]=Eo["[object ArrayBuffer]"]=Eo["[object Boolean]"]=Eo["[object DataView]"]=Eo["[object Date]"]=Eo["[object Error]"]=Eo["[object Function]"]=Eo["[object Map]"]=Eo["[object Number]"]=Eo["[object Object]"]=Eo["[object RegExp]"]=Eo["[object Set]"]=Eo["[object String]"]=Eo["[object WeakMap]"]=!1;var wo=function(e){return Ae(e)&&ur(e.length)&&!!Eo[Oe(e)]};var Fo=function(e){return function(t){return e(t)}},Bo=Y(function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,o=n&&n.exports===r&&ie.process,a=function(){try{return o&&o.binding&&o.binding("util")}catch(e){}}();e.exports=a}),_o=Bo&&Bo.isTypedArray,Po=_o?Fo(_o):wo,jo=Object.prototype.hasOwnProperty;var Co=function(e,t){var r=se(e),n=!r&&sr(e),o=!r&&!n&&So(e),a=!r&&!n&&!o&&Po(e),s=r||n||o||a,i=s?No(e.length,String):[],u=i.length;for(var c in e)!t&&!jo.call(e,c)||s&&("length"==c||o&&("offset"==c||"parent"==c)||a&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Xt(c,u))||i.push(c);return i},Ro=Object.prototype;var zo=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Ro)};var Io=function(e,t){return function(r){return e(t(r))}},Lo=Io(Object.keys,Object),Do=Object.prototype.hasOwnProperty;var Mo=function(e){if(!zo(e))return Lo(e);var t=[];for(var r in Object(e))Do.call(e,r)&&"constructor"!=r&&t.push(r);return t};var Ko=function(e){return null!=e&&ur(e.length)&&!Ce(e)};var Jo=function(e){return Ko(e)?Co(e):Mo(e)};var Vo=function(e){return ko(e,Jo,bo)},Uo=1,Ho=Object.prototype.hasOwnProperty;var Wo=function(e,t,r,n,o,a){var s=r&Uo,i=Vo(e),u=i.length;if(u!=Vo(t).length&&!s)return!1;for(var c=u;c--;){var l=i[c];if(!(s?l in t:Ho.call(t,l)))return!1}var f=a.get(e);if(f&&a.get(t))return f==t;var d=!0;a.set(e,t),a.set(t,e);for(var v=s;++c<u;){var h=e[l=i[c]],y=t[l];if(n)var p=s?n(y,h,l,t,e,a):n(h,y,l,e,t,a);if(!(void 0===p?h===y||o(h,y,r,n,a):p)){d=!1;break}v||(v="constructor"==l)}if(d&&!v){var m=e.constructor,k=t.constructor;m!=k&&"constructor"in e&&"constructor"in t&&!("function"==typeof m&&m instanceof m&&"function"==typeof k&&k instanceof k)&&(d=!1)}return a.delete(e),a.delete(t),d},Go=$e(ce,"DataView"),$o=$e(ce,"Promise"),qo=$e(ce,"Set"),Yo=$e(ce,"WeakMap"),Xo=De(Go),Zo=De(mt),Qo=De($o),ea=De(qo),ta=De(Yo),ra=Oe;(Go&&"[object DataView]"!=ra(new Go(new ArrayBuffer(1)))||mt&&"[object Map]"!=ra(new mt)||$o&&"[object Promise]"!=ra($o.resolve())||qo&&"[object Set]"!=ra(new qo)||Yo&&"[object WeakMap]"!=ra(new Yo))&&(ra=function(e){var t=Oe(e),r="[object Object]"==t?e.constructor:void 0,n=r?De(r):"";if(n)switch(n){case Xo:return"[object DataView]";case Zo:return"[object Map]";case Qo:return"[object Promise]";case ea:return"[object Set]";case ta:return"[object WeakMap]"}return t});var na=ra,oa=1,aa="[object Arguments]",sa="[object Array]",ia="[object Object]",ua=Object.prototype.hasOwnProperty;var ca=function(e,t,r,n,o,a){var s=se(e),i=se(t),u=s?sa:na(e),c=i?sa:na(t),l=(u=u==aa?ia:u)==ia,f=(c=c==aa?ia:c)==ia,d=u==c;if(d&&So(e)){if(!So(t))return!1;s=!0,l=!1}if(d&&!l)return a||(a=new Kn),s||Po(e)?Xn(e,t,r,n,o,a):mo(e,t,u,r,n,o,a);if(!(r&oa)){var v=l&&ua.call(e,"__wrapped__"),h=f&&ua.call(t,"__wrapped__");if(v||h){var y=v?e.value():e,p=h?t.value():t;return a||(a=new Kn),o(y,p,r,n,a)}}return!!d&&(a||(a=new Kn),Wo(e,t,r,n,o,a))};var la=function e(t,r,n,o,a){return t===r||(null==t||null==r||!Ae(t)&&!Ae(r)?t!=t&&r!=r:ca(t,r,n,o,e,a))};var fa=function(e,t){return la(e,t)},da=ae("slate:history"),va={redos:new r.Stack,undos:new r.Stack},ha=function(e){function n(){return h(this,n),g(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return k(n,e),y(n,[{key:"save",value:function(e){var t,n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=this,s=a,i=s.undos,u=s.redos,c=o.merge,l=o.skip,f=i.peek(),d=f&&f.last();if(l)return a;if(null==c&&(t=e,c=!!(n=d)&&("set_selection"==t.type&&"set_selection"==n.type||"insert_text"==t.type&&"insert_text"==n.type&&t.offset==n.offset+n.text.length&&fa(t.path,n.path)||"remove_text"==t.type&&"remove_text"==n.type&&t.offset+t.text.length==n.offset&&fa(t.path,n.path))),da("save",{operation:e,merge:c}),c&&f){var v=f.push(e);i=(i=i.pop()).push(v)}else{var h=new r.List([e]);i=i.push(h)}return i.size>100&&(i=i.take(100)),u=u.clear(),a=a.set("undos",i).set("redos",u)}},{key:"toJSON",value:function(){return{object:this.object,redos:this.redos.toJSON(),undos:this.undos.toJSON()}}},{key:"toJS",value:function(){return this.toJSON()}},{key:"object",get:function(){return"history"}},{key:"kind",get:function(){return t.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),this.object}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n.isHistory(e))return e;if(s(e))return n.fromJSON(e);throw new Error("`History.create` only accepts objects or histories, but you passed it: "+e)}},{key:"createOperationsList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(r.List.isList(e))return e;if(Array.isArray(e))return new r.List(e);throw new Error("`History.createList` only accepts arrays or lists, but you passed it: "+e)}},{key:"fromJSON",value:function(e){var t=e.redos,o=void 0===t?[]:t,a=e.undos,s=void 0===a?[]:a;return new n({redos:new r.Stack(o.map(this.createOperationsList)),undos:new r.Stack(s.map(this.createOperationsList))})}}]),n}(r.Record(va));ha.fromJS=ha.fromJSON,ha.isHistory=u.bind(null,"HISTORY"),ha.prototype[i.HISTORY]=!0;var ya=function(e){function r(){return h(this,r),g(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return k(r,e),y(r,[{key:"getPluginsWith",value:function(e){return this.plugins.filter(function(t){return null!=t[e]})}},{key:"find",value:function(e){for(var t=this.getPluginsWith(e),r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];var a=!0,s=!1,i=void 0;try{for(var u,c=t[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value,f=l[e].apply(l,n);if(null!=f)return f}}catch(e){s=!0,i=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw i}}}},{key:"map",value:function(e){for(var t=this.getPluginsWith(e),r=[],n=arguments.length,o=Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];var s=!0,i=!1,u=void 0;try{for(var c,l=t[Symbol.iterator]();!(s=(c=l.next()).done);s=!0){var f=c.value,d=f[e].apply(f,o);null!=d&&r.push(d)}}catch(e){i=!0,u=e}finally{try{!s&&l.return&&l.return()}finally{if(i)throw u}}return r}},{key:"run",value:function(e){for(var t=this.getPluginsWith(e),r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];var a=!0,s=!1,i=void 0;try{for(var u,c=t[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;if(null!=l[e].apply(l,n))return}}catch(e){s=!0,i=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw i}}}},{key:"render",value:function(e,t){for(var r=arguments.length,n=Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];return this.getPluginsWith(e).reduceRight(function(r,o){if(!o[e])return r;var a=o[e].apply(o,[t].concat(n));return null==a?r:(t.children=a,a)},void 0===t.children?null:t.children)}},{key:"object",get:function(){return"stack"}},{key:"kind",get:function(){return t.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),this.object}}],[{key:"create",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).plugins;return new r({plugins:void 0===e?[]:e})}},{key:"isStack",value:function(e){return!(!e||!e[i.STACK])}}]),r}(r.Record({plugins:[]}));ya.prototype[i.STACK]=!0,zr(ya.prototype,["getPluginsWith"]);var pa=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};h(this,t);var n=g(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));for(var o in n.code=e,r)n[o]=r[o];return Error.captureStackTrace?Error.captureStackTrace(n,n.constructor):n.stack=(new Error).stack,n}return k(t,e),t}(Error),ma=ae("slate:schema"),ka=[{match:{object:"document"},nodes:[{match:{object:"block"}}]},{match:{object:"block",first:{object:"block"}},nodes:[{match:{object:"block"}}]},{match:{object:"block",first:[{object:"inline"},{object:"text"}]},nodes:[{match:[{object:"inline"},{object:"text"}]}]},{match:{object:"inline"},nodes:[{match:[{object:"inline"},{object:"text"}]}]},{match:[{object:"block"},{object:"inline"}],nodes:[{min:1}],normalize:function(e,t){var r=t.code,n=t.node;"child_required"===r&&e.insertNodeByKey(n.key,0,an.create(),{normalize:!1})}},{match:{object:"inline",isVoid:!1,nodes:[{match:{object:"text"}}]},text:/[\w\W]+/},{match:{object:"block"},first:[{object:"block"},{object:"text"}],last:[{object:"block"},{object:"text"}],normalize:function(e,t){var r=t.code,n=t.node,o=an.create(),a=void 0;if("first_child_object_invalid"===r)a=0;else{if("last_child_object_invalid"!==r)return;a=n.nodes.size}e.insertNodeByKey(n.key,a,o,{normalize:!1})}},{match:{object:"inline"},first:[{object:"block"},{object:"text"}],last:[{object:"block"},{object:"text"}],previous:[{object:"block"},{object:"text"}],next:[{object:"block"},{object:"text"}],normalize:function(e,t){var r=t.code,n=t.node,o=t.index,a=an.create(),s=void 0;if("first_child_object_invalid"===r)s=0;else if("last_child_object_invalid"===r)s=n.nodes.size;else if("previous_sibling_object_invalid"===r)s=o;else{if("next_sibling_object_invalid"!==r)return;s=o+1}e.insertNodeByKey(n.key,s,a,{normalize:!1})}},{match:{object:"text"},next:[{object:"block"},{object:"inline"}],normalize:function(e,t){var r=t.code,n=t.next;"next_sibling_object_invalid"===r&&e.mergeNodeByKey(n.key,{normalize:!1})}}],ga={stack:ya.create(),rules:[]},Ta=function(e){function r(){return h(this,r),g(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return k(r,e),y(r,[{key:"validateNode",value:function(e){var t=this.rules.filter(function(t){return Oa(e,t.match)}),r=Aa(e,t,this.rules,{every:!0});if(r)return new pa(r.code,r)}},{key:"testNode",value:function(e){return!this.validateNode(e)}},{key:"assertNode",value:function(e){var t=this.validateNode(e);if(t)throw t}},{key:"normalizeNode",value:function(e){var t=this.stack.find("normalizeNode",e);if(t)return t;if("text"!=e.object){var r=this.validateNode(e);if(r)return function(e){ma("normalizing",{error:r});var t=r.rule,o=e.operations.size;t.normalize&&t.normalize(e,r),e.operations.size===o&&function(e,t){var r=t.code,o=t.node,a=t.child,s=t.key,i=t.mark;switch(r){case n.CHILD_OBJECT_INVALID:case n.CHILD_TYPE_INVALID:case n.CHILD_UNKNOWN:case n.FIRST_CHILD_OBJECT_INVALID:case n.FIRST_CHILD_TYPE_INVALID:case n.LAST_CHILD_OBJECT_INVALID:case n.LAST_CHILD_TYPE_INVALID:return"text"===a.object&&"block"===o.object&&1===o.nodes.size?e.removeNodeByKey(o.key,{normalize:!1}):e.removeNodeByKey(a.key,{normalize:!1});case n.CHILD_REQUIRED:case n.NODE_TEXT_INVALID:case n.PARENT_OBJECT_INVALID:case n.PARENT_TYPE_INVALID:return"document"===o.object?o.nodes.forEach(function(t){return e.removeNodeByKey(t.key,{normalize:!1})}):e.removeNodeByKey(o.key,{normalize:!1});case n.NODE_DATA_INVALID:return void 0===o.data.get(s)&&"document"!==o.object?e.removeNodeByKey(o.key,{normalize:!1}):e.setNodeByKey(o.key,{data:o.data.delete(s)},{normalize:!1});case n.NODE_IS_VOID_INVALID:return e.setNodeByKey(o.key,{isVoid:!o.isVoid},{normalize:!1});case n.NODE_MARK_INVALID:return o.getTexts().forEach(function(t){return e.removeMarkByKey(t.key,0,t.text.length,i,{normalize:!1})});default:e.removeNodeByKey(o.key,{normalize:!1})}}(e,r)}}}},{key:"toJSON",value:function(){return{object:this.object,rules:this.rules}}},{key:"toJS",value:function(){return this.toJSON()}},{key:"object",get:function(){return"schema"}},{key:"kind",get:function(){return t.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),this.object}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isSchema(e))return e;if(s(e))return r.fromJSON(e);throw new Error("`Schema.create` only accepts objects or schemas, but you passed it: "+e)}},{key:"fromJSON",value:function(e){if(r.isSchema(e))return e;var t=e.plugins?e.plugins:[{schema:e}],n=[].concat(ka),o=!0,a=!1,s=void 0;try{for(var i,u=t[Symbol.iterator]();!(o=(i=u.next()).done);o=!0){var c=i.value.schema,l=void 0===c?{}:c,f=l.blocks,d=void 0===f?{}:f,v=l.inlines,h=void 0===v?{}:v;for(var y in l.rules&&(n=n.concat(l.rules)),l.document&&n.push(m({match:[{object:"document"}]},l.document)),d)n.push(m({match:[{object:"block",type:y}]},d[y]));for(var p in h)n.push(m({match:[{object:"inline",type:p}]},h[p]))}}catch(e){a=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw s}}return new r({stack:ya.create({plugins:t}),rules:n})}},{key:"isSchema",value:function(e){return!(!e||!e[i.SCHEMA])}}]),r}(r.Record(ga));function Oa(e,t){return!Aa(e,t)}function Aa(e,r,o){var a=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).every,s=void 0!==a&&a;if(Array.isArray(r)){var i=r.length?r:[{}],u=void 0,c=!0,l=!1,f=void 0;try{for(var d,h=i[Symbol.iterator]();!(c=(d=h.next()).done);c=!0){var y=Aa(e,d.value,o);if(u=u||y,s&&y)return y;if(!s&&!y)return}}catch(e){l=!0,f=e}finally{try{!c&&h.return&&h.return()}finally{if(l)throw f}}return u}return function(e,r){r.objects&&t.warn("The `objects` schema validation rule was changed. Please use the new `match` syntax with `object`.");if(null==r.object)return;if(r.object===e.object)return;return Sa(n.NODE_OBJECT_INVALID,{rule:r,node:e})}(e,r)||function(e,r){r.types&&t.warn("The `types` schema validation rule was changed. Please use the new `match` syntax with `type`.");if(null==r.type)return;if(r.type===e.type)return;return Sa(n.NODE_TYPE_INVALID,{rule:r,node:e})}(e,r)||function(e,t){if(null==t.isVoid)return;if(t.isVoid===e.isVoid)return;return Sa(n.NODE_IS_VOID_INVALID,{rule:t,node:e})}(e,r)||function(e,t){if(null==t.data)return;if(null==e.data)return;for(var r in t.data){var o=t.data[r],a=e.data&&e.data.get(r),s="function"==typeof o?o(a):o===a;if(!s)return Sa(n.NODE_DATA_INVALID,{rule:t,node:e,key:r,value:a})}}(e,r)||function(e,t){if(null==t.marks)return;var r=e.getMarks().toArray(),o=function(r){var o=t.marks.some(function(e){return e.type===r.type});return o?"continue":{v:Sa(n.NODE_MARK_INVALID,{rule:t,node:e,mark:r})}},a=!0,s=!1,i=void 0;try{for(var u,c=r[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value,f=o(l);switch(f){case"continue":continue;default:if("object"===(void 0===f?"undefined":v(f)))return f.v}}}catch(e){s=!0,i=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw i}}}(e,r)||function(e,t){if(null==t.text)return;var r=e.text;if("function"==typeof t.text?t.text(r):t.text.test(r))return;return Sa(n.NODE_TEXT_INVALID,{rule:t,node:e,text:r})}(e,r)||function(e,t){if(null==t.first)return;var r=e.nodes.first();if(!r)return;var n=Aa(r,t.first);if(!n)return;return n.rule=t,n.node=e,n.child=r,n.code=n.code.replace("node_","first_child_"),n}(e,r)||function(e,t){if(null==t.last)return;var r=e.nodes.last();if(!r)return;var n=Aa(r,t.last);if(!n)return;return n.rule=t,n.node=e,n.child=r,n.code=n.code.replace("node_","last_child_"),n}(e,r)||function(e,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(null==e.nodes)return;var a=e.nodes.toArray(),s=null!=r.nodes?r.nodes.slice():[],i=void 0,u=void 0,c=void 0,l=void 0,f=void 0,d=void 0,v=void 0,h=void 0;function y(){return i=null==i?null:0,l=s.shift(),u=l&&l.min,f=l&&l.max,!!l}function p(){return c=null==c?0:c+1,i=null==i?0:i+1,v=d,d=a[c],h=a[c+1],null!=f&&i==f&&y(),!!d}function m(){i-=1,c-=1}null!=r.nodes&&y();for(;p();){var k=ba(e,d,o)||Na(e,d,v,c,o)||xa(e,d,h,c,o);if(k)return k;if(null!=r.nodes){if(!l)return Sa(n.CHILD_UNKNOWN,{rule:r,node:e,child:d,index:c});if(l&&(l.objects&&t.warn("The `objects` schema validation rule was changed. Please use the new `match` syntax with `object`."),l.types&&t.warn("The `types` schema validation rule was changed. Please use the new `match` syntax with `type`.")),l.match){var g=Aa(d,l.match);if(g&&i>=u&&y()){m();continue}if(g)return g.rule=r,g.node=e,g.child=d,g.index=c,g.code=g.code.replace("node_","child_"),g}}}if(null!=r.nodes)for(;null!=u;){if(i<u)return Sa(n.CHILD_REQUIRED,{rule:r,node:e,index:c});y()}}(e,r,o)}function ba(e,t,r){var n=!0,o=!1,a=void 0;try{for(var s,i=r[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){var u=s.value;if(null!=u.parent&&Oa(t,u.match)){var c=Aa(e,u.parent);if(c)return c.rule=u,c.parent=e,c.node=t,c.code=c.code.replace("node_","parent_"),c}}}catch(e){o=!0,a=e}finally{try{!n&&i.return&&i.return()}finally{if(o)throw a}}}function Na(e,t,r,n,o){if(r){var a=!0,s=!1,i=void 0;try{for(var u,c=o[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;if(null!=l.previous&&Oa(t,l.match)){var f=Aa(r,l.previous);if(f)return f.rule=l,f.node=e,f.child=t,f.index=n,f.previous=r,f.code=f.code.replace("node_","previous_sibling_"),f}}}catch(e){s=!0,i=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw i}}}}function xa(e,t,r,n,o){if(r){var a=!0,s=!1,i=void 0;try{for(var u,c=o[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;if(null!=l.next&&Oa(t,l.match)){var f=Aa(r,l.next);if(f)return f.rule=l,f.node=e,f.child=t,f.index=n,f.next=r,f.code=f.code.replace("node_","next_sibling_"),f}}}catch(e){s=!0,i=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw i}}}}function Sa(e,t){return m({code:e},t)}Ta.fromJS=Ta.fromJSON,Ta.prototype[i.SCHEMA]=!0;var Ea={data:new r.Map,decorations:null,document:Wr.create(),history:ha.create(),schema:Ta.create(),selection:tn.create()},wa=function(e){function n(){return h(this,n),g(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return k(n,e),y(n,[{key:"change",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Oi(m({},e,{value:this}))}},{key:"addMark",value:function(e,t,r,n){var o=this,a=o.document;return a=a.addMark(e,t,r,n),o=this.set("document",a)}},{key:"insertNode",value:function(e,t){var r=this,n=r.document;return n=n.insertNode(e,t),r=(r=r.set("document",n)).mapRanges(function(e){return e.updatePoints(function(e){return e.setPath(null)})})}},{key:"insertText",value:function(e,t,r,n){var o=this,a=o.document;a=a.insertText(e,t,r,n),o=o.set("document",a);var s=a.assertNode(e);return o=(o=o.mapRanges(function(e){var n=e,o=n.anchor,a=n.focus,i=n.isBackward,u=n.isAtomic;return o.key!==s.key||!(o.offset>t)&&(o.offset!==t||u&&i)||(e=e.moveAnchorForward(r.length)),a.key===s.key&&(a.offset>t||a.offset==t&&(!u||i))&&(e=e.moveFocusForward(r.length)),e})).clearAtomicRanges(s.key,t)}},{key:"mergeNode",value:function(e){var t=this,r=t.document,n=r.mergeNode(e);e=r.resolvePath(e);var o=Zr.decrement(e),a=r.getNode(o),s=r.getNode(e);return t=(t=t.set("document",n)).mapRanges(function(e){if("text"===s.object){var t=a.text.length;e.anchor.key===s.key&&(e=e.moveAnchorTo(a.key,t+e.anchor.offset)),e.focus.key===s.key&&(e=e.moveFocusTo(a.key,t+e.focus.offset))}return e=e.updatePoints(function(e){return e.setPath(null)})})}},{key:"moveNode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=this,o=n.document;return o=o.moveNode(e,t,r),n=(n=n.set("document",o)).mapRanges(function(e){return e.updatePoints(function(e){return e.setPath(null)})})}},{key:"removeMark",value:function(e,t,r,n){var o=this,a=o.document;return a=a.removeMark(e,t,r,n),o=this.set("document",a)}},{key:"removeNode",value:function(e){var t=this,r=t.document,n=r.assertNode(e),o="text"==n.object?n:n.getFirstText()||n,a="text"==n.object?n:n.getLastText()||n,s=r.getPreviousText(o.key),i=r.getNextText(a.key);return r=r.removeNode(e),t=(t=t.set("document",r)).mapRanges(function(e){var t=e,r=t.start,o=t.end;return n.hasNode(r.key)&&(e=s?e.moveStartTo(s.key,s.text.length):i?e.moveStartTo(i.key,0):tn.create()),n.hasNode(o.key)&&(e=s?e.moveEndTo(s.key,s.text.length):i?e.moveEndTo(i.key,0):tn.create()),e=e.updatePoints(function(e){return e.setPath(null)})})}},{key:"removeText",value:function(e,t,r){var n=this,o=n.document;o=o.removeText(e,t,r),n=n.set("document",o);var a=o.assertNode(e),s=r.length,i=t+s;return n=(n=n.clearAtomicRanges(a.key,t,t+s)).mapRanges(function(e){var r=e,n=r.anchor,o=r.focus;return n.key===a.key&&(e=n.offset>=i?e.moveAnchorBackward(s):n.offset>t?e.moveAnchorTo(n.key,t):e),o.key===a.key&&(e=o.offset>=i?e.moveFocusBackward(s):o.offset>t?e.moveFocusTo(o.key,t):e),e})}},{key:"setNode",value:function(e,t){var r=this,n=r.document;return n=n.setNode(e,t),r=r.set("document",n)}},{key:"setMark",value:function(e,t,r,n,o){var a=this,s=a.document;return s=s.setMark(e,t,r,n,o),a=a.set("document",s)}},{key:"setSelection",value:function(e){var t=this,r=t,n=r.document,o=r.selection,a=o.setProperties(e);return o=n.resolveRange(a),t=t.set("selection",o)}},{key:"splitNode",value:function(e,t,r){var n=this,o=n.document,a=o.splitNode(e,t,r),s=o.assertNode(e);return n=(n=n.set("document",a)).mapRanges(function(e){var r=a.getNextText(s.key),n=e,o=n.start,i=n.end;return s.key===o.key&&t<=o.offset&&(e=e.moveStartTo(r.key,o.offset-t)),s.key===i.key&&t<=i.offset&&(e=e.moveEndTo(r.key,i.offset-t)),e=e.updatePoints(function(e){return e.setPath(null)})})}},{key:"mapRanges",value:function(e){var t=this,r=t,n=r.document,o=r.selection,a=r.decorations;if(o){var s=o.isSet?e(o):o;s||(s=tn.create()),s!==o&&(s=n.createRange(s)),t=t.set("selection",s)}if(a){var i=a.map(function(t){var r=t.isSet?e(t):t;return r&&r!==t&&(r=n.createRange(r)),r});i=(i=i.filter(function(e){return!!e})).size?i:null,t=t.set("decorations",i)}return t}},{key:"clearAtomicRanges",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.mapRanges(function(n){var o=n.isAtomic,a=n.start,s=n.end;return o?a.key!==e?n:a.offset<t&&(s.key!==e||s.offset>t)?null:null!=r&&a.offset<r&&(s.key!==e||s.offset>r)?null:n:n})}},{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={object:this.object,document:this.document.toJSON(e)};return e.preserveData&&(t.data=this.data.toJSON(e)),e.preserveDecorations&&(t.decorations=this.decorations?this.decorations.toArray().map(function(t){return t.toJSON(e)}):null),e.preserveHistory&&(t.history=this.history.toJSON(e)),e.preserveSelection&&(t.selection=this.selection.toJSON(e)),e.preserveSchema&&(t.schema=this.schema.toJSON(e)),t}},{key:"toJS",value:function(e){return this.toJSON(e)}},{key:"object",get:function(){return"value"}},{key:"kind",get:function(){return t.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),this.object}},{key:"hasUndos",get:function(){return this.history.undos.size>0}},{key:"hasRedos",get:function(){return this.history.redos.size>0}},{key:"isBlurred",get:function(){return this.selection.isBlurred}},{key:"isFocused",get:function(){return this.selection.isFocused}},{key:"startBlock",get:function(){return this.selection.start.key&&this.document.getClosestBlock(this.selection.start.key)}},{key:"endBlock",get:function(){return this.selection.end.key&&this.document.getClosestBlock(this.selection.end.key)}},{key:"anchorBlock",get:function(){return this.selection.anchor.key&&this.document.getClosestBlock(this.selection.anchor.key)}},{key:"focusBlock",get:function(){return this.selection.focus.key&&this.document.getClosestBlock(this.selection.focus.key)}},{key:"startInline",get:function(){return this.selection.start.key&&this.document.getClosestInline(this.selection.start.key)}},{key:"endInline",get:function(){return this.selection.end.key&&this.document.getClosestInline(this.selection.end.key)}},{key:"anchorInline",get:function(){return this.selection.anchor.key&&this.document.getClosestInline(this.selection.anchor.key)}},{key:"focusInline",get:function(){return this.selection.focus.key&&this.document.getClosestInline(this.selection.focus.key)}},{key:"startText",get:function(){return this.selection.start.key&&this.document.getDescendant(this.selection.start.key)}},{key:"endText",get:function(){return this.selection.end.key&&this.document.getDescendant(this.selection.end.key)}},{key:"anchorText",get:function(){return this.selection.anchor.key&&this.document.getDescendant(this.selection.anchor.key)}},{key:"focusText",get:function(){return this.selection.focus.key&&this.document.getDescendant(this.selection.focus.key)}},{key:"nextBlock",get:function(){return this.selection.end.key&&this.document.getNextBlock(this.selection.end.key)}},{key:"previousBlock",get:function(){return this.selection.start.key&&this.document.getPreviousBlock(this.selection.start.key)}},{key:"nextInline",get:function(){return this.selection.end.key&&this.document.getNextInline(this.selection.end.key)}},{key:"previousInline",get:function(){return this.selection.start.key&&this.document.getPreviousInline(this.selection.start.key)}},{key:"nextText",get:function(){return this.selection.end.key&&this.document.getNextText(this.selection.end.key)}},{key:"previousText",get:function(){return this.selection.start.key&&this.document.getPreviousText(this.selection.start.key)}},{key:"marks",get:function(){return this.selection.isUnset?new r.Set:this.selection.marks||this.document.getMarksAtRange(this.selection)}},{key:"activeMarks",get:function(){return this.selection.isUnset?new r.Set:this.selection.marks||this.document.getActiveMarksAtRange(this.selection)}},{key:"blocks",get:function(){return this.selection.isUnset?new r.List:this.document.getBlocksAtRange(this.selection)}},{key:"fragment",get:function(){return this.selection.isUnset?Wr.create():this.document.getFragmentAtRange(this.selection)}},{key:"inlines",get:function(){return this.selection.isUnset?new r.List:this.document.getInlinesAtRange(this.selection)}},{key:"texts",get:function(){return this.selection.isUnset?new r.List:this.document.getTextsAtRange(this.selection)}},{key:"isEmpty",get:function(){return!!this.selection.isCollapsed||(0==this.selection.end.offset||0==this.selection.start.offset)&&this.fragment.isEmpty}},{key:"isInVoid",get:function(){return!this.selection.isExpanded&&this.document.hasVoidParent(this.selection.start.key)}},{key:"isCollapsed",get:function(){return t.deprecate("0.37.0","The `value.isCollapsed` property is deprecated, please use `selection.isCollapsed` instead."),this.selection.isCollapsed}},{key:"isExpanded",get:function(){return t.deprecate("0.37.0","The `value.isExpanded` property is deprecated, please use `selection.isExpanded` instead."),this.selection.isExpanded}},{key:"isBackward",get:function(){return t.deprecate("0.37.0","The `value.isBackward` property is deprecated, please use `selection.isBackward` instead."),this.selection.isBackward}},{key:"isForward",get:function(){return t.deprecate("0.37.0","The `value.isForward` property is deprecated, please use `selection.isForward` instead."),this.selection.isForward}},{key:"startKey",get:function(){return t.deprecate("0.37.0","The `value.startKey` property is deprecated, please use `selection.start.key` instead."),this.selection.start.key}},{key:"endKey",get:function(){return t.deprecate("0.37.0","The `value.endKey` property is deprecated, please use `selection.end.key` instead."),this.selection.end.key}},{key:"startPath",get:function(){return t.deprecate("0.37.0","The `value.startPath` property is deprecated, please use `selection.start.path` instead."),this.selection.start.path}},{key:"endPath",get:function(){return t.deprecate("0.37.0","The `value.endPath` property is deprecated, please use `selection.end.path` instead."),this.selection.end.path}},{key:"startOffset",get:function(){return t.deprecate("0.37.0","The `value.startOffset` property is deprecated, please use `selection.start.offset` instead."),this.selection.start.offset}},{key:"endOffset",get:function(){return t.deprecate("0.37.0","The `value.endOffset` property is deprecated, please use `selection.end.offset` instead."),this.selection.end.offset}},{key:"anchorKey",get:function(){return t.deprecate("0.37.0","The `value.anchorKey` property is deprecated, please use `selection.anchor.key` instead."),this.selection.anchor.key}},{key:"focusKey",get:function(){return t.deprecate("0.37.0","The `value.focusKey` property is deprecated, please use `selection.focus.key` instead."),this.selection.focus.key}},{key:"anchorPath",get:function(){return t.deprecate("0.37.0","The `value.anchorPath` property is deprecated, please use `selection.anchor.path` instead."),this.selection.anchor.path}},{key:"focusPath",get:function(){return t.deprecate("0.37.0","The `value.focusPath` property is deprecated, please use `selection.focus.path` instead."),this.selection.focus.path}},{key:"anchorOffset",get:function(){return t.deprecate("0.37.0","The `value.anchorOffset` property is deprecated, please use `selection.anchor.offset` instead."),this.selection.anchor.offset}},{key:"focusOffset",get:function(){return t.deprecate("0.37.0","The `value.focusOffset` property is deprecated, please use `selection.focus.offset` instead."),this.selection.focus.offset}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(n.isValue(e))return e;if(s(e))return n.fromJSON(e,t);throw new Error("`Value.create` only accepts objects or values, but you passed it: "+e)}},{key:"createProperties",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n.isValue(e))return{data:e.data,decorations:e.decorations,schema:e.schema};if(s(e)){var t={};return"data"in e&&(t.data=Br.create(e.data)),"decorations"in e&&(t.decorations=tn.createList(e.decorations)),"schema"in e&&(t.schema=Ta.create(e.schema)),t}throw new Error("`Value.createProperties` only accepts objects or values, but you passed it: "+e)}},{key:"fromJSON",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=e.document,a=void 0===o?{}:o,s=e.selection,i=void 0===s?{}:s,u=e.schema,c=void 0===u?{}:u,l=e.history,f=void 0===l?{}:l,d=new r.Map;if(a=Wr.fromJSON(a),i=tn.fromJSON(i),c=Ta.fromJSON(c),f=ha.fromJSON(f),t.plugins){var v=!0,h=!1,y=void 0;try{for(var p,m=t.plugins[Symbol.iterator]();!(v=(p=m.next()).done);v=!0){var k=p.value;k.data&&(d=d.merge(k.data))}}catch(e){h=!0,y=e}finally{try{!v&&m.return&&m.return()}finally{if(h)throw y}}}if("data"in e&&(d=d.merge(e.data)),(i=a.createRange(i)).isUnset){var g=a.getFirstText();g&&(i=i.moveToStartOfNode(g)),i=a.createRange(i)}var T=new n({data:d,document:a,selection:i=a.createRange(i),schema:c,history:f});return!1!==t.normalize&&(T=T.change({save:!1}).normalize().value),T}},{key:"isValue",value:function(e){return!(!e||!e[i.VALUE])}}]),n}(r.Record(Ea));wa.fromJS=wa.fromJSON,wa.prototype[i.VALUE]=!0;var Fa={add_mark:["value","path","offset","length","mark"],insert_node:["value","path","node"],insert_text:["value","path","offset","text","marks"],merge_node:["value","path","position","properties","target"],move_node:["value","path","newPath"],remove_mark:["value","path","offset","length","mark"],remove_node:["value","path","node"],remove_text:["value","path","offset","text","marks"],set_mark:["value","path","offset","length","mark","properties"],set_node:["value","path","node","properties"],set_selection:["value","selection","properties"],set_value:["value","properties"],split_node:["value","path","position","properties","target"]},Ba={length:void 0,mark:void 0,marks:void 0,newPath:void 0,node:void 0,offset:void 0,path:void 0,position:void 0,properties:void 0,selection:void 0,target:void 0,text:void 0,type:void 0,value:void 0},_a=function(e){function n(){return h(this,n),g(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return k(n,e),y(n,[{key:"toJSON",value:function(){var e=this.object,t=this.type,r={object:e,type:t},n=Fa[t],o=!0,a=!1,s=void 0;try{for(var i,u=n[Symbol.iterator]();!(o=(i=u.next()).done);o=!0){var c=i.value,l=this[c];if("document"!=c&&("selection"!=c&&"value"!=c&&("node"!=c||"insert_node"==t))){if("mark"!=c&&"marks"!=c&&"node"!=c||(l=l.toJSON()),"properties"==c&&"merge_node"==t){var f={};"data"in l&&(f.data=l.data.toJS()),"type"in l&&(f.type=l.type),l=f}if("properties"==c&&"set_mark"==t){var d={};"data"in l&&(d.data=l.data.toJS()),"type"in l&&(d.type=l.type),l=d}if("properties"==c&&"set_node"==t){var v={};"data"in l&&(v.data=l.data.toJS()),"isVoid"in l&&(v.isVoid=l.isVoid),"type"in l&&(v.type=l.type),l=v}if("properties"==c&&"set_selection"==t){var h={};"anchor"in l&&(h.anchor=l.anchor.toJSON()),"focus"in l&&(h.focus=l.focus.toJSON()),"isFocused"in l&&(h.isFocused=l.isFocused),"marks"in l&&(h.marks=l.marks&&l.marks.toJSON()),l=h}if("properties"==c&&"set_value"==t){var y={};"data"in l&&(y.data=l.data.toJS()),"decorations"in l&&(y.decorations=l.decorations.toJS()),"schema"in l&&(y.schema=l.schema.toJS()),l=y}if("properties"==c&&"split_node"==t){var p={};"data"in l&&(p.data=l.data.toJS()),"type"in l&&(p.type=l.type),l=p}r[c]=l}}}catch(e){a=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw s}}return r}},{key:"toJS",value:function(e){return this.toJSON(e)}},{key:"object",get:function(){return"operation"}},{key:"kind",get:function(){return t.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),this.object}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n.isOperation(e))return e;if(s(e))return n.fromJSON(e);throw new Error("`Operation.create` only accepts objects or operations, but you passed it: "+e)}},{key:"createList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(r.List.isList(e)||Array.isArray(e))return new r.List(e.map(n.create));throw new Error("`Operation.createList` only accepts arrays or lists, but you passed it: "+e)}},{key:"fromJSON",value:function(e){if(n.isOperation(e))return e;var t=e.type,r=Fa[t],o={type:t};if(!r)throw new Error('`Operation.fromJSON` was passed an unrecognized operation type: "'+t+'"');var a=!0,s=!1,i=void 0;try{for(var u,c=r[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value,f=e[l];if(void 0===f){if("document"==l)continue;if("selection"==l)continue;if("value"==l)continue;if("node"==l&&"insert_node"!=t)continue;throw new Error('`Operation.fromJSON` was passed a "'+t+'" operation without the required "'+l+'" attribute.')}"path"!==l&&"newPath"!==l||(f=Zr.create(f)),"mark"===l&&(f=Mr.create(f)),"marks"===l&&null!=f&&(f=Mr.createSet(f)),"node"===l&&(f=sn.create(f)),"selection"===l&&(f=tn.create(f)),"value"===l&&(f=wa.create(f)),"properties"===l&&"merge_node"===t&&(f=sn.createProperties(f)),"properties"===l&&"set_mark"===t&&(f=Mr.createProperties(f)),"properties"===l&&"set_node"===t&&(f=sn.createProperties(f)),"properties"===l&&"set_selection"===t&&(f=tn.createProperties(f)),"properties"===l&&"set_value"===t&&(f=wa.createProperties(f)),"properties"===l&&"split_node"===t&&(f=sn.createProperties(f)),o[l]=f}}catch(e){s=!0,i=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw i}}return new n(o)}},{key:"isOperation",value:function(e){return!(!e||!e[i.OPERATION])}},{key:"isOperationList",value:function(e){return r.List.isList(e)&&e.every(function(e){return n.isOperation(e)})}}]),n}(r.Record(Ba));_a.fromJS=_a.fromJSON,_a.prototype[i.OPERATION]=!0;var Pa=ae("slate:operation:invert");function ja(e){var t=(e=_a.create(e)).type;switch(Pa(t,e),t){case"insert_node":return e.set("type","remove_node");case"remove_node":return e.set("type","insert_node");case"move_node":var r=e,n=r.newPath,o=r.path,a=n,s=o,i=o.size-1,u=n.size-1;return o.size<a.size&&o.slice(0,i).every(function(e,t){return e==a.get(t)})&&o.last()<a.get(i)&&(a=a.slice(0,i).concat(a.get(i)-1).concat(a.slice(i+1,a.size))),n.size<s.size&&n.slice(0,u).every(function(e,t){return e==s.get(t)})&&n.last()<=s.get(u)&&(s=s.slice(0,u).concat(s.get(u)+1).concat(s.slice(u+1,s.size))),e.set("path",a).set("newPath",s);case"merge_node":var c=e.path,l=Zr.decrement(c);return e.set("type","split_node").set("path",l);case"split_node":var f=e.path,d=Zr.increment(f);return e.set("type","merge_node").set("path",d);case"set_node":var v=e,h=v.properties,y=v.node,p=y.merge(h),m=Er(y,Object.keys(h));return e.set("node",p).set("properties",m);case"insert_text":return e.set("type","remove_text");case"remove_text":return e.set("type","insert_text");case"add_mark":return e.set("type","remove_mark");case"remove_mark":return e.set("type","add_mark");case"set_mark":var k=e,g=k.properties,T=k.mark,O=T.merge(g),A=Er(T,Object.keys(g));return e.set("mark",O).set("properties",A);case"set_selection":var b=e,N=b.properties,x=b.selection,S=x.merge(N),E=Er(x,Object.keys(N));return e.set("selection",S).set("properties",E);case"set_value":var w=e,F=w.properties,B=w.value,_=B.merge(F),P=Er(B,Object.keys(F));return e.set("value",_).set("properties",P);default:throw new Error('Unknown operation type: "'+t+'".')}}var Ca=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e};var Ra=function(e,t,r,n){var o=!r;r||(r={});for(var a=-1,s=t.length;++a<s;){var i=t[a],u=n?n(r[i],e[i],i,r,e):void 0;void 0===u&&(u=e[i]),o?Wt(r,i,u):$t(r,i,u)}return r};var za=function(e,t){return e&&Ra(t,Jo(t),e)};var Ia=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t},La=Object.prototype.hasOwnProperty;var Da=function(e){if(!we(e))return Ia(e);var t=zo(e),r=[];for(var n in e)("constructor"!=n||!t&&La.call(e,n))&&r.push(n);return r};var Ma=function(e){return Ko(e)?Co(e,!0):Da(e)};var Ka=function(e,t){return e&&Ra(t,Ma(t),e)},Ja=Y(function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,o=n&&n.exports===r?ce.Buffer:void 0,a=o?o.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,n=a?a(r):new e.constructor(r);return e.copy(n),n}});var Va=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t};var Ua=function(e,t){return Ra(e,bo(e),t)},Ha=Io(Object.getPrototypeOf,Object),Wa=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)dr(t,bo(e)),e=Ha(e);return t}:To;var Ga=function(e,t){return Ra(e,Wa(e),t)};var $a=function(e){return ko(e,Ma,Wa)},qa=Object.prototype.hasOwnProperty;var Ya=function(e){var t=e.length,r=e.constructor(t);return t&&"string"==typeof e[0]&&qa.call(e,"index")&&(r.index=e.index,r.input=e.input),r};var Xa=function(e){var t=new e.constructor(e.byteLength);return new Zn(t).set(new Zn(e)),t};var Za=function(e,t){var r=t?Xa(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)};var Qa=function(e,t){return e.set(t[0],t[1]),e};var es=function(e,t,r,n){var o=-1,a=null==e?0:e.length;for(n&&a&&(r=e[++o]);++o<a;)r=t(r,e[o],o,e);return r},ts=1;var rs=function(e,t,r){var n=t?r(Qn(e),ts):Qn(e);return es(n,Qa,new e.constructor)},ns=/\w*$/;var os=function(e){var t=new e.constructor(e.source,ns.exec(e));return t.lastIndex=e.lastIndex,t};var as=function(e,t){return e.add(t),e},ss=1;var is=function(e,t,r){var n=t?r(eo(e),ss):eo(e);return es(n,as,new e.constructor)},us=le?le.prototype:void 0,cs=us?us.valueOf:void 0;var ls=function(e){return cs?Object(cs.call(e)):{}};var fs=function(e,t){var r=t?Xa(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)},ds="[object Boolean]",vs="[object Date]",hs="[object Map]",ys="[object Number]",ps="[object RegExp]",ms="[object Set]",ks="[object String]",gs="[object Symbol]",Ts="[object ArrayBuffer]",Os="[object DataView]",As="[object Float32Array]",bs="[object Float64Array]",Ns="[object Int8Array]",xs="[object Int16Array]",Ss="[object Int32Array]",Es="[object Uint8Array]",ws="[object Uint8ClampedArray]",Fs="[object Uint16Array]",Bs="[object Uint32Array]";var _s=function(e,t,r,n){var o=e.constructor;switch(t){case Ts:return Xa(e);case ds:case vs:return new o(+e);case Os:return Za(e,n);case As:case bs:case Ns:case xs:case Ss:case Es:case ws:case Fs:case Bs:return fs(e,n);case hs:return rs(e,n,r);case ys:case ks:return new o(e);case ps:return os(e);case ms:return is(e,n,r);case gs:return ls(e)}},Ps=Object.create,js=function(){function e(){}return function(t){if(!we(t))return{};if(Ps)return Ps(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();var Cs=function(e){return"function"!=typeof e.constructor||zo(e)?{}:js(Ha(e))},Rs=1,zs=2,Is=4,Ls="[object Arguments]",Ds="[object Function]",Ms="[object GeneratorFunction]",Ks="[object Object]",Js={};Js[Ls]=Js["[object Array]"]=Js["[object ArrayBuffer]"]=Js["[object DataView]"]=Js["[object Boolean]"]=Js["[object Date]"]=Js["[object Float32Array]"]=Js["[object Float64Array]"]=Js["[object Int8Array]"]=Js["[object Int16Array]"]=Js["[object Int32Array]"]=Js["[object Map]"]=Js["[object Number]"]=Js[Ks]=Js["[object RegExp]"]=Js["[object Set]"]=Js["[object String]"]=Js["[object Symbol]"]=Js["[object Uint8Array]"]=Js["[object Uint8ClampedArray]"]=Js["[object Uint16Array]"]=Js["[object Uint32Array]"]=!0,Js["[object Error]"]=Js[Ds]=Js["[object WeakMap]"]=!1;var Vs=function e(t,r,n,o,a,s){var i,u=r&Rs,c=r&zs,l=r&Is;if(n&&(i=a?n(t,o,a,s):n(t)),void 0!==i)return i;if(!we(t))return t;var f=se(t);if(f){if(i=Ya(t),!u)return Va(t,i)}else{var d=na(t),v=d==Ds||d==Ms;if(So(t))return Ja(t,u);if(d==Ks||d==Ls||v&&!a){if(i=c||v?{}:Cs(t),!u)return c?Ga(t,Ka(i,t)):Ua(t,za(i,t))}else{if(!Js[d])return a?t:{};i=_s(t,d,e,u)}}s||(s=new Kn);var h=s.get(t);if(h)return h;s.set(t,i);var y=l?c?$a:Vo:c?keysIn:Jo,p=f?void 0:y(t);return Ca(p||t,function(o,a){p&&(o=t[a=o]),$t(i,a,e(o,r,n,a,t,s))}),i};var Us=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0};var Hs=function(e,t,r){var n=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(r=r>o?o:r)<0&&(r+=o),o=t>r?0:r-t>>>0,t>>>=0;for(var a=Array(o);++n<o;)a[n]=e[n+t];return a};var Ws=function(e,t){return t.length<2?e:Ut(e,Hs(t,0,-1))};var Gs=function(e,t){return t=Kt(t,e),null==(e=Ws(e,t))||delete e[Vt(Us(t))]},$s="[object Object]",qs=Function.prototype,Ys=Object.prototype,Xs=qs.toString,Zs=Ys.hasOwnProperty,Qs=Xs.call(Object);var ei=function(e){if(!Ae(e)||Oe(e)!=$s)return!1;var t=Ha(e);if(null===t)return!0;var r=Zs.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&Xs.call(r)==Qs};var ti=function(e){return ei(e)?void 0:e},ri=Sr(function(e,t){var r={};if(null==e)return r;var n=!1;t=Rt(t,function(t){return t=Kt(t,e),n||(n=t.length>1),t}),Ra(e,$a(e),r),n&&(r=Vs(r,7,ti));for(var o=t.length;o--;)Gs(r,t[o]);return r}),ni={redo:function(e){var t=e.value,r=t.history;if(r){var n=r,o=n.undos,a=n.redos,s=a.peek();s&&(a=a.pop(),o=o.push(s),s.forEach(function(t){var r=t,n=r.type,o=r.properties;"set_selection"==n&&(t=t.set("properties",ri(o,"isFocused"))),e.applyOperation(t,{save:!1})}),t=e.value,r=r.set("undos",o).set("redos",a),t=t.set("history",r),e.value=t)}},undo:function(e){var t=e.value,r=t.history;if(r){var n=r,o=n.undos,a=n.redos,s=o.peek();s&&(o=o.pop(),a=a.push(s),s.slice().reverse().map(ja).forEach(function(t){var r=t,n=r.type,o=r.properties;"set_selection"==n&&(t=t.set("properties",ri(o,"isFocused"))),e.applyOperation(t,{save:!1})}),t=e.value,r=r.set("undos",o).set("redos",a),t=t.set("history",r),e.value=t)}}},oi=Object.prototype.hasOwnProperty,ai=Object.prototype.toString;var si=function(e){if(null==e)return!0;if("boolean"==typeof e)return!1;if("number"==typeof e)return 0===e;if("string"==typeof e)return 0===e.length;if("function"==typeof e)return 0===e.length;if(Array.isArray(e))return 0===e.length;if(e instanceof Error)return""===e.message;if(e.toString==ai)switch(e.toString()){case"[object File]":case"[object Map]":case"[object Set]":return 0===e.size;case"[object Object]":for(var t in e)if(oi.call(e,t))return!1;return!0}return!1},ii={};function ui(e,t){for(var r,n=arguments.length,o=Array(n>2?n-2:0),a=2;a<n;a++)o[a-2]=arguments[a];var s=(r=e.value.selection)[t].apply(r,o);e.select(s)}function ci(e,t,r,n){var o=t.slice(0,1).toUpperCase()+t.slice(1),a=r.slice(0,1).toUpperCase()+r.slice(1),s=n.slice(0,1).toUpperCase()+n.slice(1),i="move"+o+"To"+a+"OfNode",u="text"==n?"getNode":"getClosest"+s,c=e.value,l=c.document,f=c.selection[t],d=l[u](f.key);d&&e[i](d)}function li(e,t,r,n,o){var a=t.slice(0,1).toUpperCase()+t.slice(1),s=r.slice(0,1).toUpperCase()+r.slice(1),i=n.slice(0,1).toUpperCase()+n.slice(1),u=o.slice(0,1).toUpperCase()+o.slice(1),c="move"+a+"To"+s+"OfNode",l="text"==o?"getNode":"getClosest"+u,f="get"+i+u,d=e.value,v=d.document,h=d.selection[t],y=v[l](h.key);if(y){var p=v[f](y.key);p&&e[c](p)}}function fi(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(0!==r){if(r<0)return di(e,t,-r);var n=t.slice(0,1).toUpperCase()+t.slice(1),o=e.value,a=o.document,s=o.selection,i=s[t],u=a.hasVoidParent(i.path);if(!u&&i.offset-r>=0){var c=s["move"+n+"Backward"](r);e.select(c)}else{var l=a.getPreviousText(i.path);if(l){var f=a.getClosestBlock(i.path).hasNode(l.key),d=l&&a.hasVoidParent(l.key);if(e["move"+n+"ToEndOfNode"](l),!u&&!d&&f){var v=e.value.selection["move"+n+"Backward"](r);e.select(v)}}}}}function di(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(0!==r){if(r<0)return fi(e,t,-r);var n=t.slice(0,1).toUpperCase()+t.slice(1),o=e.value,a=o.document,s=o.selection,i=s[t],u=a.getNode(i.path),c=a.hasVoidParent(i.path);if(!c&&i.offset+r<=u.text.length){var l=s["move"+n+"Forward"](r);e.select(l)}else{var f=a.getNextText(i.path);if(f){var d=a.getClosestBlock(i.path).hasNode(f.key),v=a.hasVoidParent(f.key);if(e["move"+n+"ToStartOfNode"](f),!c&&!v&&d){var h=e.value.selection["move"+n+"Forward"](r);e.select(h)}}}}}ii.blur=function(e){e.select({isFocused:!1})},ii.deselect=function(e){var t=tn.create();e.select(t)},ii.focus=function(e){e.select({isFocused:!0})},ii.flip=function(e){e.call(ui,"flip")},ii.moveAnchorBackward=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[fi,"anchor"].concat(r))},ii.moveAnchorForward=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[di,"anchor"].concat(r))},ii.moveAnchorTo=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[ui,"moveAnchorTo"].concat(r))},ii.moveAnchorToEndOfBlock=function(e){e.call(ci,"anchor","end","block")},ii.moveAnchorToEndOfInline=function(e){e.call(ci,"anchor","end","inline")},ii.moveAnchorToEndOfDocument=function(e){e.moveAnchorToEndOfNode(e.value.document).moveToAnchor()},ii.moveAnchorToEndOfNextBlock=function(e){e.call(li,"anchor","end","next","block")},ii.moveAnchorToEndOfNextInline=function(e){e.call(li,"anchor","end","next","inline")},ii.moveAnchorToEndOfNextText=function(e){e.call(li,"anchor","end","next","text")},ii.moveAnchorToEndOfNode=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[ui,"moveAnchorToEndOfNode"].concat(r))},ii.moveAnchorToEndOfPreviousBlock=function(e){e.call(li,"anchor","end","previous","block")},ii.moveAnchorToEndOfPreviousInline=function(e){e.call(li,"anchor","end","previous","inline")},ii.moveAnchorToEndOfPreviousText=function(e){e.call(li,"anchor","end","previous","text")},ii.moveAnchorToEndOfText=function(e){e.call(ci,"anchor","end","text")},ii.moveAnchorToStartOfBlock=function(e){e.call(ci,"anchor","start","block")},ii.moveAnchorToStartOfDocument=function(e){e.moveAnchorToStartOfNode(e.value.document).moveToAnchor()},ii.moveAnchorToStartOfInline=function(e){e.call(ci,"anchor","start","inline")},ii.moveAnchorToStartOfNextBlock=function(e){e.call(li,"anchor","start","next","block")},ii.moveAnchorToStartOfNextInline=function(e){e.call(li,"anchor","start","next","inline")},ii.moveAnchorToStartOfNextText=function(e){e.call(li,"anchor","start","next","text")},ii.moveAnchorToStartOfNode=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[ui,"moveAnchorToStartOfNode"].concat(r))},ii.moveAnchorToStartOfPreviousBlock=function(e){e.call(li,"anchor","start","previous","block")},ii.moveAnchorToStartOfPreviousInline=function(e){e.call(li,"anchor","start","previous","inline")},ii.moveAnchorToStartOfPreviousText=function(e){e.call(li,"anchor","start","previous","text")},ii.moveAnchorToStartOfText=function(e){e.call(ci,"anchor","start","text")},ii.moveBackward=function(e){for(var t,r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];(t=e.moveAnchorBackward.apply(e,n)).moveFocusBackward.apply(t,n)},ii.moveEndBackward=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[fi,"end"].concat(r))},ii.moveEndForward=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[di,"end"].concat(r))},ii.moveEndTo=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[ui,"moveEndTo"].concat(r))},ii.moveEndToEndOfBlock=function(e){e.call(ci,"end","end","block")},ii.moveEndToEndOfDocument=function(e){e.moveEndToEndOfNode(e.value.document).moveToEnd()},ii.moveEndToEndOfInline=function(e){e.call(ci,"end","end","inline")},ii.moveEndToEndOfNextBlock=function(e){e.call(li,"end","end","next","block")},ii.moveEndToEndOfNextInline=function(e){e.call(li,"end","end","next","inline")},ii.moveEndToEndOfNextText=function(e){e.call(li,"end","end","next","text")},ii.moveEndToEndOfNode=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[ui,"moveEndToEndOfNode"].concat(r))},ii.moveEndToEndOfPreviousBlock=function(e){e.call(li,"end","end","previous","block")},ii.moveEndToEndOfPreviousInline=function(e){e.call(li,"end","end","previous","inline")},ii.moveEndToEndOfPreviousText=function(e){e.call(li,"end","end","previous","text")},ii.moveEndToEndOfText=function(e){e.call(ci,"end","end","text")},ii.moveEndToStartOfBlock=function(e){e.call(ci,"end","start","block")},ii.moveEndToStartOfDocument=function(e){e.moveEndToStartOfNode(e.value.document).moveToEnd()},ii.moveEndToStartOfInline=function(e){e.call(ci,"end","start","inline")},ii.moveEndToStartOfNextBlock=function(e){e.call(li,"end","start","next","block")},ii.moveEndToStartOfNextInline=function(e){e.call(li,"end","start","next","inline")},ii.moveEndToStartOfNextText=function(e){e.call(li,"end","start","next","text")},ii.moveEndToStartOfNode=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[ui,"moveEndToStartOfNode"].concat(r))},ii.moveEndToStartOfPreviousBlock=function(e){e.call(li,"end","start","previous","block")},ii.moveEndToStartOfPreviousInline=function(e){e.call(li,"end","start","previous","inline")},ii.moveEndToStartOfPreviousText=function(e){e.call(li,"end","start","previous","text")},ii.moveEndToStartOfText=function(e){e.call(ci,"end","start","text")},ii.moveFocusBackward=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[fi,"focus"].concat(r))},ii.moveFocusForward=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[di,"focus"].concat(r))},ii.moveFocusTo=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[ui,"moveFocusTo"].concat(r))},ii.moveFocusToEndOfBlock=function(e){e.call(ci,"focus","end","block")},ii.moveFocusToEndOfDocument=function(e){e.moveFocusToEndOfNode(e.value.document).moveToFocus()},ii.moveFocusToEndOfInline=function(e){e.call(ci,"focus","end","inline")},ii.moveFocusToEndOfNextBlock=function(e){e.call(li,"focus","end","next","block")},ii.moveFocusToEndOfNextInline=function(e){e.call(li,"focus","end","next","inline")},ii.moveFocusToEndOfNextText=function(e){e.call(li,"focus","end","next","text")},ii.moveFocusToEndOfNode=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[ui,"moveFocusToEndOfNode"].concat(r))},ii.moveFocusToEndOfPreviousBlock=function(e){e.call(li,"focus","end","previous","block")},ii.moveFocusToEndOfPreviousInline=function(e){e.call(li,"focus","end","previous","inline")},ii.moveFocusToEndOfPreviousText=function(e){e.call(li,"focus","end","previous","text")},ii.moveFocusToEndOfText=function(e){e.call(ci,"focus","end","text")},ii.moveFocusToStartOfBlock=function(e){e.call(ci,"focus","start","block")},ii.moveFocusToStartOfDocument=function(e){e.moveFocusToStartOfNode(e.value.document).moveToFocus()},ii.moveFocusToStartOfInline=function(e){e.call(ci,"focus","start","inline")},ii.moveFocusToStartOfNextBlock=function(e){e.call(li,"focus","start","next","block")},ii.moveFocusToStartOfNextInline=function(e){e.call(li,"focus","start","next","inline")},ii.moveFocusToStartOfNextText=function(e){e.call(li,"focus","start","next","text")},ii.moveFocusToStartOfNode=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[ui,"moveFocusToStartOfNode"].concat(r))},ii.moveFocusToStartOfPreviousBlock=function(e){e.call(li,"focus","start","previous","block")},ii.moveFocusToStartOfPreviousInline=function(e){e.call(li,"focus","start","previous","inline")},ii.moveFocusToStartOfPreviousText=function(e){e.call(li,"focus","start","previous","text")},ii.moveFocusToStartOfText=function(e){e.call(ci,"focus","start","text")},ii.moveForward=function(e){for(var t,r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];(t=e.moveAnchorForward.apply(e,n)).moveFocusForward.apply(t,n)},ii.moveStartBackward=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[fi,"start"].concat(r))},ii.moveStartForward=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[di,"start"].concat(r))},ii.moveStartTo=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[ui,"moveStartTo"].concat(r))},ii.moveStartToEndOfBlock=function(e){e.call(ci,"start","end","block")},ii.moveStartToEndOfDocument=function(e){e.moveStartToEndOfNode(e.value.document).moveToStart()},ii.moveStartToEndOfInline=function(e){e.call(ci,"start","end","inline")},ii.moveStartToEndOfNextBlock=function(e){e.call(li,"start","end","next","block")},ii.moveStartToEndOfNextInline=function(e){e.call(li,"start","end","next","inline")},ii.moveStartToEndOfNextText=function(e){e.call(li,"start","end","next","text")},ii.moveStartToEndOfNode=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[ui,"moveStartToEndOfNode"].concat(r))},ii.moveStartToEndOfPreviousBlock=function(e){e.call(li,"start","end","previous","block")},ii.moveStartToEndOfPreviousInline=function(e){e.call(li,"start","end","previous","inline")},ii.moveStartToEndOfPreviousText=function(e){e.call(li,"start","end","previous","text")},ii.moveStartToEndOfText=function(e){e.call(ci,"start","end","text")},ii.moveStartToStartOfBlock=function(e){e.call(ci,"start","start","block")},ii.moveStartToStartOfDocument=function(e){e.moveStartToStartOfNode(e.value.document).moveToStart()},ii.moveStartToStartOfInline=function(e){e.call(ci,"start","start","inline")},ii.moveStartToStartOfNextBlock=function(e){e.call(li,"start","start","next","block")},ii.moveStartToStartOfNextInline=function(e){e.call(li,"start","start","next","inline")},ii.moveStartToStartOfNextText=function(e){e.call(li,"start","start","next","text")},ii.moveStartToStartOfNode=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[ui,"moveStartToStartOfNode"].concat(r))},ii.moveStartToStartOfPreviousBlock=function(e){e.call(li,"start","start","previous","block")},ii.moveStartToStartOfPreviousInline=function(e){e.call(li,"start","start","previous","inline")},ii.moveStartToStartOfPreviousText=function(e){e.call(li,"start","start","previous","text")},ii.moveStartToStartOfText=function(e){e.call(ci,"start","start","text")},ii.moveTo=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[ui,"moveTo"].concat(r))},ii.moveToAnchor=function(e){e.call(ui,"moveToAnchor")},ii.moveToEnd=function(e){e.call(ui,"moveToEnd")},ii.moveToEndOfBlock=function(e){e.moveEndToEndOfBlock().moveToEnd()},ii.moveToEndOfDocument=function(e){e.moveEndToEndOfNode(e.value.document).moveToEnd()},ii.moveToEndOfInline=function(e){e.moveEndToEndOfInline().moveToEnd()},ii.moveToEndOfNextBlock=function(e){e.moveEndToEndOfNextBlock().moveToEnd()},ii.moveToEndOfNextInline=function(e){e.moveEndToEndOfNextInline().moveToEnd()},ii.moveToEndOfNextText=function(e){e.moveEndToEndOfNextText().moveToEnd()},ii.moveToEndOfNode=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[ui,"moveToEndOfNode"].concat(r))},ii.moveToEndOfPreviousBlock=function(e){e.moveStartToEndOfPreviousBlock().moveToStart()},ii.moveToEndOfPreviousInline=function(e){e.moveStartToEndOfPreviousInline().moveToStart()},ii.moveToEndOfPreviousText=function(e){e.moveStartToEndOfPreviousText().moveToStart()},ii.moveToEndOfText=function(e){e.moveEndToEndOfText().moveToEnd()},ii.moveToFocus=function(e){e.call(ui,"moveToFocus")},ii.moveToRangeOfDocument=function(e){e.moveToRangeOfNode(e.value.document)},ii.moveToRangeOfNode=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[ui,"moveToRangeOfNode"].concat(r))},ii.moveToStart=function(e){e.call(ui,"moveToStart")},ii.moveToStartOfBlock=function(e){e.moveStartToStartOfBlock().moveToStart()},ii.moveToStartOfDocument=function(e){e.moveStartToStartOfNode(e.value.document).moveToStart()},ii.moveToStartOfInline=function(e){e.moveStartToStartOfInline().moveToStart()},ii.moveToStartOfNextBlock=function(e){e.moveEndToStartOfNextBlock().moveToEnd()},ii.moveToStartOfNextInline=function(e){e.moveEndToStartOfNextInline().moveToEnd()},ii.moveToStartOfNextText=function(e){e.moveEndToStartOfNextText().moveToEnd()},ii.moveToStartOfNode=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[ui,"moveToStartOfNode"].concat(r))},ii.moveToStartOfPreviousBlock=function(e){e.moveStartToStartOfPreviousBlock().moveToStart()},ii.moveToStartOfPreviousInline=function(e){e.moveStartToStartOfPreviousInline().moveToStart()},ii.moveToStartOfPreviousText=function(e){e.moveStartToStartOfPreviousText().moveToStart()},ii.moveToStartOfText=function(e){e.moveStartToStartOfText().moveToStart()},ii.select=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t=tn.createProperties(t);var o=n.snapshot,a=void 0!==o&&o,s=e.value,i=s.document,u=s.selection,c={},l=u.setProperties(t);for(var f in l=i.resolveRange(l),t=Er(l,Object.keys(t)))!0!==a&&r.is(t[f],u[f])||(c[f]=t[f]);u.marks&&!c.marks&&(c.anchor||c.focus)&&(c.marks=null),si(c)||e.applyOperation({type:"set_selection",value:s,properties:c,selection:u.toJSON()},a?{skip:!1,merge:!1}:{})},ii.setAnchor=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[ui,"setAnchor"].concat(r))},ii.setEnd=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[ui,"setEnd"].concat(r))},ii.setFocus=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[ui,"setFocus"].concat(r))},ii.setStart=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.call.apply(e,[ui,"setStart"].concat(r))},ii.snapshotSelection=function(e){e.select(e.value.selection,{snapshot:!0})},ii.moveOffsetsTo=function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r;t.deprecate("0.37.0","The `Change.moveOffsetsTo` method is deprecated, please use `Change.moveAnchorTo` and `Change.moveFocusTo` instead."),e.moveAnchorTo(r).moveFocusTo(n)};[["collapseCharBackward","moveBackward"],["collapseCharForward","moveForward"],["collapseLineBackward","moveLineBackward"],["collapseLineForward","moveLineForward"],["collapseTo","moveTo"],["collapseToAnchor","moveToAnchor"],["collapseToEnd","moveToEnd"],["collapseToEndOf","moveToEndOfNode"],["collapseToEndOfBlock","moveToEndOfBlock"],["collapseToEndOfNextBlock","moveToEndOfNextBlock"],["collapseToEndOfNextInline","moveToEndOfNextInline"],["collapseToEndOfNextText","moveToEndOfNextText"],["collapseToEndOfPreviousBlock","moveToEndOfPreviousBlock"],["collapseToEndOfPreviousInline","moveToEndOfPreviousInline"],["collapseToEndOfPreviousText","moveToEndOfPreviousText"],["collapseToFocus","moveToFocus"],["collapseToStart","moveToStart"],["collapseToStartOf","moveToStartOfNode"],["collapseToStartOfBlock","moveToStartOfBlock"],["collapseToStartOfNextBlock","moveToStartOfNextBlock"],["collapseToStartOfNextInline","moveToStartOfNextInline"],["collapseToStartOfNextText","moveToStartOfNextText"],["collapseToStartOfPreviousBlock","moveToStartOfPreviousBlock"],["collapseToStartOfPreviousInline","moveToStartOfPreviousInline"],["collapseToStartOfPreviousText","moveToStartOfPreviousText"],["extend","moveFocusForward"],["extendCharBackward","moveFocusBackward"],["extendCharForward","moveFocusForward"],["extendLineBackward","moveFocusToStartOfBlock"],["extendLineForward","moveFocusToEndOfBlock"],["extendTo","moveFocusTo"],["extendToEndOf","moveFocusToEndOfNode"],["extendToEndOfBlock","moveFocusToEndOfBlock"],["extendToEndOfBlock","moveFocusToEndOfBlock"],["extendToEndOfNextBlock","moveFocusToEndOfNextBlock"],["extendToEndOfNextInline","moveFocusToEndOfNextInline"],["extendToEndOfNextText","moveFocusToEndOfNextText"],["extendToEndOfPreviousBlock","moveFocusToEndOfPreviousBlock"],["extendToEndOfPreviousInline","moveFocusToEndOfPreviousInline"],["extendToEndOfPreviousText","moveFocusToEndOfPreviousText"],["extendToStartOf","moveFocusToStartOfNode"],["extendToStartOfBlock","moveFocusToStartOfBlock"],["extendToStartOfNextBlock","moveFocusToStartOfNextBlock"],["extendToStartOfNextInline","moveFocusToStartOfNextInline"],["extendToStartOfNextText","moveFocusToStartOfNextText"],["extendToStartOfPreviousBlock","moveFocusToStartOfPreviousBlock"],["extendToStartOfPreviousInline","moveFocusToStartOfPreviousInline"],["extendToStartOfPreviousText","moveFocusToStartOfPreviousText"],["move","moveForward"],["moveAnchor","moveAnchorForward"],["moveAnchorCharBackward","moveAnchorBackward"],["moveAnchorCharForward","moveAnchorForward"],["moveAnchorOffsetTo","moveAnchorTo"],["moveAnchorToEndOf","moveAnchorToEndOfNode"],["moveAnchorToStartOf","moveAnchorToStartOfNode"],["moveCharBackward","moveBackward"],["moveCharForward","moveForward"],["moveEnd","moveEndForward"],["moveEndCharBackward","moveEndBackward"],["moveEndCharForward","moveEndForward"],["moveEndOffsetTo","moveEndTo"],["moveFocus","moveFocusForward"],["moveFocusCharBackward","moveFocusBackward"],["moveFocusCharForward","moveFocusForward"],["moveFocusOffsetTo","moveFocusTo"],["moveFocusToEndOf","moveFocusToEndOfNode"],["moveFocusToStartOf","moveFocusToStartOfNode"],["moveStart","moveStartForward"],["moveStartCharBackward","moveStartBackward"],["moveStartCharForward","moveStartForward"],["moveStartOffsetTo","moveStartTo"],["moveToEndOf","moveToEndOfNode"],["moveToRangeOf","moveToRangeOfNode"],["moveToStartOf","moveToStartOfNode"],["selectAll","moveToRangeOfDocument"]].forEach(function(e){var r=T(e,2),n=r[0],o=r[1];ii[n]=function(e){t.deprecate("0.37.0","The `Change."+n+"` method is deprecated, please use `Change."+o+"` instead.");for(var r=arguments.length,a=Array(r>1?r-1:0),s=1;s<r;s++)a[s-1]=arguments[s];e[o].apply(e,a)}});var vi={setValue:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t=wa.createProperties(t);var n=e.value;e.applyOperation({type:"set_value",properties:t,value:n},r)}},hi={};function yi(e,t,r){if("text"!=t.object){for(var n=t.getFirstInvalidDescendant(r),o=e.value.document.getPath(t.key);t&&n;)yi(e,n,r),(t=e.value.document.refindNode(o,t.key))?(o=e.value.document.refindPath(o,t.key),n=t.getFirstInvalidDescendant(r)):(o=[],n=null);t&&pi(e,t,r)}else pi(e,t,r)}function pi(e,t,r){var n=r.stack.plugins.length+r.rules.length+("text"===t.object?1:t.nodes.size),o=0;!function e(t,a){var s=a.normalize(r);if(s){var i=t.value.document.getPath(a.key);if(s(t),a=t.value.document.refindNode(i,a.key)){if(i=t.value.document.refindPath(i,a.key),++o>n)throw new Error("A schema rule could not be normalized after sufficient iterations. This is usually due to a `rule.normalize` or `plugin.normalizeNode` function of a schema being incorrectly written, causing an infinite loop.");e(t,a)}}}(e,t)}hi.normalize=function(e,t){e.normalizeDocument(t)},hi.normalizeDocument=function(e,t){var r=e.value.document;e.normalizeNodeByKey(r.key,t)},hi.normalizeNodeByKey=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e.getFlag("normalize",r)){var n=e.value,o=n.document,a=n.schema;yi(e,o.assertNode(t),a),e.normalizeAncestorsByKey(t)}},hi.normalizeAncestorsByKey=function(e,t){var r=e.value,n=r.document,o=r.schema,a=n.getAncestors(t);a&&a.forEach(function(t){e.value.document.getDescendant(t.key)&&pi(e,t,o)})},hi.normalizeParentByKey=function(e,t,r){var n=e.value.document.getParent(t);e.normalizeNodeByKey(n.key,r)},hi.normalizeNodeByPath=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e.getFlag("normalize",r)){var n=e.value,o=n.document,a=n.schema,s=o.assertNode(t);yi(e,s,a);var i=(o=e.value.document).getAncestors(t);i&&i.forEach(function(t){e.value.document.getDescendant(t.key)&&pi(e,t,a)})}},hi.normalizeParentByPath=function(e,t,r){var n=Zr.lift(t);e.normalizeNodeByPath(n,r)};var mi=m({},Vr,Sn,En,ni,ii,vi,hi),ki=ae("slate:operation:apply");function gi(e,t){var r=(t=_a.create(t)).type;switch(ki(r,t),r){case"add_mark":var n=t,o=n.path,a=n.offset,s=n.length,i=n.mark;return e.addMark(o,a,s,i);case"insert_node":var u=t,c=u.path,l=u.node;return e.insertNode(c,l);case"insert_text":var f=t,d=f.path,v=f.offset,h=f.text,y=f.marks;return e.insertText(d,v,h,y);case"merge_node":var p=t.path;return e.mergeNode(p);case"move_node":var m=t,k=m.path,g=m.newPath;return e.moveNode(k,g);case"remove_mark":var T=t,O=T.path,A=T.offset,b=T.length,N=T.mark;return e.removeMark(O,A,b,N);case"remove_node":var x=t.path;return e.removeNode(x);case"remove_text":var S=t,E=S.path,w=S.offset,F=S.text;return e.removeText(E,w,F);case"set_mark":var B=t,_=B.path,P=B.offset,j=B.length,C=B.mark,R=B.properties;return e.setMark(_,P,j,C,R);case"set_node":var z=t,I=z.path,L=z.properties;return e.setNode(I,L);case"set_selection":var D=t.properties;return e.setSelection(D);case"set_value":var M=t.properties;return e.merge(M);case"split_node":var K=t,J=K.path,V=K.position,U=K.properties;return e.splitNode(J,V,U);default:throw new Error('Unknown operation type: "'+r+'".')}}var Ti=ae("slate:change"),Oi=function(){function e(t){h(this,e);var n=t.value;this.value=n,this.operations=new r.List,this.flags=m({normalize:!0},Er(t,["merge","save","normalize"]))}return y(e,[{key:"applyOperation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.operations,n=this.flags,o=this.value,a=o.history;s(e)&&(e=m({},e,{value:o})),e=_a.create(e);var i=t=m({},n,t),u=i.merge,c=void 0===u?0!=r.size||null:u,l=i.save,f=void 0===l||l,d=i.skip,v=void 0===d?null:d;return Ti("apply",{operation:e,save:f,merge:c}),o=gi(o,e),a&&f&&(a=a.save(e,{merge:c,skip:v}),o=o.set("history",a)),this.value=o,this.operations=r.push(e),this}},{key:"applyOperations",value:function(e,t){var r=this;return e.forEach(function(e){return r.applyOperation(e,t)}),this}},{key:"call",value:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.apply(void 0,[this].concat(r)),this}},{key:"withoutNormalization",value:function(e){var t=this.flags.normalize;return this.setOperationFlag("normalize",!1),e(this),this.setOperationFlag("normalize",t),this.normalizeDocument(),this}},{key:"setOperationFlag",value:function(e,t){return this.flags[e]=t,this}},{key:"getFlag",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return void 0!==t[e]?t[e]:this.flags[e]}},{key:"unsetOperationFlag",value:function(e){return delete this.flags[e],this}},{key:"object",get:function(){return"change"}},{key:"kind",get:function(){return t.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),this.object}}]),e}();Oi.isChange=u.bind(null,"CHANGE"),Oi.prototype[i.CHANGE]=!0,Object.keys(mi).forEach(function(e){Oi.prototype[e]=function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return Ti(e,{args:r}),this.call.apply(this,[mi[e]].concat(r)),this}});var Ai={apply:gi,invert:ja};function bi(e){return t.deprecate("0.35.0","The `setKeyGenerator()` util is deprecrated. Use the `KeyUtils.setGenerator()` helper instead."),d.setGenerator(e)}function Ni(){return t.deprecate("0.35.0","The `resetKeyGenerator()` util is deprecrated. Use the `KeyUtils.resetGenerator()` helper instead."),d.resetGenerator()}var xi={Block:b,Changes:mi,Data:Br,Document:Wr,History:ha,Inline:Fr,KeyUtils:d,Leaf:nn,Mark:Mr,Node:sn,Operation:_a,Operations:Ai,PathUtils:Zr,Point:Qr,Range:tn,resetKeyGenerator:Ni,resetMemoization:Ir,Schema:Ta,setKeyGenerator:bi,Stack:ya,Text:an,TextUtils:xn,useMemoization:Lr,Value:wa};e.Block=b,e.Change=Oi,e.Changes=mi,e.Data=Br,e.Document=Wr,e.History=ha,e.Inline=Fr,e.KeyUtils=d,e.Leaf=nn,e.Mark=Mr,e.Node=sn,e.Operation=_a,e.Operations=Ai,e.PathUtils=Zr,e.Point=Qr,e.Range=tn,e.resetKeyGenerator=Ni,e.resetMemoization=Ir,e.Schema=Ta,e.setKeyGenerator=bi,e.Stack=ya,e.Text=an,e.TextUtils=xn,e.useMemoization=Lr,e.Value=wa,e.default=xi,Object.defineProperty(e,"__esModule",{value:!0})});
